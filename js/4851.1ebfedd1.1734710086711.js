"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[4851],{30945:function(t,a,i){i.r(a),i.d(a,{default:function(){return f}});var s=i(23166),o=(i(70560),i(97582)),e=i(86424),n=i(89445),l=i(36113),r=i(79934);const{IndexerType:d}=e.WALLET_CONSTS,w=r.Ps`
  query NominatorsCountQuery {
    data: stakingStakers(orderBy: ID_DESC) {
      totalCount
    }
  }
`,g=r.Ps`
  query NominatorsCountQuery {
    data: stakingStakersConnection(orderBy: id_DESC) {
      totalCount
    }
  }
`;var h,u=i(69781),c=i(49053),k=i(19316),m=i(93838),v=i(50149);!function(t){t.PendingRewards="pending-rewards",t.Validators="validators",t.ControllerAccount="controller-account"}(h||(h={}));let p=class extends((0,n.Wr)(l.Z,v.Z,e.tA.LoadingMixin)){constructor(...t){super(...t),(0,s.Z)(this,"setTotalNominators",void 0),(0,s.Z)(this,"totalNominators",void 0),(0,s.Z)(this,"stakeDialogMode",m.gf.ADD),(0,s.Z)(this,"showStakeDialog",!1),(0,s.Z)(this,"showClaimRewardsDialog",!1),(0,s.Z)(this,"showPendingRewardsDialog",!1),(0,s.Z)(this,"showValidatorsDialog",!1),(0,s.Z)(this,"showControllerDialog",!1),(0,s.Z)(this,"showWithdrawDialog",!1),(0,s.Z)(this,"showAllWithdrawsDialog",!1)}get lockedFundsFormatted(){return this.lockedFunds.toLocaleString()}get unlockingFundsFormatted(){return this.unlockingFunds.toLocaleString()}get rewardedFundsFormatted(){return this.rewardedFunds.toLocaleString()}get showWithdrawCard(){return!!this.accountLedger?.unlocking.length}get showNextWithdrawal(){return!!this.nextWithdrawalEra}getDropdownMenuItems(){return[{value:h.PendingRewards,text:this.t("soraStaking.pendingRewardsDialog.title")},{value:h.Validators,text:this.t("soraStaking.info.validators")}]}get dropdownMenuItems(){return this.getDropdownMenuItems()}get stakeMoreText(){return this.lockedFunds.isZero()?this.t("soraStaking.newStake.title"):this.t("soraStaking.actions.more")}get withdrawButtonDisabled(){return this.withdrawableFunds.isZero()}handleClickDropdownMenu(){const t=this.$refs["dropdown-menu"];if(!t)return;const a=t.dropdown;a.visible?a.hide():a.show()}handleSelectDropdownMenuItem(t){switch(t){case h.PendingRewards:this.showPendingRewardsDialog=!0;break;case h.Validators:this.showValidatorsDialog=!0;break;case h.ControllerAccount:this.showControllerDialog=!0}}stakeNew(){u.ZP.push({name:m.Ai.ValidatorsType})}stakeMore(){this.stakeDialogMode=m.gf.ADD,this.showStakeDialog=!0}removeStake(){this.stakeDialogMode=m.gf.REMOVE,this.showStakeDialog=!0}claimRewards(){this.showClaimRewardsDialog=!0}showRewards(){this.showClaimRewardsDialog=!1,this.showPendingRewardsDialog=!0}showAllWithdraws(){this.showWithdrawDialog=!1,this.showAllWithdrawsDialog=!0}handleWithdraw(){this.showWithdrawDialog=!0}handleStake(){this.showStakeDialog=!1}handleNominate(){this.showValidatorsDialog=!1}handleChangeController(){this.showControllerDialog=!1}async fetchNominatorsCount(){if(!this.activeEra)return;const t=await async function(){const t=(0,e.HZ)();let a;switch(t.type){case d.SUBQUERY:{const i=t;a=(await i.services.explorer.fetchEntities(w))?.totalCount;break}case d.SUBSQUID:{const i=t;a=(await i.services.explorer.fetchEntitiesConnection(g))?.totalCount;break}}return a}();null!=t&&this.setTotalNominators(t)}created(){this.fetchNominatorsCount()}};(0,o.gn)([c.QF.staking.setTotalNominators],p.prototype,"setTotalNominators",void 0),(0,o.gn)([c.SB.staking.totalNominators],p.prototype,"totalNominators",void 0),(0,o.gn)([(0,n.RL)("currentEra")],p.prototype,"fetchNominatorsCount",null),p=(0,o.gn)([(0,n.wA)({components:{TokenLogo:e.wx.TokenLogo,InfoLine:e.wx.InfoLine,BackButton:(0,k.qU)(m.Jh.BackButton),StakeDialog:(0,k.qU)(m.Jh.StakeDialog),ClaimRewardsDialog:(0,k.qU)(m.Jh.ClaimRewardsDialog),PendingRewardsDialog:(0,k.qU)(m.Jh.PendingRewardsDialog),ValidatorsDialog:(0,k.qU)(m.Jh.ValidatorsDialog),WithdrawDialog:(0,k.qU)(m.Jh.WithdrawDialog),AllWithdrawsDialog:(0,k.qU)(m.Jh.AllWithdrawsDialog),EraCountdown:(0,k.qU)(m.Jh.EraCountdown),FormattedAmountWithFiatValue:e.wx.FormattedAmountWithFiatValue}})],p);var b=p,f=(0,i(1001).Z)(b,(function(){var t=this,a=t._self._c;t._self._setupProxy;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.parentLoading,expression:"parentLoading"}],staticClass:"container"},[a("div",{staticClass:"header"},[a("back-button",{attrs:{page:t.StakingPageNames.Staking}}),t.stakingInitialized?a("s-button",{staticClass:"dropdown-menu-button",attrs:{type:"action",tooltip:t.t("headerMenu.settings")},on:{click:t.handleClickDropdownMenu}},[a("s-dropdown",{ref:"dropdown-menu",attrs:{"popper-class":"dropdown-menu",icon:"basic-more-vertical-24",type:"ellipsis",placement:"bottom-start"},on:{select:t.handleSelectDropdownMenuItem},scopedSlots:t._u([{key:"menu",fn:function(){return t._l(t.dropdownMenuItems,(function({value:i,text:s}){return a("s-dropdown-item",{key:i,staticClass:"dropdown-menu__item",attrs:{"data-test-name":i,value:i}},[t._v(" "+t._s(s)+" ")])}))},proxy:!0}],null,!1,3210154554)})],1):t._e()],1),a("div",{staticClass:"staking-logo-container"},[a("div",{staticClass:"staking-logo"},[a("token-logo",{staticClass:"token-logo",attrs:{token:t.stakingAsset,size:"large"}}),a("token-logo",{staticClass:"reward-token-logo",attrs:{token:t.rewardAsset,size:"medium"}})],1)]),a("h1",[t._v(t._s(t.t("soraStaking.overview.title")))]),t.stakingInitialized?t._e():a("p",[t._v(" "+t._s(t.t("soraStaking.overview.description"))+" ")]),t.isLoggedIn?[a("div",{staticClass:"additional-buttons"},[t.stakingInitialized?a("s-button",{staticClass:"additional-button s-typography-button--medium",on:{click:t.claimRewards}},[t._v(" "+t._s(t.t("soraStaking.actions.claim"))+" ")]):t._e(),t.stakingInitialized?a("s-button",{staticClass:"additional-button s-typography-button--medium",attrs:{disabled:t.lockedFunds.isZero()},on:{click:t.removeStake}},[t._v(" "+t._s(t.t("soraStaking.actions.remove"))+" ")]):t._e()],1),t.stakingInitialized?t._e():a("s-button",{staticClass:"action-button s-typography-button--medium",attrs:{type:"primary"},on:{click:t.stakeNew}},[t._v(" "+t._s(t.t("soraStaking.newStake.title"))+" ")]),t.stakingInitialized?a("s-button",{staticClass:"action-button s-typography-button--medium",attrs:{type:"primary"},on:{click:t.stakeMore}},[t._v(" "+t._s(t.stakeMoreText)+" ")]):t._e(),t.showWithdrawCard?a("s-card",{staticClass:"withdraw",attrs:{"border-radius":"medium",shadow:"always",size:"mini"}},[a("div",{staticClass:"withdraw-content"},[a("div",{staticClass:"withdraw-header"},[a("div",{staticClass:"withdraw-info"},[a("span",{staticClass:"withdraw-info-title"},[t._v(" "+t._s(t.t("soraStaking.withdraw.withdrawable"))+" ")]),a("formatted-amount-with-fiat-value",{staticClass:"withdraw-info-amount",attrs:{"asset-symbol":t.stakingAsset?.symbol,"symbol-as-decimal":"","value-can-be-hidden":"",value:t.withdrawableFundsFormatted,"fiat-value":t.withdrawableFundsFiat}})],1),a("div",{staticClass:"withdraw-info"},[a("span",{staticClass:"withdraw-info-title"},[t._v(" "+t._s(t.t("soraStaking.info.unstaking"))+" ")]),a("formatted-amount-with-fiat-value",{staticClass:"withdraw-info-amount",attrs:{"asset-symbol":t.stakingAsset?.symbol,"symbol-as-decimal":"","value-can-be-hidden":"",value:t.unlockingFundsFormatted,"fiat-value":t.unlockingFundsFiat}})],1),a("s-button",{staticClass:"withdraw-button",attrs:{disable:t.withdrawButtonDisabled,type:"primary",size:"small"},on:{click:t.handleWithdraw}},[t._v(" "+t._s(t.t("soraStaking.actions.withdraw"))+" ")])],1),t.showNextWithdrawal?a("div",{staticClass:"withdraw-footer"},[a("div",[a("span",[t._v(" "+t._s(t.t("soraStaking.withdraw.nextWithdrawal"))+": ")]),a("era-countdown",{staticClass:"countdown",attrs:{"target-era":t.nextWithdrawalEra}})],1),a("div",{directives:[{name:"button",rawName:"v-button"}],staticClass:"withdraw-see-all",on:{click:t.showAllWithdraws}},[t._v(" "+t._s(t.t("soraStaking.withdraw.seeAll"))+" ")])]):t._e()])]):t._e(),a("div",{staticClass:"info"},[t.stakingInitialized?a("info-line",{attrs:{label:t.t("soraStaking.info.stakingBalance"),value:t.lockedFundsFormatted,"asset-symbol":t.stakingAsset?.symbol,"fiat-value":t.lockedFundsFiat}}):t._e(),t.stakingInitialized?a("info-line",{attrs:{label:t.t("soraStaking.info.rewarded"),value:t.rewardedFundsFormatted,"asset-symbol":t.rewardAsset?.symbol,"fiat-value":t.rewardedFundsFiat}}):t._e(),t.stakingInitialized&&!t.showWithdrawCard?a("info-line",{attrs:{label:t.t("soraStaking.info.unstaking"),value:t.unlockingFundsFormatted,"asset-symbol":t.stakingAsset?.symbol,"fiat-value":t.unlockingFundsFiat}}):t._e(),t.stakingInitialized&&!t.showWithdrawCard?a("info-line",{attrs:{label:t.t("soraStaking.withdraw.withdrawable"),value:t.withdrawableFundsFormatted,"asset-symbol":t.stakingAsset?.symbol,"fiat-value":t.withdrawableFundsFiat}}):t._e(),t.stakingInitialized?t._e():a("info-line",{attrs:{label:t.t("soraStaking.info.totalLiquidityStaked"),value:t.totalStakedFormatted}}),t.stakingInitialized?t._e():a("info-line",{attrs:{label:t.TranslationConsts.APY,value:t.maxApy+"%"}}),a("info-line",{attrs:{label:t.t("soraStaking.info.rewardToken"),value:t.rewardAsset?.symbol}}),t.unbondPeriod?a("info-line",{attrs:{label:t.t("soraStaking.info.unstakingPeriod"),value:t.unbondPeriodFormatted}}):t._e(),t.stakingInitialized?t._e():a("info-line",{attrs:{label:t.t("soraStaking.info.minimumStake"),value:t.minNominatorBondFormatted,"asset-symbol":t.stakingAsset?.symbol,"is-formatted":""}}),null!==t.totalNominators?a("info-line",{attrs:{label:t.t("soraStaking.info.nominators"),value:`${t.totalNominators}`}}):t._e(),t.validators.length?a("info-line",{attrs:{label:t.t("soraStaking.info.validators"),value:`${t.validators.length}`}}):t._e()],1)]:a("s-button",{key:"disconnected",staticClass:"action-wallet s-typography-button--large action-button",attrs:{type:"primary"},on:{click:t.connectSoraWallet}},[t._v(" "+t._s(t.t("connectWalletText"))+" ")]),a("stake-dialog",{attrs:{mode:t.stakeDialogMode,visible:t.showStakeDialog,"parent-loading":t.parentLoading||t.loading},on:{"update:visible":function(a){t.showStakeDialog=a},confirm:t.handleStake}}),a("claim-rewards-dialog",{attrs:{visible:t.showClaimRewardsDialog,"parent-loading":t.parentLoading||t.loading},on:{"update:visible":function(a){t.showClaimRewardsDialog=a},"show-rewards":t.showRewards}}),a("withdraw-dialog",{attrs:{visible:t.showWithdrawDialog,"parent-loading":t.parentLoading||t.loading},on:{"update:visible":function(a){t.showWithdrawDialog=a},"show-all-withdraws":t.showAllWithdraws}}),a("all-withdraws-dialog",{attrs:{visible:t.showAllWithdrawsDialog,"parent-loading":t.parentLoading||t.loading},on:{"update:visible":function(a){t.showAllWithdrawsDialog=a}}}),a("pending-rewards-dialog",{attrs:{visible:t.showPendingRewardsDialog,"parent-loading":t.parentLoading||t.loading},on:{"update:visible":function(a){t.showPendingRewardsDialog=a}}}),a("validators-dialog",{attrs:{visible:t.showValidatorsDialog,"parent-loading":t.parentLoading||t.loading},on:{"update:visible":function(a){t.showValidatorsDialog=a},confirm:t.handleNominate}})],2)}),[],!1,null,"77064c6c",null).exports}}]);
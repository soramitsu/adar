"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[472,9990,277],{7584:function(t,e,s){s.r(e),s.d(e,{default:function(){return T}});var a=s(23166),i=(s(70560),s(97582)),o=s(37981),n=s(69826),r=s(86424),u=s(89445),l=s(68282),d=s(96813),p=s(36910),c=s(96520),m=s(69781),g=s(49053),h=s(50961),v=s(88368);let A=class extends((0,u.Wr)(r.tA.TransactionMixin,r.tA.FormattedAmountMixin)){constructor(...t){super(...t),(0,a.Z)(this,"inputToken",void 0),(0,a.Z)(this,"nextStage",void 0),(0,a.Z)(this,"recipients",void 0),(0,a.Z)(this,"accountAssets",void 0),(0,a.Z)(this,"setInputToken",void 0),(0,a.Z)(this,"cancelProcessing",void 0),(0,a.Z)(this,"runAssetsRouting",void 0),(0,a.Z)(this,"networkFees",void 0),(0,a.Z)(this,"setSlippageTolerance",void 0),(0,a.Z)(this,"xor",void 0),(0,a.Z)(this,"recipientsGroupedByToken",void 0),(0,a.Z)(this,"transferTxsAmountInfo",void 0),(0,a.Z)(this,"swapTxsAmountInfo",void 0),(0,a.Z)(this,"overallUSDNumber",void 0),(0,a.Z)(this,"slippageMultiplier",void 0),(0,a.Z)(this,"maxInputAmount",void 0),(0,a.Z)(this,"outcomeAssetsAmountsList",void 0),(0,a.Z)(this,"isLoggedIn",void 0),(0,a.Z)(this,"unavailableLiquidityAssetAddresses",void 0),(0,a.Z)(this,"isLiquidityUnavailable",void 0),(0,a.Z)(this,"assetsDataTable",void 0),(0,a.Z)(this,"adarSwapEnabled",void 0),(0,a.Z)(this,"transferTokenBalance",void 0),(0,a.Z)(this,"showSwapDialog",!1),(0,a.Z)(this,"showSelectInputAssetDialog",!1),(0,a.Z)(this,"xorSymbol",n.XOR.symbol),(0,a.Z)(this,"swapData",null)}onInputAssetSelected(t){this.setInputToken(t),this.showSelectInputAssetDialog=!1}onSelectInputAssetClick(){this.showSelectInputAssetDialog=!0}updatePriceImpact(t){this.setSlippageTolerance(t)}getAmountLabel(t){return`${t?this.t("operations.Transfer"):this.t("operations.Swap")} ${this.t("adar.routeAssets.stages.reviewDetails.swapless.amount")}`}get continueButtonTitle(){return this.isLiquidityUnavailable?this.t("swap.insufficientLiquidity"):this.amountBalanceError||this.xorFeeBalanceError||this.transferBalanceErrors?this.t("insufficientBalanceText"):this.t("adar.routeAssets.continue")}get slippages(){return["1","2","3"]}get allTxsAreTransfers(){return!this.adarSwapEnabled||this.recipients.every((t=>t.useTransfer))}get assetsList(){const t={asset:this.inputToken,adarFee:this.adarFee,amount:this.estimatedAmount,amountRequired:this.remainingAmountRequired,totalAmount:this.estimatedAmountWithFees,userBalance:this.fpBalance,usd:this.swapTxsAmountInfo.reduce(((t,e)=>t.add(e.usd)),o.FPNumber.ZERO),priceImpact:this.estimatedPriceImpact.toLocaleString(4),transfer:!1},e=this.transferTxsAmountInfo.map((t=>({transfer:!0,...t})));return this.allTxsAreTransfers||e.push(t),e}get outcomeAssetsAmountsListFiltered(){return[...this.transferTxsAmountInfo.map((t=>({transfer:!0,...t})))]}get currentSlippage(){return this.slippageMultiplier}get isInputAssetXor(){return this.inputToken?.address===n.XOR.address}get noIssues(){return!(this.amountBalanceError||this.xorFeeBalanceError||this.transferBalanceErrors||this.isLiquidityUnavailable)}get amountBalanceError(){return o.FPNumber.isGreaterThan(this.remainingAmountRequired,o.FPNumber.ZERO)}get xorFeeBalanceError(){return o.FPNumber.isGreaterThan(this.networkFee,this.xorBalance)&&!this.isInputAssetXor}get transferBalanceErrors(){return this.outcomeAssetsAmountsListFiltered.some((t=>{const{asset:e,totalAmount:s}=t;return o.FPNumber.gt(this.tokenTransferAmountRequired(e,s),o.FPNumber.ZERO)}))}tokenTransferAmountRequired(t,e){const s=this.transferTokenBalance(t.address);return e.sub(s)}get usdToBeRouted(){return this.overallUSDNumber}get estimatedAmount(){return this.maxInputAmount.totalAmount}get adarFeeMultiplier(){return new o.FPNumber(p._g).div(o.FPNumber.HUNDRED)}get adarFeePercent(){return this.adarFeeMultiplier.mul(o.FPNumber.HUNDRED).toLocaleString()}get priceImpactMultiplier(){return new o.FPNumber(this.slippageMultiplier).div(o.FPNumber.HUNDRED)}get priceImpactPercent(){return new o.FPNumber(this.slippageMultiplier).toLocaleString()}get networkFee(){return o.FPNumber.fromCodecValue(this.networkFees[o.Operation.SwapTransferBatch]).mul(new o.FPNumber(this.recipients.length))}get adarFee(){return this.estimatedAmount.mul(this.adarFeeMultiplier)}get estimatedPriceImpact(){return this.estimatedAmount.mul(this.priceImpactMultiplier)}get estimatedAmountWithFees(){return this.isInputAssetXor?this.maxInputAmount.totalAmountWithFee.add(this.networkFee):this.maxInputAmount.totalAmountWithFee}get totalTokensAvailable(){return this.formattedBalance}get remainingAmountRequired(){return this.estimatedAmountWithFees.sub(this.fpBalance)}get xorFeeRequired(){return this.networkFee.sub(this.xorBalance)}get xorBalance(){return o.FPNumber.fromCodecValue(this.getTokenBalance(n.XOR),n.XOR?.decimals)}get recipientsData(){return this.recipientsGroupedByToken()}get routingSwapData(){return{assetFrom:this.inputToken?.symbol===n.XOR?.symbol?n.VAL:n.XOR,assetTo:this.inputToken,valueTo:this.remainingAmountRequired}}get xorFeeSwapData(){return{assetFrom:n.VAL,assetTo:n.XOR,valueTo:this.xorFeeRequired}}get totalAmountRequired(){return this.outcomeAssetsAmountsListFiltered.reduce(((t,e)=>t.add(e.amountRequired)),this.remainingAmountRequired.add(this.xorFeeRequired)).toString()}onAddFundsClick(t){this.swapData="fee"===t?this.xorFeeSwapData:this.routingSwapData,this.showSwapDialog=!0}onTransferAddFundsClick(t){const e=t.amountRequired;let s;s=this.inputToken.address!==t.asset.address?this.inputToken:t.asset.address===n.XOR.address?n.VAL:n.XOR,this.swapData={assetFrom:s,assetTo:t.asset,valueTo:e},this.showSwapDialog=!0}get unavailableSymbols(){return this.unavailableLiquidityAssetAddresses.map((t=>this.assetsDataTable[t]?.symbol))}isTransferAssetBalanceOk(t){return o.FPNumber.lte(this.tokenTransferAmountRequired(t.asset,t.totalAmount),o.FPNumber.ZERO)}get fpBalance(){return(0,h.rh)(this.inputToken)?o.FPNumber.fromCodecValue((0,h.rh)(this.inputToken),this.decimals):o.FPNumber.ZERO}get decimals(){return this.inputToken?.decimals??o.FPNumber.DEFAULT_PRECISION}get formattedBalance(){return this.fpBalance.dp(6).toLocaleString()}getTokenBalance(t){const e=this.accountAssets.find((e=>e.address===t.address));return(0,h.rh)(e)}formatNumber(t){return t&&t.isFinity()?t.dp(4).toLocaleString():"-"}cancelButtonAction(){this.cancelProcessing()}onContinueClick(){this.runAssetsRouting(),this.nextStage()}onTransferTokenRequiredChanged(){this.showSwapDialog=!1}};(0,i.gn)([g.Yn.routeAssets.inputToken],A.prototype,"inputToken",void 0),(0,i.gn)([g.aD.routeAssets.processingNextStage],A.prototype,"nextStage",void 0),(0,i.gn)([g.Yn.routeAssets.recipients],A.prototype,"recipients",void 0),(0,i.gn)([g.SB.wallet.account.accountAssets],A.prototype,"accountAssets",void 0),(0,i.gn)([g.aD.routeAssets.setInputToken],A.prototype,"setInputToken",void 0),(0,i.gn)([g.aD.routeAssets.cancelProcessing],A.prototype,"cancelProcessing",void 0),(0,i.gn)([g.aD.routeAssets.runAssetsRouting],A.prototype,"runAssetsRouting",void 0),(0,i.gn)([g.SB.wallet.settings.networkFees],A.prototype,"networkFees",void 0),(0,i.gn)([g.QF.routeAssets.setSlippageTolerance],A.prototype,"setSlippageTolerance",void 0),(0,i.gn)([g.Yn.assets.xor],A.prototype,"xor",void 0),(0,i.gn)([g.Yn.routeAssets.recipientsGroupedByToken],A.prototype,"recipientsGroupedByToken",void 0),(0,i.gn)([g.Yn.routeAssets.transferTxsAmountInfo],A.prototype,"transferTxsAmountInfo",void 0),(0,i.gn)([g.Yn.routeAssets.swapTxsAmountInfo],A.prototype,"swapTxsAmountInfo",void 0),(0,i.gn)([g.Yn.routeAssets.overallUSDNumber],A.prototype,"overallUSDNumber",void 0),(0,i.gn)([g.Yn.routeAssets.slippageTolerance],A.prototype,"slippageMultiplier",void 0),(0,i.gn)([g.Yn.routeAssets.maxInputAmount],A.prototype,"maxInputAmount",void 0),(0,i.gn)([g.Yn.routeAssets.outcomeAssetsAmountsList],A.prototype,"outcomeAssetsAmountsList",void 0),(0,i.gn)([g.Yn.wallet.account.isLoggedIn],A.prototype,"isLoggedIn",void 0),(0,i.gn)([g.Yn.routeAssets.unavailableLiquidityAssetAddresses],A.prototype,"unavailableLiquidityAssetAddresses",void 0),(0,i.gn)([g.Yn.routeAssets.isLiquidityUnavailable],A.prototype,"isLiquidityUnavailable",void 0),(0,i.gn)([g.Yn.wallet.account.assetsDataTable],A.prototype,"assetsDataTable",void 0),(0,i.gn)([g.Yn.routeAssets.adarSwapEnabled],A.prototype,"adarSwapEnabled",void 0),(0,i.gn)([g.Yn.routeAssets.transferTokenBalance],A.prototype,"transferTokenBalance",void 0),(0,i.gn)([(0,u.RL)("totalAmountRequired")],A.prototype,"onTransferTokenRequiredChanged",null),A=(0,i.gn)([(0,u.wA)({components:{TokenLogo:r.wx.TokenLogo,SwapDialog:(0,c.y)(p.EC.RouteAssetsSwapDialog),WarningMessage:v.default,SelectInputAssetDialog:(0,c.y)(p.EC.RouteAssetsSelectInputAssetDialog),SlippageTolerance:d.default,InfoLine:r.wx.InfoLine,SelectToken:(0,m.kF)(l.z8.SelectToken)}})],A);var f=A,b=(0,s(1001).Z)(f,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"route-assets-review-details"},[e("div",{staticClass:"container review-details-section"},[e("div",{staticClass:"route-assets__page-header-title"},[t._v(t._s(t.t("adar.routeAssets.stages.reviewDetails.title")))]),e("div",{staticClass:"route-assets__page-header-description"},[t._v(" "+t._s(t.t("adar.routeAssets.stages.reviewDetails.description"))+" ")]),e("div",{staticClass:"fields-container"},[t.allTxsAreTransfers?t._e():[e("div",{staticClass:"field"},[e("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.inputAsset")))]),e("div",{staticClass:"field__value pointer",on:{click:t.onSelectInputAssetClick}},[e("div",[t._v(t._s(t.inputToken.symbol))]),e("div",[e("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1),e("div",[e("s-icon",{attrs:{name:"arrows-chevron-down-rounded-24",size:"20"}})],1)])]),e("s-divider")],e("div",{staticClass:"field"},[e("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.totalUsdToRoute")))]),e("div",{staticClass:"field__value usd"},[t._v(t._s(t.usdToBeRouted))])]),e("s-divider"),e("div",{staticClass:"transfer-assets-section"},[e("p",{staticClass:"transfer-assets-section__title"},[t.transferBalanceErrors||t.amountBalanceError?e("s-icon",{staticClass:"icon-status",attrs:{name:"basic-clear-X-xs-24"}}):t._e(),t._v(" "+t._s(t.t("adar.routeAssets.stages.reviewDetails.useTransferTitle"))+" ")],1),e("s-collapse",t._l(t.assetsList,(function(s,a){return e("s-collapse-item",{key:a,scopedSlots:t._u([{key:"title",fn:function(){return[e("div",{staticClass:"amount-info__asset-symbol"},[e("token-logo",{attrs:{token:s.asset,size:"big"}}),e("div",{staticClass:"amount-info__asset-info"},[e("div",{staticClass:"amount-info__asset-info-line amount-info__asset-info-line_upper"},[e("div",{staticClass:"amount-info__asset-label"},[t._v(t._s(s.asset.symbol))]),e("div",{staticClass:"amount-info__tx-type"},[t._v(" "+t._s(s.transfer?t.t("operations.Transfer"):t.t("operations.Swap"))+" ")])]),e("div",{staticClass:"amount-info__asset-info-line"},[e("span",[t._v(t._s(`${s.totalAmount.toLocaleString()} ${s.asset.symbol} `))]),e("span",{staticClass:"usd"},[t._v(t._s(s.usd.toLocaleString(2)))])])])],1)]},proxy:!0}],null,!0)},[e("div",[e("info-line",{staticClass:"transfer-assets-section__asset-data",attrs:{"asset-symbol":s.asset.symbol,label:t.t("adar.routeAssets.stages.reviewDetails.swapless.adarFee"),value:s.adarFee.toLocaleString(),"is-formatted":""}}),e("info-line",{staticClass:"transfer-assets-section__asset-data",attrs:{"asset-symbol":s.asset.symbol,label:t.getAmountLabel(s.transfer),value:s.amount.toLocaleString(),"is-formatted":""}}),e("info-line",{staticClass:"transfer-assets-section__asset-data",attrs:{"asset-symbol":s.asset.symbol,label:t.t("adar.routeAssets.stages.reviewDetails.swapless.balance"),value:s.userBalance.toLocaleString(),"is-formatted":""}}),t.isTransferAssetBalanceOk(s)?t._e():e("div",{staticClass:"transfer-assets-section__required-amount required-amount"},[e("div",[e("div",[t._v(t._s(t.t("adar.routeAssets.stages.reviewDetails.swapless.required")))]),e("div",{staticClass:"required-amount__amount"},[t._v(t._s(s.amountRequired.toLocaleString()))])]),e("s-button",{staticClass:"s-typography-button--mini add-button",attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.onTransferAddFundsClick(s)}}},[t._v(" "+t._s(t.t("adar.routeAssets.stages.reviewDetails.add"))+" ")])],1)],1)])})),1)],1),e("slippage-tolerance",{attrs:{slippages:t.slippages,slippageTolerance:t.currentSlippage},on:{onSlippageChanged:t.updatePriceImpact}}),t.xorFeeBalanceError?[e("div",{staticClass:"field"},[e("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.stages.reviewDetails.feeRequired")))]),e("div",{staticClass:"field__value"},[e("s-button",{staticClass:"s-typography-button--mini add-button",attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.onAddFundsClick("fee")}}},[t._v(" "+t._s(t.t("adar.routeAssets.stages.reviewDetails.add"))+" ")]),t._v(" "+t._s(t.formatNumber(t.xorFeeRequired))+" "),e("token-logo",{staticClass:"token-logo",attrs:{token:t.xor}})],1)]),e("s-divider")]:t._e(),e("div",{staticClass:"fields-container"},[t.isLoggedIn?e("info-line",{attrs:{label:t.t("networkFeeText"),"label-tooltip":t.t("networkFeeTooltipText"),value:t.formatNumber(t.networkFee),"asset-symbol":t.xorSymbol,"fiat-value":t.getFiatAmountByFPNumber(t.networkFee),"is-formatted":""}}):t._e(),e("info-line",{attrs:{label:t.t("swap.liquidityProviderFee"),"label-tooltip":t.t("swap.liquidityProviderFeeTooltip"),value:t.formatNumber(t.maxInputAmount.totalLiquidityProviderFee),"asset-symbol":t.xorSymbol,"is-formatted":""}})],1),e("div",{staticClass:"buttons-container"},[e("s-button",{staticClass:"s-typography-button--big",attrs:{type:"primary",disabled:!t.noIssues},on:{click:function(e){return e.stopPropagation(),t.onContinueClick.apply(null,arguments)}}},[t._v(" "+t._s(t.continueButtonTitle)+" ")]),e("s-button",{staticClass:"s-typography-button--big",attrs:{type:"secondary"},on:{click:function(e){return e.stopPropagation(),t.cancelButtonAction.apply(null,arguments)}}},[t._v(" "+t._s(t.t("adar.routeAssets.cancelProcessing"))+" ")])],1)],2)]),e("swap-dialog",{attrs:{visible:t.showSwapDialog,presetSwapData:t.swapData},on:{"update:visible":function(e){t.showSwapDialog=e}}}),e("select-token",{attrs:{visible:t.showSelectInputAssetDialog,connected:t.isLoggedIn},on:{"update:visible":function(e){t.showSelectInputAssetDialog=e},select:t.onInputAssetSelected}})],1)}),[],!1,null,"dcc00942",null),T=b.exports}}]);
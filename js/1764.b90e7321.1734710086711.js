"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[1764,5099,277],{910:function(t,s,e){e.r(s),e.d(s,{default:function(){return y}});var i=e(23166),o=e(97582),a=e(37981),r=e(86424),n=e(50647),l=e(18159),d=e.n(l),u=e(89445),c=e(89334),h=e(67445),p=e(36910),g=e(96520),m=e(49053),v=e(34347),f=e(88368);let b=class extends((0,u.Wr)(c.Z)){constructor(...t){super(...t),(0,i.Z)(this,"inputToken",void 0),(0,i.Z)(this,"incompletedRecipients",void 0),(0,i.Z)(this,"recipients",void 0),(0,i.Z)(this,"batchTxInfo",void 0),(0,i.Z)(this,"batchTxDatetime",void 0),(0,i.Z)(this,"fiatPriceObject",void 0),(0,i.Z)(this,"cancelProcessing",void 0),(0,i.Z)(this,"overallUSDNumber",void 0),(0,i.Z)(this,"maxInputAmount",void 0),(0,i.Z)(this,"txHistoryData",void 0),(0,i.Z)(this,"batchTxStatus",void 0),(0,i.Z)(this,"recipientsGroupedByToken",void 0),(0,i.Z)(this,"showFailedTransactionsDialog",!1),(0,i.Z)(this,"showFinishRoutingDialog",!1),(0,i.Z)(this,"showSelectReportFormatDialog",!1),(0,i.Z)(this,"headers",["â„–",this.t("adar.routeAssets.name"),this.t("adar.routeAssets.wallet"),this.t("adar.routeAssets.usd"),this.t("adar.routeAssets.inputAsset"),this.t("adar.routeAssets.asset"),this.t("adar.routeAssets.stages.transactionOverview.amount"),this.t("adar.routeAssets.stages.done.report.exchangeRate")])}get finalAmount(){return this.batchTxStatus===v.c.FAILED?"0":this.txHistoryData?.amount}get txHistoryDataReceivers(){return this.txHistoryData?.payload?.receivers||[]}get finalAmountFormatted(){return new a.FPNumber(this.finalAmount??0).toLocaleString(4)}get incompletedRecipientsLength(){return this.incompletedRecipients.length}get totalUSD(){return this.batchTxStatus===v.c.FAILED?"0":this.overallUSDNumber}get withErrors(){return this.incompletedRecipientsLength>0}get summaryData(){return this.recipientsGroupedByToken().map((t=>({status:this.getStatus(this.withErrors),...t})))}getStatus(t=!1){return t?this.t("adar.routeAssets.txStatus.failed"):this.t("adar.routeAssets.txStatus.success")}getAssetUSDPrice(t){return a.FPNumber.fromCodecValue(this.fiatPriceObject[t.address]??0,18)}getRecipientTransferAmount(t,s){const e=t.startsWith("cn")?t:r.hi.formatAddress(t);return new a.FPNumber(this.txHistoryDataReceivers.find((t=>t.accountId===e&&t.asset.address===s))?.amount??"0")}formatNumber(t,s=4){return t.toLocaleString(s)}openFinishRoutingDialog(){this.showFinishRoutingDialog=!0}onFinishRouting(){this.cancelProcessing(),this.showFinishRoutingDialog=!1}onReportDownloadClick(){this.showSelectReportFormatDialog=!0}getReportData(t=!1){return this.recipients.map(((s,e)=>{const i=s.usd.dp(2),o=s.amount??a.FPNumber.ZERO,r=s.exchangeRate??a.FPNumber.ZERO;return[`${e+1}`,s.name,s.wallet,t?i.toFixed(2):i.toLocaleString(),s.useTransfer?s.asset.symbol:this.inputToken.symbol,s.asset.symbol,t?o.toFixed(7):o.toLocaleString(),t?r.toFixed(7):r.toLocaleString()]}))}downloadCSV(t){const{txId:s,blockId:e,from:i,blockNumber:o}=this.batchTxInfo,a=this.batchTxDatetime,r=`data:text/csv;charset=utf-8,${this.t("adar.routeAssets.stages.done.report.datetime")} - ${a?.toUTCString()}\n${this.t("adar.routeAssets.stages.done.report.timestampUTC")} - ${a?.getTime()}\n`+this.headers.join(",")+`,${this.t("adar.routeAssets.stages.done.report.transactionId")},${this.t("adar.routeAssets.stages.done.report.blockNumber")},${this.t("adar.routeAssets.stages.done.report.senderWallet")}\n`+this.getReportData(!0).map((t=>`${t.join(",")},${s},${o},${i}`)).join("\n"),n=encodeURI(r),l=document.createElement("a");l.setAttribute("href",n),l.setAttribute("download",`${t}.csv`),document.body.appendChild(l),l.click()}downloadPDF(t){const s=new n.jsPDF({putOnlyUsedFonts:!0,orientation:"landscape"}),{txId:e,blockId:i,from:o,blockNumber:a}=this.batchTxInfo,r=this.batchTxDatetime;s.setFontSize(12),s.text(`${this.t("adar.routeAssets.stages.done.report.transactionId")} - ${e}`,5,5),s.text(`${this.t("adar.routeAssets.stages.done.report.blockNumber")} - ${a}`,5,10),s.text(`${this.t("adar.routeAssets.stages.done.report.blockId")} - ${i}`,5,15),s.text(`${this.t("adar.routeAssets.stages.done.report.senderWallet")} - ${o}`,5,20),s.text(`${this.t("adar.routeAssets.stages.done.report.datetime")} - ${r?.toUTCString()}`,5,25),s.text(`${this.t("adar.routeAssets.stages.done.report.timestampUTC")} - ${r?.getTime()}`,5,30),d()(s,{head:[this.headers],body:this.getReportData(),startY:35,rowPageBreak:"avoid",margin:{top:5,left:5,right:5,bottom:5},styles:{lineColor:[237,228,231],lineWidth:.3,fontSize:10},headStyles:{textColor:[161,154,157],fillColor:[253,247,251]},bodyStyles:{fillColor:[253,247,251],textColor:[38,38,45],cellPadding:{top:10,right:5,bottom:10,left:5}},alternateRowStyles:{fillColor:[255,250,251]},columnStyles:{0:{cellWidth:10,cellPadding:{top:10,right:2,bottom:10,left:2}},1:{minCellWidth:30},3:{minCellWidth:25},4:{cellWidth:25},5:{cellWidth:25},6:{minCellWidth:45},7:{minCellWidth:25},8:{fontStyle:"bold",cellWidth:25}},didParseCell:function(t){"body"===t.row.section&&(t.cell.text.includes(v.p.FAILED)&&(t.cell.styles.textColor=[231,76,60]),t.cell.text.includes(v.p.SUCCESS)&&(t.cell.styles.textColor=[52,173,135]))}}),s.save(`${t}.pdf`)}};(0,o.gn)([m.Yn.routeAssets.inputToken],b.prototype,"inputToken",void 0),(0,o.gn)([m.Yn.routeAssets.incompletedRecipients],b.prototype,"incompletedRecipients",void 0),(0,o.gn)([m.Yn.routeAssets.recipients],b.prototype,"recipients",void 0),(0,o.gn)([m.Yn.routeAssets.batchTxInfo],b.prototype,"batchTxInfo",void 0),(0,o.gn)([m.Yn.routeAssets.batchTxDatetime],b.prototype,"batchTxDatetime",void 0),(0,o.gn)([m.SB.wallet.account.fiatPriceObject],b.prototype,"fiatPriceObject",void 0),(0,o.gn)([m.aD.routeAssets.cancelProcessing],b.prototype,"cancelProcessing",void 0),(0,o.gn)([m.Yn.routeAssets.overallUSDNumber],b.prototype,"overallUSDNumber",void 0),(0,o.gn)([m.Yn.routeAssets.maxInputAmount],b.prototype,"maxInputAmount",void 0),(0,o.gn)([m.Yn.routeAssets.txHistoryData],b.prototype,"txHistoryData",void 0),(0,o.gn)([m.Yn.routeAssets.batchTxStatus],b.prototype,"batchTxStatus",void 0),(0,o.gn)([m.Yn.routeAssets.recipientsGroupedByToken],b.prototype,"recipientsGroupedByToken",void 0),b=(0,o.gn)([(0,u.wA)({components:{TokenLogo:r.wx.TokenLogo,WarningMessage:f.default,FailedTransactionsDialog:(0,g.y)(p.EC.RouteAssetsFailedTransactionsDialog),ConfirmFinishRoutingDialog:(0,g.y)(p.EC.RouteAssetsConfirmFinishRoutingDialog),SelectReportFormatDialog:(0,g.y)(p.EC.RouteAssetsSelectReportFormatDialog),Spinner:h.default}})],b);var _=b,C=(0,e(1001).Z)(_,(function(){var t=this,s=t._self._c;t._self._setupProxy;return s("div",{staticClass:"route-assets-done-page"},[s("div",{staticClass:"container routing-summary-section"},[s("div",{staticClass:"route-assets__page-header-title"},[t._v(t._s(t.t("adar.routeAssets.stages.done.title")))]),s("div",{staticClass:"route-assets__page-header-description"},[t._v(" "+t._s(t.t("adar.routeAssets.stages.done.description"))+" ")]),s("div",{staticClass:"fields-container"},[t.finalAmount?s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.total")))]),s("div",{staticClass:"field__value"},[s("span",{staticClass:"usd"},[t._v(t._s(t.totalUSD))])])]):s("div",[s("spinner")],1),s("s-divider"),t.incompletedRecipientsLength>0?s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.stages.done.failedTransactions")))]),s("warning-message",{staticClass:"warning-message",attrs:{text:t.t("adar.routeAssets.stages.done.rerun"),isError:!0}}),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.incompletedRecipientsLength)+" ")])],1):t._e()],1),s("div",{staticClass:"buttons-container"},[t.withErrors?s("s-button",{staticClass:"s-typography-button--medium",attrs:{type:"primary"},on:{click:function(s){s.stopPropagation(),t.showFailedTransactionsDialog=!0}}},[t._v(" "+t._s(t.t("adar.routeAssets.stages.done.rerun"))+" ")]):t._e(),t.withErrors?t._e():s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"secondary",disabled:!t.finalAmount},on:{click:function(s){return s.stopPropagation(),t.onReportDownloadClick()}}},[t._v(" "+t._s(t.t("adar.routeAssets.stages.done.pdfButton"))+" ")]),t.withErrors?s("s-button",{staticClass:"s-typography-button--big open-finish-routing-button",attrs:{type:"link"},on:{click:function(s){return s.stopPropagation(),t.openFinishRoutingDialog.apply(null,arguments)}}},[s("span",[t._v(t._s(t.t("adar.routeAssets.stages.done.finishAnyway")))])]):s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"primary"},on:{click:function(s){return s.stopPropagation(),t.onFinishRouting.apply(null,arguments)}}},[t._v(" "+t._s(t.t("adar.routeAssets.stages.done.finish"))+" ")])],1)]),t.summaryData.length>0?s("div",{staticClass:"container routing-details-section"},[s("div",{staticClass:"route-assets__page-header-title"},[t._v(t._s(t.t("adar.routeAssets.stages.done.routingDetails.title")))]),t._l(t.summaryData,(function(e,i){return s("div",{key:i,staticClass:"asset-data-container fields-container"},[s("div",{staticClass:"asset-title"},[s("div",[s("token-logo",{staticClass:"token-logo",attrs:{token:e.asset}})],1),s("div",[t._v(t._s(e.asset.symbol))])]),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.recipients")))]),s("div",{staticClass:"field__value"},[t._v(t._s(e.recipientsNumber))])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.stages.done.routingDetails.amount")))]),s("div",{staticClass:"field__value"},[t._v(t._s(t.formatNumber(e.total)))]),s("div",{staticClass:"field__value usd"},[t._v(t._s(t.formatNumber(e.usd,2)))])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v(t._s(t.t("adar.routeAssets.txStatus.status")))]),s("div",{staticClass:"field__value",class:`field__value_${e.status}`},[t._v(t._s(e.status))])])],1)}))],2):t._e(),s("failed-transactions-dialog",{attrs:{visible:t.showFailedTransactionsDialog},on:{"update:visible":function(s){t.showFailedTransactionsDialog=s}}}),s("confirm-finish-routing-dialog",{attrs:{visible:t.showFinishRoutingDialog},on:{"update:visible":function(s){t.showFinishRoutingDialog=s},onConfirmClick:t.onFinishRouting}}),s("select-report-format-dialog",{attrs:{visible:t.showSelectReportFormatDialog},on:{"update:visible":function(s){t.showSelectReportFormatDialog=s},onConfirmClick:t.onFinishRouting,onPDFSelect:t.downloadPDF,onCSVSelect:t.downloadCSV}})],1)}),[],!1,null,"9ee67c12",null),y=C.exports}}]);
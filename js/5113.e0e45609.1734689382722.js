"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[5113],{95113:function(t,e,i){i.r(e),i.d(e,{default:function(){return Z}});var o=i(23166),s=(i(70560),i(97582)),a=i(25309),r=i.n(a),n=i(77606),d=i.n(n),u=i(25387),l=i.n(u),p=i(76262),y=i.n(p),g=i(77502),h=i(89445),c=i(19307),v=i(90744);const f={[c.Av.lg]:c.Uo.HugeDesktop,[c.Av.md]:c.Uo.LargeDesktop,[c.Av.sm]:c.Uo.Desktop,[c.Av.xs]:c.Uo.Tablet,[c.Av.xss]:0},b={[c.Av.lg]:24,[c.Av.md]:16,[c.Av.sm]:12,[c.Av.xs]:8,[c.Av.xss]:4};function m(t,e){return t?.find((t=>t.i===e))}function L(t,e){const i=function(t){return Object.keys(t).sort((function(e,i){return t[e]-t[i]}))}(t);let o=i[0];for(let s=1,a=i.length;s<a;s++){const a=i[s];e>t[a]&&(o=a)}return o}let k=class extends h.w3{constructor(...t){super(...t),(0,o.Z)(this,"widgetsGrid",void 0),(0,o.Z)(this,"gridId",void 0),(0,o.Z)(this,"defaultLayouts",void 0),(0,o.Z)(this,"rowHeight",void 0),(0,o.Z)(this,"margin",void 0),(0,o.Z)(this,"draggable",void 0),(0,o.Z)(this,"resizable",void 0),(0,o.Z)(this,"compact",void 0),(0,o.Z)(this,"lines",void 0),(0,o.Z)(this,"cols",void 0),(0,o.Z)(this,"breakpoints",void 0),(0,o.Z)(this,"loading",void 0),(0,o.Z)(this,"flat",void 0),(0,o.Z)(this,"value",void 0),(0,o.Z)(this,"defaultValue",{}),(0,o.Z)(this,"breakpoint",c.Av.lg),(0,o.Z)(this,"layouts",{}),(0,o.Z)(this,"layout",[])}updateLayoutWidgetsByModel(t,e){const i=(o=t,s=e,Object.entries(o).reduce(((t,[e,i])=>l()(s[e],i)?t:{...t,[e]:i}),{}));var o,s;d()(i)||this.updateLayoutsByWidgetsModel(this.layouts,i,!0)}get responsiveLayout(){return this.layouts[this.breakpoint]}get gridLinesStyle(){const t=this.rowHeight,e=this.margin/2;return{backgroundSize:`calc(calc(100% - ${e}px) / ${this.cols[this.breakpoint]}) ${t+2*e}px`,height:`calc(100% - ${e}px)`,width:`calc(100% - ${e}px)`,margin:`${e}px`}}created(){this.defaultValue=r()(this.value)}mounted(){this.breakpoint=L(this.breakpoints,this.widgetsGrid.$el.clientWidth),this.init()}async init(){const t=v.uM.get(this.gridId);t?this.saveLayouts(JSON.parse(t),!1):this.updateLayoutsByWidgetsModel(this.defaultLayouts,this.defaultValue,!1),this.updateWidgetsModelByLayout()}updateLayout(){l()(this.layout)(this.responsiveLayout)||(this.layout=r()(this.responsiveLayout))}saveLayouts(t,e=!0){this.layouts=r()(t),this.updateLayout(),e&&this.saveLayoutsToStorage()}saveLayoutsToStorage(){this.gridId&&v.uM.set(this.gridId,JSON.stringify(this.layouts))}clearLayoutsFromStorage(){this.gridId&&v.uM.remove(this.gridId)}reset(){this.clearLayoutsFromStorage(),this.init()}onBreakpointChanged(t){this.breakpoint=t,this.updateLayout()}onLayoutUpdate(t){this.layout=t;const e=this.layout.map((t=>y()("moved")(t)));l()(e)(this.responsiveLayout)||this.saveLayouts({...this.layouts,[this.breakpoint]:e})}isResizable(t){if(!this.resizable)return!1;const{maxW:e,maxH:i,minW:o,minH:s}=t;return!(e===o&&i===s)}onResize(t,e){const i=r()(this.layout),o=m(i,t);if(!o)return;const{height:s}=e,a=Math.ceil((s+this.margin)/(this.rowHeight+this.margin)),n=Math.max(o.minH??1,a);o.h=n,this.layout=i}updateWidgetsModelByLayout(){const t=Object.keys(this.value).reduce(((t,e)=>({...t,[e]:!1})),{});return this.layout.reduce(((t,e)=>(e.i in t&&(t[e.i]=!0),t)),t)}updateLayoutsByWidgetsModel(t,e,i){const o=r()(t);for(const[t,i]of Object.entries(e))for(const e in o)if(i){if(m(o[e],t))continue;const i=m(this.defaultLayouts[e],t);i&&o[e].push(i)}else o[e]=o[e].filter((e=>e.i!==t));this.saveLayouts(o,i)}};(0,s.gn)([(0,h.Rl)("grid")],k.prototype,"widgetsGrid",void 0),(0,s.gn)([(0,h.fI)({default:"",type:String})],k.prototype,"gridId",void 0),(0,s.gn)([(0,h.fI)({default:()=>({}),type:Object})],k.prototype,"defaultLayouts",void 0),(0,s.gn)([(0,h.fI)({default:10,type:Number})],k.prototype,"rowHeight",void 0),(0,s.gn)([(0,h.fI)({default:16,type:Number})],k.prototype,"margin",void 0),(0,s.gn)([(0,h.fI)({default:!1,type:Boolean})],k.prototype,"draggable",void 0),(0,s.gn)([(0,h.fI)({default:!1,type:Boolean})],k.prototype,"resizable",void 0),(0,s.gn)([(0,h.fI)({default:!0,type:Boolean})],k.prototype,"compact",void 0),(0,s.gn)([(0,h.fI)({default:!1,type:Boolean})],k.prototype,"lines",void 0),(0,s.gn)([(0,h.fI)({default:()=>b,type:Object})],k.prototype,"cols",void 0),(0,s.gn)([(0,h.fI)({default:()=>f,type:Object})],k.prototype,"breakpoints",void 0),(0,s.gn)([(0,h.fI)({default:!1,type:Boolean})],k.prototype,"loading",void 0),(0,s.gn)([(0,h.fI)({default:!1,type:Boolean})],k.prototype,"flat",void 0),(0,s.gn)([(0,h.fI)({default:()=>({}),type:Object})],k.prototype,"value",void 0),(0,s.gn)([(0,h.RL)("value")],k.prototype,"updateLayoutWidgetsByModel",null),(0,s.gn)([(0,h.y1)("input")],k.prototype,"updateWidgetsModelByLayout",null),k=(0,s.gn)([(0,h.wA)({components:{GridLayout:g.GridLayout,GridItem:g.GridItem}})],k);var I=k,Z=(0,i(1001).Z)(I,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("grid-layout",{ref:"grid",staticClass:"widgets-grid",attrs:{responsive:"",layout:t.layout,"responsive-layouts":t.layouts,cols:t.cols,breakpoints:t.breakpoints,"row-height":t.rowHeight,"is-draggable":t.draggable,"is-resizable":t.resizable,margin:[t.margin,t.margin],"prevent-collision":!1,"vertical-compact":t.compact,"use-css-transforms":!1},on:{"breakpoint-changed":t.onBreakpointChanged,"layout-updated":t.onLayoutUpdate}},[t.lines?e("div",{staticClass:"grid-lines",style:t.gridLinesStyle}):t._e(),e("transition-group",{attrs:{name:"list",tag:"div"}},t._l(t.layout,(function(i){return e("grid-item",t._b({key:i.i,attrs:{"is-resizable":t.isResizable(i)}},"grid-item",i,!1),[t._t(i.i,null,null,{id:i.i,flat:t.flat,loading:t.loading,onResize:t.onResize,reset:t.reset})],2)})),1)],1)}),[],!1,null,null,null).exports}}]);
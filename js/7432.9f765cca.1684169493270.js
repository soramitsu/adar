"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[7432],{97432:function(e,r,t){t.r(r),t.d(r,{default:function(){return _}});var s=t(60760),i=t(70655),a=t(52151),n=t.n(a),o=t(53545),d=t(50576),l=t(82753),c=t(36930),u=t(80710),f=t(16546),p=t(20439),h=t(85530),m=t(10909),v=t(74614);let g=class extends((0,o.Wr)(d.tA.LoadingMixin,d.tA.FormattedAmountMixin,d.tA.ReferralRewardsMixin,d.tA.PaginationSearchMixin,d.tA.NetworkFeeWarningMixin,d.tA.CopyAddressMixin,m.Z)){constructor(...e){super(...e),(0,s.Z)(this,"WALLET_CONSTS",d.it),(0,s.Z)(this,"referrerLinkOrCode",""),(0,s.Z)(this,"referrerHasApproved",!1),(0,s.Z)(this,"pageAmount",5),(0,s.Z)(this,"invitedUsers",void 0),(0,s.Z)(this,"referrer",void 0),(0,s.Z)(this,"isReferrerApproved",void 0),(0,s.Z)(this,"xor",void 0),(0,s.Z)(this,"account",void 0),(0,s.Z)(this,"reset",void 0),(0,s.Z)(this,"unsubscribeFromInvitedUsers",void 0),(0,s.Z)(this,"resetReferrerSubscription",void 0),(0,s.Z)(this,"setStorageReferrer",void 0),(0,s.Z)(this,"subscribeOnInvitedUsers",void 0),(0,s.Z)(this,"getReferrer",void 0),(0,s.Z)(this,"subscribeOnReferrer",void 0)}async updateSubscriptions(e){e?this.isSoraAccountConnected&&(await this.subscribeOnInvitedUsers(),await this.getAccountReferralRewards(),await this.getReferrer(),await this.subscribeOnReferrer()):(this.unsubscribeFromInvitedUsers(),this.resetReferrerSubscription())}get isPriceAvailable(){return!!this.getAssetFiatPrice(l.XOR)}get xorSymbol(){return l.XOR.symbol}get formattedRewards(){return this.referralRewards?.rewards.toLocaleString()||f.m8}get formattedRewardsFiatValue(){return this.referralRewards?.rewards?this.getFiatAmountByFPNumber(this.referralRewards.rewards):null}get invitedUserRewards(){return this.referralRewards?.invitedUserRewards}get bondedXorCodecBalance(){return this.xor?.balance?.bonded??""}get inviteUserFee(){return this.formatCodecNumber(this.networkFees.ReferralSetInvitedUser)}get isInsufficientBondedAmount(){return!!this.bondedXorCodecBalance&&c.FPNumber.gt(this.getFPNumberFromCodec(this.networkFees.ReferralSetInvitedUser),this.getFPNumberFromCodec(this.bondedXorCodecBalance))}get formattedBondedXorBalance(){return this.bondedXorCodecBalance?this.formatCodecNumber(this.bondedXorCodecBalance):f.m8}get formattedBondedXorFiatValue(){return this.bondedXorCodecBalance?this.getFiatAmountByCodecString(this.bondedXorCodecBalance):null}get invitedUsersCount(){return this.invitedUsers.length}get invitedUsersClasses(){const e="invited-users-list",r=[e];return this.hasMultipleInvitedUsersPages&&r.push(`${e}--multiple-pages`),r}get routerMode(){return"hash"===u.ZP.mode?"#/":""}get linkHrefBase(){return`${(0,p.Np)(u.ZP)}${this.routerMode}referral/`}get referralLink(){return{href:`${this.linkHrefBase}${this.account.address}`,label:this.getLinkLabel(this.account.address)}}get hasAccountWithBondedXor(){return this.account&&+this.bondedXorCodecBalance>0}get bondedContainerClasses(){const e="bonded-container",r=[e];return this.hasAccountWithBondedXor||(r.push("is-active"),r.push(`${e}--visible-content`)),r}get isReferrerLinkEmpty(){return!this.referrerLinkOrCode.trim()}get referrerFormatted(){return this.referrer?(0,h.Tg)(this.referrer,8):""}get referrerAddress(){return this.referrer?this.referrer:n()(this.referrerLinkOrCode.split("/"))??""}get isValidReferrerLink(){return!this.isReferrerLinkEmpty&&(!(!d.hi.validateAddress(this.referrerAddress)||this.referrerAddress===this.account?.address)&&(this.referrerLinkOrCode===this.referrerAddress||this.referrerLinkOrCode===this.referrerLink.href))}get filteredInvitedUsers(){return this.getPageItems(this.invitedUsers)}get hasMultipleInvitedUsersPages(){return this.invitedUsers.length>this.pageAmount}get referrerLink(){return{href:`${this.linkHrefBase}${this.referrerAddress}`,label:this.getLinkLabel(this.referrerAddress)}}get bondButtonType(){return this.hasAccountWithBondedXor?"secondary":"primary"}destroyed(){this.reset()}created(){this.withApi((async()=>{this.isSoraAccountConnected&&(await this.subscribeOnInvitedUsers(),await this.getAccountReferralRewards(),await this.getReferrer(),await this.subscribeOnReferrer())}))}formatReferralAddress(e){return this.formatAddress(e,12)}getLinkLabel(e){return`<span class="referral-link-address">Polkaswap.io/</span>${this.routerMode}referral/${e}`}getInvitedUserReward(e){const r=this.invitedUserRewards[e]?.rewards;return"string"==typeof e&&r?this.formatCodecNumber(r.toCodecString()):f.m8}handleConnect(){this.isSoraAccountConnected||this.connectInternalWallet()}handleBonding(e=!1){u.ZP.push({name:e?f.sn.ReferralBonding:f.sn.ReferralUnbonding})}handleSetReferrer(){this.setStorageReferrer(this.referrerAddress)}};(0,i.__decorate)([v.SB.referrals.invitedUsers],g.prototype,"invitedUsers",void 0),(0,i.__decorate)([v.SB.referrals.referrer],g.prototype,"referrer",void 0),(0,i.__decorate)([v.SB.referrals.isReferrerApproved],g.prototype,"isReferrerApproved",void 0),(0,i.__decorate)([v.Yn.assets.xor],g.prototype,"xor",void 0),(0,i.__decorate)([v.Yn.wallet.account.account],g.prototype,"account",void 0),(0,i.__decorate)([v.QF.referrals.reset],g.prototype,"reset",void 0),(0,i.__decorate)([v.QF.referrals.unsubscribeFromInvitedUsers],g.prototype,"unsubscribeFromInvitedUsers",void 0),(0,i.__decorate)([v.QF.referrals.resetReferrerSubscription],g.prototype,"resetReferrerSubscription",void 0),(0,i.__decorate)([v.QF.referrals.setStorageReferrer],g.prototype,"setStorageReferrer",void 0),(0,i.__decorate)([v.aD.referrals.subscribeOnInvitedUsers],g.prototype,"subscribeOnInvitedUsers",void 0),(0,i.__decorate)([v.aD.referrals.getReferrer],g.prototype,"getReferrer",void 0),(0,i.__decorate)([v.aD.referrals.subscribeOnReferrer],g.prototype,"subscribeOnReferrer",void 0),(0,i.__decorate)([(0,o.RL)("isSoraAccountConnected")],g.prototype,"updateSubscriptions",null),g=(0,i.__decorate)([(0,o.wA)({components:{FormattedAmount:d.wx.FormattedAmount,InfoLine:d.wx.InfoLine,ReferralBonding:(0,u.JE)(f.sn.ReferralBonding),WalletAvatar:d.wx.WalletAvatar,TokenLogo:d.wx.TokenLogo}})],g);var b=g,C=(0,t(1001).Z)(b,(function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"referral-program"},[e.isSoraAccountConnected?[t("div",{staticClass:"rewards-container"},[t("span",{staticClass:"rewards-title"},[e._v(e._s(e.t("referralProgram.receivedRewards")))]),t("token-logo",{attrs:{token:e.xor,size:e.WALLET_CONSTS.LogoSize.BIGGER}}),t("formatted-amount",{staticClass:"rewards-value",attrs:{"value-can-be-hidden":"","font-size-rate":e.FontSizeRate.SMALL,"symbol-as-decimal":"",value:e.formattedRewards,"asset-symbol":e.xorSymbol}}),e.formattedRewardsFiatValue?t("formatted-amount",{attrs:{"is-fiat-value":"","fiat-default-rounding":"","value-can-be-hidden":"","font-size-rate":e.FontSizeRate.MEDIUM,value:e.formattedRewardsFiatValue,"is-formatted":""}}):e._e()],1),e.hasAccountWithBondedXor?[e.isInsufficientBondedAmount?t("div",{staticClass:"referral-insufficient-bonded-amount"},[e._v(" "+e._s(e.t("referralProgram.insufficientBondedAmount",{inviteUserFee:e.inviteUserFee}))+" ")]):t("s-card",{staticClass:"referral-link-container",attrs:{shadow:"always",size:"small","border-radius":"medium"}},[t("div",{staticClass:"referral-link-details with-text"},[t("div",{staticClass:"referral-link-label"},[e._v(e._s(e.t("referralProgram.invitationLink")))]),t("div",{staticClass:"referral-link",domProps:{innerHTML:e._s(e.referralLink.label)}})]),t("s-button",{staticClass:"s-typography-button--mini",attrs:{size:"small",type:"primary",tooltip:e.copyTooltip(e.t("referralProgram.invitationLink"))},on:{click:function(r){return e.handleCopyAddress(e.referralLink.href,r)}}},[e._v(" "+e._s(e.t("referralProgram.action.copyLink"))+" "),t("s-icon",{attrs:{name:"copy-16",size:"16"}})],1)],1)]:e._e(),t("s-collapse",{attrs:{borders:!0}},[t("s-collapse-item",{class:e.bondedContainerClasses,attrs:{disabled:!e.hasAccountWithBondedXor,name:"bondedXOR"},scopedSlots:e._u([e.hasAccountWithBondedXor?{key:"title",fn:function(){return[t("token-logo",{attrs:{token:e.xor}}),t("h3",{staticClass:"bonded-collapse-title"},[e._v(e._s(e.t("referralProgram.bondedXOR")))])]},proxy:!0}:null],null,!0)},[e.hasAccountWithBondedXor?e._e():t("div",{staticClass:"unbonded-info"},[t("token-logo",{attrs:{token:e.xor}}),t("p",{staticClass:"referral-program-hint referral-program-hint--connected",domProps:{innerHTML:e._s(e.t("referralProgram.startInviting"))}})],1),t("info-line",{attrs:{"is-formatted":"","value-can-be-hidden":"",label:e.t("referralProgram.bondedXOR"),value:e.formattedBondedXorBalance,"fiat-value":e.formattedBondedXorFiatValue}}),t("div",{staticClass:"bonded--buttons"},[t("s-button",{staticClass:"s-typography-button--medium",attrs:{type:e.bondButtonType},on:{click:function(r){return e.handleBonding(!0)}}},[e._v(" "+e._s(e.t("referralProgram.action.bondMore"))+" ")]),e.hasAccountWithBondedXor?t("s-button",{staticClass:"s-typography-button--medium",attrs:{type:"secondary"},on:{click:function(r){return e.handleBonding()}}},[e._v(" "+e._s(e.t("referralProgram.action.unbond"))+" ")]):e._e()],1)],1),e.invitedUsersCount?t("s-collapse-item",{staticClass:"invited-users-container",attrs:{name:"invitedUsers"},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{staticClass:"invited-users-icon"}),t("h3",{staticClass:"invited-users-collapse-title"},[e._v(" "+e._s(e.t("referralProgram.referralsNumber",{number:e.invitedUsersCount}))+" ")])]},proxy:!0}],null,!1,1546159244)},[e.invitedUsersCount?[t("div",{class:e.invitedUsersClasses},e._l(e.filteredInvitedUsers,(function(r){return t("info-line",{key:r,attrs:{"value-can-be-hidden":"",value:e.getInvitedUserReward(r),"asset-symbol":e.xorSymbol,"is-formatted":""},scopedSlots:e._u([{key:"info-line-prefix",fn:function(){return[t("s-tooltip",{attrs:{content:e.copyTooltip(e.t("transaction.referral")),tabindex:"-1"}},[t("span",{staticClass:"info-line-address",on:{click:function(t){return e.handleCopyAddress(r,t)}}},[e._v(" "+e._s(e.formatReferralAddress(r))+" ")])])]},proxy:!0}],null,!0)})})),1),e.hasMultipleInvitedUsersPages?t("s-pagination",{attrs:{layout:"total, prev, next","current-page":e.currentPage,"page-size":e.pageAmount,total:e.invitedUsersCount},on:{"update:currentPage":function(r){e.currentPage=r},"update:current-page":function(r){e.currentPage=r},"prev-click":e.handlePrevClick,"next-click":e.handleNextClick}}):e._e()]:e._e()],2):e._e(),t("s-collapse-item",{staticClass:"referrer-link-container",attrs:{name:"referrer"},scopedSlots:e._u([{key:"title",fn:function(){return[e.referrer?t("WalletAvatar",{staticClass:"referrer-icon",attrs:{size:32,address:e.referrer}}):e._e(),t("h3",{staticClass:"referrer-collapse-title"},[e._v(" "+e._s(e.t("referralProgram.referrer."+(e.referrer?"titleReferrer":"title")))+" ")])]},proxy:!0}],null,!1,3479973179)},[e.referrer?[t("h5",[e._v(e._s(e.t("referralProgram.referrer.referredBy",{referrer:e.referrerFormatted})))]),t("p",{staticClass:"referrer-description",domProps:{innerHTML:e._s(e.t("referralProgram.referrer.info"))}})]:[t("div",{staticClass:"referrer-link-details"},[t("s-input",{staticClass:"referrer-link-code",attrs:{placeholder:e.t("referralProgram.referrer."+(e.isReferrerLinkEmpty?"placeholder":"label"))},scopedSlots:e._u([{key:"right",fn:function(){return[e.isReferrerLinkEmpty?e._e():t("s-button",{staticClass:"s-typography-button--mini s-button--approve",attrs:{size:"small",type:"primary",disabled:!e.isValidReferrerLink||e.isReferrerApproved},on:{click:function(r){return r.stopPropagation(),e.handleSetReferrer.apply(null,arguments)}}},[e._v(" "+e._s(e.t("referralProgram.referrer."+(e.isReferrerApproved?"approved":"approve")))+" ")])]},proxy:!0}],null,!1,247624632),model:{value:e.referrerLinkOrCode,callback:function(r){e.referrerLinkOrCode=r},expression:"referrerLinkOrCode"}})],1),t("p",{staticClass:"referrer-description",domProps:{innerHTML:e._s(e.t("referralProgram.referrer.description"))}})],e.referrer?t("s-card",{attrs:{shadow:"always",size:"small","border-radius":"medium"}},[t("div",{staticClass:"referrer-link-details with-text"},[t("div",{staticClass:"referral-link-label"},[e._v(e._s(e.t("referralProgram.referrer.referredLablel")))]),t("div",{staticClass:"referral-link",domProps:{innerHTML:e._s(e.referrerLink.label)}})])]):e._e()],2)],1)]:[t("p",{staticClass:"referral-program-hint",domProps:{innerHTML:e._s(e.t("referralProgram.connectAccount"))}}),e.loading||e.isSoraAccountConnected?e._e():t("s-button",{staticClass:"connect-button s-typography-button--large",attrs:{type:"primary"},on:{click:e.handleConnect}},[e._v(" "+e._s(e.t("referralProgram.action.connectWallet"))+" ")])]],2)}),[],!1,null,"21047ec6",null),_=C.exports}}]);
(self.webpackChunkadar=self.webpackChunkadar||[]).push([[6290],{32836:function(e,t,s){"use strict";s.d(t,{Z:function(){return b}});var o=s(60760),a=s(70655),r=s(53545),i=s(57950),l=s(74614),n=s(36930),u=s(50576);const c=new n.FPNumber(5256e3);let d=class extends((0,r.Wr)(u.tA.FormattedAmountMixin)){getEmission(e,t){const s=!!e?.isFarm,o=new n.FPNumber((s?t?.farmsTotalMultiplier:t?.stakingTotalMultiplier)??0);if(o.isZero())return n.FPNumber.ZERO;const a=new n.FPNumber(e?.multiplier??0).div(o),r=(s?t?.farmsAllocation:t?.stakingAllocation)??n.FPNumber.ZERO,i=t?.tokenPerBlock??n.FPNumber.ZERO;return r.mul(i).mul(a)}getApr(e,t,s){return t.isZero()?n.FPNumber.ZERO:e.mul(c).mul(s).div(t).mul(n.FPNumber.HUNDRED)}getTvl(e,t,s){return e?e.isFarm?s?n.FPNumber.fromCodecValue(s.secondBalance).div(n.FPNumber.fromCodecValue(s.balance)).mul(e.totalTokensInPool).mul(t).mul(new n.FPNumber(2)):n.FPNumber.ZERO:e.totalTokensInPool.mul(t):n.FPNumber.ZERO}};d=(0,a.__decorate)([r.wA],d);var p=d,m=s(85530);const h=(e,t=!0)=>e.reduce(((e,s)=>(s.isFarm!==t||(e[s.baseAsset]||(e[s.baseAsset]={}),e[s.baseAsset][s.poolAsset]||(e[s.baseAsset][s.poolAsset]=[]),e[s.baseAsset][s.poolAsset].push(s)),e)),{});let g=class extends((0,r.Wr)(p)){constructor(...e){super(...e),(0,o.Z)(this,"isFarmingPage",void 0),(0,o.Z)(this,"tokens",void 0),(0,o.Z)(this,"demeterPools",void 0),(0,o.Z)(this,"demeterAccountPools",void 0),(0,o.Z)(this,"getAsset",void 0),(0,o.Z)(this,"showCalculatorDialog",!1),(0,o.Z)(this,"baseAsset",null),(0,o.Z)(this,"poolAsset",null),(0,o.Z)(this,"rewardAsset",null),(0,o.Z)(this,"liquidity",null)}get tokenInfos(){return this.tokens.reduce(((e,t)=>({...e,[t.assetId]:t})),{})}get uniqueAssets(){const e=this.demeterPools.reduce(((e,t)=>(e.push(t.baseAsset,t.poolAsset,t.rewardAsset),e)),[]);return[...new Set(e)]}get demeterAssetsData(){return this.uniqueAssets.reduce(((e,t)=>{const s=this.getAsset(t),o=s?i.FPNumber.fromCodecValue(this.getAssetFiatPrice(s)??0):i.FPNumber.ZERO;return e[t]={...s,price:o},e}),{})}get pools(){return h(this.demeterPools,this.isFarmingPage)}get accountPools(){return h(this.demeterAccountPools,this.isFarmingPage)}get selectedPool(){return this.baseAsset&&this.poolAsset&&this.pools[this.baseAsset][this.poolAsset]?this.pools[this.baseAsset][this.poolAsset].find((e=>e.rewardAsset===this.rewardAsset)):null}get selectedAccountPool(){return this.selectedPool?this.getAccountPool(this.selectedPool):null}getDerivedPools(e){return Array.isArray(e)?e.reduce(((e,t)=>{const s=!t.isRemoved,o=this.getAccountPool(t),a=!!o&&this.isActiveAccountPool(o);return s||a?(e.push({pool:t,accountPool:o}),e):e}),[]):[]}isActiveAccountPool(e){return!(e.pooledTokens.isZero()&&e.rewards.isZero())}prepareDerivedPoolData(e,t,s){const o=this.demeterAssetsData[e.baseAsset],a=this.demeterAssetsData[e.poolAsset],r=this.demeterAssetsData[e.rewardAsset],i=this.tokenInfos[e.rewardAsset],l=this.getEmission(e,i),n=this.getTvl(e,a.price,s),u=this.getApr(l,n,r.price),c=(0,m.Gc)(u,!0);return{pool:e,accountPool:t,tokenInfo:i,baseAsset:o,poolAsset:a,rewardAsset:r,emission:l,tvl:`$${(0,m.Gc)(n)}`,apr:c}}getAccountPool(e){return this.accountPools[e.baseAsset]?.[e.poolAsset]?.find((t=>t.rewardAsset===e.rewardAsset))}showPoolCalculator(e){this.setDialogParams(e),this.showCalculatorDialog=!0}setDialogParams(e){this.baseAsset=e.baseAsset,this.poolAsset=e.poolAsset,this.rewardAsset=e.rewardAsset,this.liquidity=e.liquidity}};(0,a.__decorate)([(0,r.fI)({default:!0,type:Boolean})],g.prototype,"isFarmingPage",void 0),(0,a.__decorate)([l.SB.demeterFarming.tokens],g.prototype,"tokens",void 0),(0,a.__decorate)([l.SB.demeterFarming.pools],g.prototype,"demeterPools",void 0),(0,a.__decorate)([l.SB.demeterFarming.accountPools],g.prototype,"demeterAccountPools",void 0),(0,a.__decorate)([l.Yn.assets.assetDataByAddress],g.prototype,"getAsset",void 0),g=(0,a.__decorate)([r.wA],g);var b=g},44973:function(e,t,s){"use strict";s.d(t,{w:function(){return o}});const o=e=>()=>s(12488)(`./${e}.vue`)},26290:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return P}});var o=s(60760),a=s(70655),r=s(53545),i=s(36930),l=s(50576),n=s(63637),u=s(73331),c=s(32806),d=s(32836),p=s(44973),m=s(52859),h=s(80710),g=s(16546),b=s(85530);const A=(e,t)=>[e,t].join(";");let v=class extends((0,r.Wr)(c.Z,d.Z,u.Z)){constructor(...e){super(...e),(0,o.Z)(this,"order",n.Sr.DESC),(0,o.Z)(this,"property","apr"),(0,o.Z)(this,"poolsData",{})}async updatePoolsData(){await this.updateExploreData()}get list(){return Object.values(this.pools).map((e=>Object.values(e))).flat(2).filter((e=>!e.isRemoved))}get selectedDerivedPool(){return this.selectedPool?this.prepareDerivedPoolData(this.selectedPool,this.selectedAccountPool,this.liquidity):null}get items(){return this.list.map((e=>{const t=this.demeterAssetsData[e.baseAsset],s=this.demeterAssetsData[e.poolAsset],o=this.demeterAssetsData[e.rewardAsset],a=o?.symbol??"",r=i.FPNumber.fromCodecValue(this.getAssetFiatPrice({address:e.rewardAsset})??0),l=this.tokenInfos[e.rewardAsset],n=this.getAccountPool(e),u=!!n&&this.isActiveAccountPool(n),c=this.poolsData[A(e.baseAsset,e.poolAsset)],d=c?.price??i.FPNumber.ZERO,p=c?.reserves?.[0]??i.FPNumber.ZERO,m=c?.reserves?.[1]??i.FPNumber.ZERO,h=c?.supply??i.FPNumber.ZERO,g=n?.pooledTokens??i.FPNumber.ZERO,v=e.isFarm?{address:c?.address??"",balance:h.toCodecString(),firstAddress:t.address??"",firstBalance:p.toCodecString(),secondAddress:s?.address??"",secondBalance:m.toCodecString(),poolShare:"1",reserveA:"1",reserveB:"1",totalSupply:"1"}:null,f=e.isFarm?[t,s]:[s],P=f.map((e=>e?.symbol??"")).join("-"),y=e.isFarm?"":s?.name??"",_=new i.FPNumber(e.depositFee??0).mul(i.FPNumber.HUNDRED),w=d.mul(e.totalTokensInPool),F=this.getEmission(e,l),k=this.getApr(F,w,r),x=(e.isFarm?[{asset:t,balance:h.isZero()?i.FPNumber.ZERO:p.mul(g).div(h)},{asset:s,balance:h.isZero()?i.FPNumber.ZERO:m.mul(g).div(h)}]:[{asset:s,balance:g}]).map((e=>({...e,balance:(0,b.Gc)(e.balance),balancePrefix:e.balance.isZero()?"":"~"})));return{assets:f,name:P,description:y,baseAsset:t,poolAsset:s,rewardAsset:o,rewardAssetSymbol:a,depositFee:_.toNumber(),depositFeeFormatted:(0,b.Gc)(_,!0),tvl:w.toNumber(),tvlFormatted:(0,b.kF)(w),apr:k.toNumber(),aprFormatted:(0,b.Gc)(k,!0),isAccountItem:u,accountTokens:x,liquidity:v}}))}get preparedItems(){return this.isAccountItems?this.items.filter((e=>e.isAccountItem)):this.items}async updateExploreData(){this.loading||await this.withLoading((async()=>{await this.withParentLoading((async()=>{const e={},t=this.isFarmingPage,s=this.list.map((e=>A(e.baseAsset,e.poolAsset))),o=[...new Set(s)];await Promise.allSettled(o.map((async s=>{if(!e[s]){const o=await this.getPoolData(s,t);o&&(e[s]=o)}}))),this.poolsData=Object.freeze(e)}))}))}async getPoolData(e,t){const[s,o]=e.split(";"),a=i.FPNumber.fromCodecValue(this.getAssetFiatPrice({address:o})??0);if(t){const e=l.hi.poolXyk.getInfo(s,o);if(!e)return null;const t=e.address,r=await l.hi.api.query.poolXYK.totalIssuances(e.address),n=r.isEmpty?i.FPNumber.ZERO:new i.FPNumber(r),u=(await l.hi.poolXyk.getReserves(s,o)).map((e=>i.FPNumber.fromCodecValue(e))),c=u[1];return{price:n.isZero()?i.FPNumber.ZERO:c.mul(a).mul(new i.FPNumber(2)).div(n),supply:n,reserves:u,address:t}}return{price:a}}};(0,a.__decorate)([(0,r.RL)("pools",{deep:!0})],v.prototype,"updatePoolsData",null),v=(0,a.__decorate)([(0,r.wA)({components:{CalculatorButton:(0,p.w)(m.J.CalculatorButton),CalculatorDialog:(0,p.w)(m.J.CalculatorDialog),PairTokenLogo:(0,h.kF)(g.z8.PairTokenLogo),SortButton:(0,h.kF)(g.z8.SortButton),TokenLogo:l.wx.TokenLogo,FormattedAmount:l.wx.FormattedAmount,HistoryPagination:l.wx.HistoryPagination}})],v);var f=v,P=(0,s(1001).Z)(f,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("s-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingState,expression:"loadingState"}],ref:"table",staticClass:"explore-table",attrs:{data:e.tableItems,"highlight-current-row":!1,size:"small"}},[s("s-table-column",{attrs:{width:"240",label:"#","fixed-position":"left"},scopedSlots:e._u([{key:"header",fn:function(){return[s("div",{staticClass:"explore-table-item-index"},[s("span",{class:["explore-table-item-index--head",{active:e.isDefaultSort}],on:{click:e.handleResetSort}},[e._v(" # ")])]),s("div",{staticClass:"explore-table-item-logo"},[s("s-icon",{staticClass:"explore-table-item-logo--head",attrs:{name:"various-bone-24",size:"14px"}})],1),s("div",{staticClass:"explore-table-item-info explore-table-item-info--head"},[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("nameText")))])])]},proxy:!0},{key:"default",fn:function(t){var o=t.$index,a=t.row;return[s("span",{staticClass:"explore-table-item-index explore-table-item-index--body"},[e._v(e._s(o+e.startIndex+1))]),1===a.assets.length?s("token-logo",{key:"token",staticClass:"explore-table-item-logo",attrs:{token:a.assets[0]}}):s("pair-token-logo",{key:"pair",staticClass:"explore-table-item-logo",attrs:{"first-token":a.assets[0],"second-token":a.assets[1],size:"small"}}),s("div",{staticClass:"explore-table-item-info explore-table-item-info--body"},[s("div",{staticClass:"explore-table-item-name"},[e._v(e._s(a.name))]),a.description?s("div",{key:"description",staticClass:"explore-table__secondary"},[e._v(e._s(a.description))]):e._e()])]}}])}),s("s-table-column",{attrs:{width:"120","header-align":"left",align:"left"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"rewardAssetSymbol",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v("Reward")])])]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("div",{staticClass:"explore-table-cell"},[s("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small","token-symbol":o.rewardAsset.symbol}}),s("div",{staticClass:"explore-table-item-name"},[e._v(e._s(o.rewardAsset.symbol))])],1)]}}])}),s("s-table-column",{attrs:{width:"140","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"apr",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.APR))])])]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("span",{staticClass:"explore-table__accent"},[e._v(e._s(o.aprFormatted))]),s("calculator-button",{nativeOn:{click:function(t){return e.showPoolCalculator({baseAsset:o.baseAsset.address,poolAsset:o.poolAsset.address,rewardAsset:o.rewardAsset.address,liquidity:o.liquidity})}}})]}}])}),s("s-table-column",{attrs:{width:"80","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"depositFee",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v("Fee")])])]},proxy:!0},{key:"default",fn:function(t){var s=t.row;return[e._v(" "+e._s(s.depositFeeFormatted)+" ")]}}])}),e.isLoggedIn?s("s-table-column",{key:"logged",attrs:{width:"140","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.t("balanceText")))])]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("div",{staticClass:"explore-table-item-tokens"},e._l(o.accountTokens,(function(t,o){var a=t.asset,r=t.balance,i=t.balancePrefix;return s("div",{key:o,staticClass:"explore-table-cell"},[s("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"value-can-be-hidden":"","font-size-rate":e.FontSizeRate.SMALL,value:r},scopedSlots:e._u([{key:"prefix",fn:function(){return[e._v(e._s(i))]},proxy:!0}],null,!0)}),s("token-logo",{staticClass:"explore-table-item-logo explore-table-item-logo--plain",attrs:{size:"small",token:a}})],1)})),0)]}}],null,!1,596145239)}):e._e(),s("s-table-column",{attrs:{width:"104","header-align":"right",align:"right"},scopedSlots:e._u([{key:"header",fn:function(){return[s("sort-button",{attrs:{name:"tvl",sort:{order:e.order,property:e.property}},on:{"change-sort":e.changeSort}},[s("span",{staticClass:"explore-table__primary"},[e._v(e._s(e.TranslationConsts.TVL))]),s("s-tooltip",{attrs:{"border-radius":"mini",content:e.t("tooltips.tvl")}},[s("s-icon",{attrs:{name:"info-16",size:"14px"}})],1)],1)]},proxy:!0},{key:"default",fn:function(t){var o=t.row;return[s("formatted-amount",{staticClass:"explore-table-item-price explore-table-item-amount",attrs:{"is-fiat-value":"","font-weight-rate":e.FontWeightRate.MEDIUM,value:o.tvlFormatted.amount}},[e._v(" "+e._s(o.tvlFormatted.suffix)+" ")])]}}])})],1),s("history-pagination",{staticClass:"explore-table-pagination",attrs:{"current-page":e.currentPage,"page-amount":e.pageAmount,total:e.total,"last-page":e.lastPage,loading:e.loadingState},on:{"pagination-click":e.handlePaginationClick}}),s("calculator-dialog",e._b({attrs:{visible:e.showCalculatorDialog,liquidity:e.liquidity},on:{"update:visible":function(t){e.showCalculatorDialog=t}}},"calculator-dialog",e.selectedDerivedPool,!1))],1)}),[],!1,null,null,null).exports},12488:function(e,t,s){var o={"./CalculatorButton.vue":[87811,2485],"./CalculatorDialog.vue":[66134,3064,6134],"./ClaimDialog.vue":[69592,3064,9592],"./DialogTitle.vue":[13851,3851],"./PoolCard.vue":[55795,3064,5795],"./StakeDialog.vue":[66069,3064,6069],"./StatusBadge.vue":[89683,3064,9683]};function a(e){if(!s.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],a=t[0];return Promise.all(t.slice(1).map(s.e)).then((function(){return s(a)}))}a.keys=function(){return Object.keys(o)},a.id=12488,e.exports=a},89706:function(e,t,s){var o={"./DataContainer.vue":[20980,3064,980],"./Pool.vue":[43759,3064,3759],"./Staking.vue":[15271,3064,5271]};function a(e){if(!s.o(o,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=o[e],a=t[0];return Promise.all(t.slice(1).map(s.e)).then((function(){return s(a)}))}a.keys=function(){return Object.keys(o)},a.id=89706,e.exports=a}}]);
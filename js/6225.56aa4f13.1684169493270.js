"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[6225],{86225:function(e,t,i){i.r(t),i.d(t,{default:function(){return F}});var o=i(60760),r=i(70655),s=i(53545),n=i(50576),a=i(36930),d=i(82753),u=i(68850),c=i(2591),l=i(67814),m=i(80710),v=i(16546),h=i(85530),p=i(74614),y=i(42140);let k=class extends((0,s.Wr)(n.tA.NetworkFeeWarningMixin,n.tA.FormattedAmountMixin,n.tA.TransactionMixin,u.Z,c.Z,l.Z)){constructor(...e){super(...e),(0,o.Z)(this,"XOR_SYMBOL",d.XOR.symbol),(0,o.Z)(this,"MAX_PART",100),(0,o.Z)(this,"FocusedField",y.G),(0,o.Z)(this,"liquidityAmount",void 0),(0,o.Z)(this,"focusedField",void 0),(0,o.Z)(this,"firstTokenAmount",void 0),(0,o.Z)(this,"secondTokenAmount",void 0),(0,o.Z)(this,"removePart",void 0),(0,o.Z)(this,"xor",void 0),(0,o.Z)(this,"liquidityBalanceFull",void 0),(0,o.Z)(this,"liquidityBalance",void 0),(0,o.Z)(this,"demeterLockedBalance",void 0),(0,o.Z)(this,"ceresLockedBalance",void 0),(0,o.Z)(this,"liquidity",void 0),(0,o.Z)(this,"firstToken",void 0),(0,o.Z)(this,"secondToken",void 0),(0,o.Z)(this,"firstTokenBalance",void 0),(0,o.Z)(this,"secondTokenBalance",void 0),(0,o.Z)(this,"shareOfPool",void 0),(0,o.Z)(this,"price",void 0),(0,o.Z)(this,"priceReversed",void 0),(0,o.Z)(this,"setAddresses",void 0),(0,o.Z)(this,"setFocusedField",void 0),(0,o.Z)(this,"resetFocusedField",void 0),(0,o.Z)(this,"setRemovePart",void 0),(0,o.Z)(this,"removeLiquidity",void 0),(0,o.Z)(this,"resetData",void 0),(0,o.Z)(this,"setFirstTokenAmount",void 0),(0,o.Z)(this,"setSecondTokenAmount",void 0),(0,o.Z)(this,"sliderInput",void 0),(0,o.Z)(this,"sliderDragButton",void 0)}liquidityChange(){switch(this.focusedField){case y.G.First:case y.G.Second:{const e=this.focusedField===y.G.First,t=Number(this.getTokenMaxAmount(e?this.firstTokenBalance:this.secondTokenBalance)),i=Number(e?this.firstTokenAmount:this.secondTokenAmount);(e?this.setFirstTokenAmount:this.setSecondTokenAmount)(String(Number.isFinite(t)?Math.min(t,i):i));break}default:this.setRemovePart(this.removePart)}}async mounted(){await this.withParentLoading((async()=>{this.setData({firstAddress:this.firstRouteAddress,secondAddress:this.secondRouteAddress}),this.addListenerToSliderDragButton()}))}beforeDestroy(){this.removeListenerFromSliderDragButton(),this.resetData()}get sliderValue(){return this.removePart?Number(this.removePart):void 0}get isEmptyAmount(){return!Number(this.liquidityAmount)||!this.firstTokenAmount||!this.secondTokenAmount}get liquidityLocked(){return this.liquidityBalance.isZero()}get locks(){return[{balance:this.demeterLockedBalance,lock:"Demeter Farming"},{balance:this.ceresLockedBalance,lock:"Ceres Liquidity Locker"}].reduce(((e,{balance:t,lock:i})=>(t.isZero()||e.push({lock:i,percent:this.getLockedPercent(t)}),e)),[])}get isInsufficientBalance(){const{liquidityBalance:e,firstTokenBalance:t,secondTokenBalance:i}=this,o=this.getFPNumber(this.liquidityAmount),r=this.getFPNumber(this.firstTokenAmount),s=this.getFPNumber(this.secondTokenAmount);return a.FPNumber.gt(o,e)||a.FPNumber.gt(r,t)||a.FPNumber.gt(s,i)}get isInsufficientXorForFee(){return!!this.xor&&(0,h.LG)(this.xor,this.networkFee)}get removePartCharClass(){return`${{3:"three",2:"two"}[this.removePart.length]??"one"}-char`}get networkFee(){return this.networkFees[a.Operation.RemoveLiquidity]}get formattedFee(){return this.formatCodecNumber(this.networkFee)}get isXorSufficientForNextOperation(){const e={type:a.Operation.RemoveLiquidity};return this.firstToken?.address===d.XOR.address&&(e.amount=this.getFPNumber(this.firstTokenAmount),e.isXor=!0),this.isXorSufficientForNextTx(e)}get isMaxButtonAvailable(){return!this.liquidityLocked&&Number(this.removePart)!==this.MAX_PART}async setData(e){if(this.setAddresses({firstAddress:e.firstAddress,secondAddress:e.secondAddress}),!this.liquidity)return this.handleBack()}handleRemovePartChange(e){Number(e)!==Number(this.removePart)&&this.setRemovePart(String(e))}focusSliderInput(){this.setFocusedField(y.G.Percent),this.sliderInput&&this.sliderInput.focus()}getTokenMaxAmount(e){return e.toString()}getLockedPercent(e){const t=e.div(this.liquidityBalanceFull).mul(a.FPNumber.HUNDRED);return(0,h.Gc)(t,!0)}async handleTokenChange(e,t){await t(e)}async handleConfirmRemoveLiquidity(){await this.handleConfirmDialog((async()=>{await this.withNotifications(this.removeLiquidity),this.handleBack()}))}handleBack(){m.ZP.currentRoute.name===v.sn.RemoveLiquidity&&m.ZP.push({name:v.sn.Pool})}async handleRemoveLiquidity(){if(this.allowFeePopup&&!this.isXorSufficientForNextOperation){if(this.openWarningFeeDialog(),await this.waitOnNextTxFailureConfirmation(),!this.isWarningFeeDialogConfirmed)return;this.isWarningFeeDialogConfirmed=!1}this.openConfirmDialog()}addListenerToSliderDragButton(){this.sliderDragButton=this.$el.querySelector(".slider-container .el-slider__button"),this.sliderInput=this.$el.querySelector(".s-input--remove-part .el-input__inner"),this.sliderDragButton&&this.sliderDragButton.addEventListener("mousedown",this.focusSliderInput)}removeListenerFromSliderDragButton(){this.sliderDragButton&&this.$el.removeEventListener("mousedown",this.sliderDragButton)}};(0,r.__decorate)([p.SB.removeLiquidity.liquidityAmount],k.prototype,"liquidityAmount",void 0),(0,r.__decorate)([p.SB.removeLiquidity.focusedField],k.prototype,"focusedField",void 0),(0,r.__decorate)([p.SB.removeLiquidity.firstTokenAmount],k.prototype,"firstTokenAmount",void 0),(0,r.__decorate)([p.SB.removeLiquidity.secondTokenAmount],k.prototype,"secondTokenAmount",void 0),(0,r.__decorate)([p.SB.removeLiquidity.removePart],k.prototype,"removePart",void 0),(0,r.__decorate)([p.Yn.assets.xor],k.prototype,"xor",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.liquidityBalanceFull],k.prototype,"liquidityBalanceFull",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.liquidityBalance],k.prototype,"liquidityBalance",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.demeterLockedBalance],k.prototype,"demeterLockedBalance",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.ceresLockedBalance],k.prototype,"ceresLockedBalance",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.liquidity],k.prototype,"liquidity",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.firstToken],k.prototype,"firstToken",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.secondToken],k.prototype,"secondToken",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.firstTokenBalance],k.prototype,"firstTokenBalance",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.secondTokenBalance],k.prototype,"secondTokenBalance",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.shareOfPool],k.prototype,"shareOfPool",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.price],k.prototype,"price",void 0),(0,r.__decorate)([p.Yn.removeLiquidity.priceReversed],k.prototype,"priceReversed",void 0),(0,r.__decorate)([p.QF.removeLiquidity.setAddresses],k.prototype,"setAddresses",void 0),(0,r.__decorate)([p.QF.removeLiquidity.setFocusedField],k.prototype,"setFocusedField",void 0),(0,r.__decorate)([p.QF.removeLiquidity.resetFocusedField],k.prototype,"resetFocusedField",void 0),(0,r.__decorate)([p.aD.removeLiquidity.setRemovePart],k.prototype,"setRemovePart",void 0),(0,r.__decorate)([p.aD.removeLiquidity.removeLiquidity],k.prototype,"removeLiquidity",void 0),(0,r.__decorate)([p.aD.removeLiquidity.resetData],k.prototype,"resetData",void 0),(0,r.__decorate)([p.aD.removeLiquidity.setFirstTokenAmount],k.prototype,"setFirstTokenAmount",void 0),(0,r.__decorate)([p.aD.removeLiquidity.setSecondTokenAmount],k.prototype,"setSecondTokenAmount",void 0),(0,r.__decorate)([(0,s.RL)("liquidity",{deep:!0})],k.prototype,"liquidityChange",null),k=(0,r.__decorate)([(0,s.wA)({components:{RemoveLiquidityConfirm:(0,m.kF)(v.z8.RemoveLiquidityConfirm),RemoveLiquidityTransactionDetails:(0,m.kF)(v.z8.RemoveLiquidityTransactionDetails),GenericPageHeader:(0,m.kF)(v.z8.GenericPageHeader),SlippageTolerance:(0,m.kF)(v.z8.SlippageTolerance),NetworkFeeWarningDialog:(0,m.kF)(v.z8.NetworkFeeWarningDialog),TokenInput:(0,m.kF)(v.z8.TokenInput),InfoLine:n.wx.InfoLine}})],k);var f=k,F=(0,i(1001).Z)(f,(function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.parentLoading,expression:"parentLoading"}],staticClass:"container container--remove-liquidity"},[i("generic-page-header",{attrs:{"has-button-back":"",title:e.t("removeLiquidity.title"),tooltip:e.t("removeLiquidity.description")},on:{back:e.handleBack}}),i("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[i("s-float-input",{ref:"removePart",class:["s-input--token-value","s-input--remove-part",e.removePartCharClass],attrs:{size:"medium",value:e.removePart,decimals:0,disabled:e.liquidityLocked,max:e.MAX_PART},on:{input:e.handleRemovePartChange,focus:function(t){return e.setFocusedField(e.FocusedField.Percent)},blur:e.resetFocusedField}},[i("div",{staticClass:"amount",attrs:{slot:"top"},slot:"top"},[e._v(e._s(e.t("removeLiquidity.amount")))]),i("div",{staticClass:"el-buttons el-buttons--between",attrs:{slot:"right"},slot:"right"},[i("span",{staticClass:"percent"},[e._v("%")]),e.isMaxButtonAvailable?i("s-button",{staticClass:"el-button--max s-typography-button--small",attrs:{type:"primary",alternative:"",size:"mini","border-radius":"mini"},on:{click:function(t){return t.stopPropagation(),e.handleRemovePartChange(e.MAX_PART)}}},[e._v(" "+e._s(e.t("buttons.max"))+" ")]):e._e()],1),i("div",{attrs:{slot:"bottom"},slot:"bottom"},[i("s-slider",{staticClass:"slider-container",attrs:{value:e.sliderValue,disabled:e.liquidityLocked,"show-tooltip":!1},on:{input:e.handleRemovePartChange}}),e._l(e.locks,(function(t){var o=t.percent,r=t.lock;return i("div",{key:r,staticClass:"input-line input-line--footer locked-part"},[i("span",{staticClass:"locked-part-percent"},[e._v(e._s(o))]),e._v(" "+e._s(e.t("removeLiquidity.locked",{lock:r}))+" ")])}))],2)]),i("s-icon",{staticClass:"icon-divider",attrs:{name:"arrows-arrow-bottom-24"}}),i("token-input",{attrs:{disabled:e.liquidityLocked,max:e.getTokenMaxAmount(e.firstTokenBalance),title:e.t("removeLiquidity.output"),token:e.firstToken,value:e.firstTokenAmount},on:{input:e.setFirstTokenAmount,focus:function(t){return e.setFocusedField(e.FocusedField.First)},blur:e.resetFocusedField},scopedSlots:e._u([{key:"balance",fn:function(){return[e._v("-")]},proxy:!0}])}),i("s-icon",{staticClass:"icon-divider",attrs:{name:"plus-16"}}),i("token-input",{attrs:{disabled:e.liquidityLocked,max:e.getTokenMaxAmount(e.secondTokenBalance),title:e.t("removeLiquidity.output"),token:e.secondToken,value:e.secondTokenAmount},on:{input:e.setSecondTokenAmount,focus:function(t){return e.setFocusedField(e.FocusedField.Second)},blur:e.resetFocusedField},scopedSlots:e._u([{key:"balance",fn:function(){return[e._v("-")]},proxy:!0}])}),i("slippage-tolerance",{staticClass:"slippage-tolerance-settings"}),i("s-button",{staticClass:"action-button s-typography-button--large",attrs:{type:"primary","border-radius":"small",disabled:e.liquidityLocked||e.isEmptyAmount||e.isInsufficientBalance||e.isInsufficientXorForFee},on:{click:e.handleRemoveLiquidity}},[e.isEmptyAmount?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:e.isInsufficientBalance?[e._v(" "+e._s(e.t("exchange.insufficientBalance",{tokenSymbol:e.t("removeLiquidity.liquidity")}))+" ")]:e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("exchange.insufficientBalance",{tokenSymbol:e.XOR_SYMBOL}))+" ")]:[e._v(" "+e._s(e.t("removeLiquidity.remove"))+" ")]],2),e.price||e.priceReversed||e.networkFee||e.shareOfPool?i("remove-liquidity-transaction-details",{staticClass:"info-line-container",attrs:{"info-only":!1}}):e._e()],1),i("remove-liquidity-confirm",{attrs:{visible:e.showConfirmDialog,"parent-loading":e.parentLoading||e.loading},on:{"update:visible":function(t){e.showConfirmDialog=t},confirm:e.handleConfirmRemoveLiquidity}}),i("network-fee-warning-dialog",{attrs:{visible:e.showWarningFeeDialog,fee:e.formattedFee},on:{"update:visible":function(t){e.showWarningFeeDialog=t},confirm:e.confirmNetworkFeeWariningDialog}})],1)}),[],!1,null,"2d7e5cec",null).exports}}]);
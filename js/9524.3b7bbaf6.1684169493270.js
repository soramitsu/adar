"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[9524,2240],{23889:function(t,e,s){s.r(e),s.d(e,{default:function(){return k}});var i=s(60760),a=s(70655),o=s(53545),n=s(50592),r=s(67748),l=s(74614),u=s(50576),d=s(96486),c=s(36930),m=s(85530),p=s(48590),v=s(82753),_=s(16546);let g=class extends((0,o.Wr)(u.tA.TransactionMixin)){constructor(...t){super(...t),(0,i.Z)(this,"inputToken",void 0),(0,i.Z)(this,"nextStage",void 0),(0,i.Z)(this,"recipients",void 0),(0,i.Z)(this,"fiatPriceObject",void 0),(0,i.Z)(this,"accountAssets",void 0),(0,i.Z)(this,"setInputToken",void 0),(0,i.Z)(this,"cancelProcessing",void 0),(0,i.Z)(this,"runAssetsRouting",void 0),(0,i.Z)(this,"networkFees",void 0),(0,i.Z)(this,"xor",void 0),(0,i.Z)(this,"showSwapDialog",!1),(0,i.Z)(this,"showSelectInputAssetDialog",!1),(0,i.Z)(this,"action","fee")}onInputAssetSelected(t){this.setInputToken(t),this.showSelectInputAssetDialog=!1}get noIssues(){return this.remainingAmountRequired.toNumber()<=0}get usdToBeRouted(){return this.formatNumber(new c.FPNumber(this.recipients?.reduce(((t,e)=>t+Number(e.usd)),0)))}get estimatedAmount(){const t=(0,d.sumBy)(this.summaryData,(t=>t.required));return this.inputToken?.symbol===v.XOR.symbol?new c.FPNumber(t).add(this.xorFeeAmount):new c.FPNumber(t)}get adarFeeMultiplier(){return new c.FPNumber(n._g)}get adarFeePercent(){return this.adarFeeMultiplier.mul(c.FPNumber.HUNDRED).toString()}get networkFeeMultiplier(){return new c.FPNumber(n.W2)}get adarFee(){return this.estimatedAmount.add(this.estimatedNetworkFee).mul(this.adarFeeMultiplier)}get estimatedNetworkFee(){return this.estimatedAmount.mul(this.networkFeeMultiplier)}get estimatedAmountWithFees(){return this.estimatedAmount.add(this.adarFee).add(this.estimatedNetworkFee)}get totalTokensAvailable(){return this.formattedBalance}get xorNetworkFee(){return c.FPNumber.fromCodecValue(this.networkFees[c.Operation.SwapAndSend]).toNumber()}get remainingAmountRequired(){return this.inputToken?.symbol===v.XOR.symbol?this.estimatedAmountWithFees.add(this.xorFeeAmount).sub(this.fpBalance):this.estimatedAmountWithFees.sub(this.fpBalance)}get xorFeeAmount(){return this.summaryData.reduce(((t,e)=>{const s=e.asset.address===this.inputToken.address?this.networkFees[c.Operation.Transfer]:this.networkFees[c.Operation.SwapAndSend];return t.add(c.FPNumber.fromCodecValue(s))}),c.FPNumber.ZERO)}get xorFeeRequired(){return this.xorFeeAmount.mul(new c.FPNumber(1.05)).sub(this.xorBalance)}get showXorRequiredField(){return this.xorFeeAmount>this.xorBalance&&this.inputToken.address!==v.XOR.address}get xorBalance(){const t=this.xor?.balance;return this.getFPNumberFromCodec(t?.transferable??_.m8,this.xor?.decimals)}get summaryData(){return Object.values((0,d.groupBy)(this.recipients.map((t=>({symbol:t.asset.symbol,...t}))),"symbol")).map((t=>({recipientsNumber:t.length,asset:t[0].asset,usd:(0,d.sumBy)(t,(t=>Number(t.usd))),total:(0,d.sumBy)(t,(t=>Number(t.amount))),required:(0,d.sumBy)(t,(t=>Number(t.usd)))/Number(this.getAssetUSDPrice(this.inputToken)),totalTransactions:t.length})))}get routingSwapData(){return{assetFrom:this.inputToken?.symbol===v.XOR.symbol?v.VAL:v.XOR,assetTo:this.inputToken,valueTo:this.remainingAmountRequired.toNumber()}}get xorFeeSwapData(){return{assetFrom:v.VAL,assetTo:v.XOR,valueTo:this.xorFeeRequired.toNumber()}}get swapData(){return"fee"===this.action?this.xorFeeSwapData:this.routingSwapData}onAddFundsClick(t){this.action=t,this.showSwapDialog=!0}get fpBalance(){return this.getTokenBalance?c.FPNumber.fromCodecValue(this.getTokenBalance,this.decimals):c.FPNumber.ZERO}get decimals(){return this.inputToken?.decimals??c.FPNumber.DEFAULT_PRECISION}get formattedBalance(){return this.fpBalance.toNumber().toLocaleString("en-US",{maximumFractionDigits:6})}getAssetUSDPrice(t){return c.FPNumber.fromCodecValue(this.fiatPriceObject[t.address]??0,t.decimals)}get getTokenBalance(){const t=this.accountAssets.find((t=>t.address===this.inputToken.address));return(0,m.rh)(t)}formatNumberJs(t){return t&&Number.isFinite(t)?t.toLocaleString("en-US",{maximumFractionDigits:4}):"-"}formatNumber(t){return t&&t.isFinity()?t.toNumber().toLocaleString("en-US",{maximumFractionDigits:4}):"-"}cancelButtonAction(){this.cancelProcessing()}onContinueClick(){this.runAssetsRouting(),this.nextStage()}};(0,a.__decorate)([l.Yn.routeAssets.inputToken],g.prototype,"inputToken",void 0),(0,a.__decorate)([l.aD.routeAssets.processingNextStage],g.prototype,"nextStage",void 0),(0,a.__decorate)([l.Yn.routeAssets.recipients],g.prototype,"recipients",void 0),(0,a.__decorate)([l.SB.wallet.account.fiatPriceObject],g.prototype,"fiatPriceObject",void 0),(0,a.__decorate)([l.SB.wallet.account.accountAssets],g.prototype,"accountAssets",void 0),(0,a.__decorate)([l.aD.routeAssets.setInputToken],g.prototype,"setInputToken",void 0),(0,a.__decorate)([l.aD.routeAssets.cancelProcessing],g.prototype,"cancelProcessing",void 0),(0,a.__decorate)([l.aD.routeAssets.runAssetsRouting],g.prototype,"runAssetsRouting",void 0),(0,a.__decorate)([l.SB.wallet.settings.networkFees],g.prototype,"networkFees",void 0),(0,a.__decorate)([l.Yn.assets.xor],g.prototype,"xor",void 0),g=(0,a.__decorate)([(0,o.wA)({components:{TokenLogo:u.wx.TokenLogo,SwapDialog:(0,r.y)(n.EC.RouteAssetsSwapDialog),WarningMessage:p.default,SelectInputAssetDialog:(0,r.y)(n.EC.RouteAssetsSelectInputAssetDialog)}})],g);var h=g,b=(0,s(1001).Z)(h,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"route-assets-review-details"},[s("div",{staticClass:"container route-assets-upload-template"},[s("div",{staticClass:"route-assets__page-header-title"},[t._v("Review Routing Details")]),s("div",{staticClass:"route-assets__page-header-description"},[t._v(" "+t._s("Review the details of your routing transaction")+" ")]),s("div",{staticClass:"fields-container"},[s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("INPUT ASSET")]),s("div",{staticClass:"field__value pointer",on:{click:function(){t.showSelectInputAssetDialog=!0}}},[s("div",[t._v(t._s(t.inputToken.symbol))]),s("div",[s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1),s("div",[s("s-icon",{attrs:{name:"arrows-chevron-down-rounded-24",size:"20"}})],1)])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("total usd to be routed")]),s("div",{staticClass:"field__value usd"},[t._v(t._s(t.usdToBeRouted))])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("ESTImated ADAR fee ("+t._s(t.adarFeePercent)+"%)")]),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.formatNumber(t.adarFee))+" "),s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1)]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("ESTImated Network fee (5%)")]),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.formatNumber(t.estimatedNetworkFee))+" "),s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1)]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("Total tokens required")]),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.formatNumber(t.estimatedAmountWithFees))+" "),s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1)]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("Total Tokens available")]),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.totalTokensAvailable)+" "),s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1),s("warning-message",{staticClass:"warning-message",attrs:{text:t.noIssues?"balance is ok":"insufficient funds",isError:!t.noIssues}})],1),t.noIssues?t._e():[s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("remaining AMOUNT required")]),s("div",{staticClass:"field__value"},[s("s-button",{staticClass:"s-typography-button--mini add-button",attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.onAddFundsClick("routing")}}},[t._v(" "+t._s("Add")+" ")]),t._v(" "+t._s(t.formatNumber(t.remainingAmountRequired))+" "),s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1)])],t.showXorRequiredField?[s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("XOR fee required")]),s("div",{staticClass:"field__value"},[s("s-button",{staticClass:"s-typography-button--mini add-button",attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.onAddFundsClick("fee")}}},[t._v(" "+t._s("Add")+" ")]),t._v(" "+t._s(t.formatNumber(t.xorFeeRequired))+" "),s("token-logo",{staticClass:"token-logo",attrs:{token:t.xor}})],1)])]:t._e(),t.noIssues?t._e():s("s-divider"),s("div",{staticClass:"buttons-container"},[s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"primary",disabled:!t.noIssues},on:{click:function(e){return e.stopPropagation(),t.onContinueClick.apply(null,arguments)}}},[t._v(" "+t._s("Continue")+" ")]),s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"secondary"},on:{click:function(e){return e.stopPropagation(),t.cancelButtonAction.apply(null,arguments)}}},[t._v(" "+t._s("CANCEL PROCESSING")+" ")])],1)],2)]),s("div",{staticClass:"container routing-details-section"},[s("div",{staticClass:"route-assets__page-header-title"},[t._v("Routing Details")]),t._l(t.summaryData,(function(e,i){return s("div",{key:i,staticClass:"asset-data-container fields-container"},[s("div",{staticClass:"asset-title"},[s("div",[s("token-logo",{staticClass:"token-logo",attrs:{token:e.asset}})],1),s("div",[t._v(t._s(e.asset.symbol))])]),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("recepients")]),s("div",{staticClass:"field__value"},[t._v(t._s(e.recipientsNumber))])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("token AMOUNT required")]),s("div",{staticClass:"field__value"},[t._v(t._s(t.formatNumberJs(e.total)))]),s("div",{staticClass:"field__value usd"},[t._v(t._s(t.formatNumberJs(e.usd)))])])],1)}))],2),s("swap-dialog",{attrs:{visible:t.showSwapDialog,presetSwapData:t.swapData},on:{"update:visible":function(e){t.showSwapDialog=e}}}),s("select-input-asset-dialog",{attrs:{visible:t.showSelectInputAssetDialog},on:{"update:visible":function(e){t.showSelectInputAssetDialog=e},onInputAssetSelected:t.onInputAssetSelected}})],1)}),[],!1,null,"63c9d04b",null),k=b.exports}}]);
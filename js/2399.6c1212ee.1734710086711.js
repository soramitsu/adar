"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[2399],{42399:function(t,e,s){s.r(e),s.d(e,{default:function(){return b}});var a=s(23166),l=(s(70560),s(97582)),i=s(86424),o=s(89445),n=s(36113),r=s(68282),u=s(19307),d=s(94503),c=s(87550),v=s(35681),h=s(69781),m=s(49053);let p=class extends((0,o.Wr)(n.Z,i.tA.FormattedAmountMixin,i.tA.PaginationSearchMixin)){constructor(...t){super(...t),(0,a.Z)(this,"link","https://medium.com/@shibarimoto/kensetsu-ken-356077ebee78"),(0,a.Z)(this,"getLtvStatus",v.D),(0,a.Z)(this,"getAsset",void 0),(0,a.Z)(this,"getTax",void 0),(0,a.Z)(this,"closedAccountVaults",void 0),(0,a.Z)(this,"openedVaults",void 0),(0,a.Z)(this,"collaterals",void 0),(0,a.Z)(this,"averageCollateralPrices",void 0),(0,a.Z)(this,"screenBreakpointClass",void 0),(0,a.Z)(this,"windowWidth",void 0),(0,a.Z)(this,"selectCollateral",void 0),(0,a.Z)(this,"selectDebt",void 0),(0,a.Z)(this,"showCreateVaultDialog",!1),(0,a.Z)(this,"selectedTab",d.mD.Opened),(0,a.Z)(this,"pageAmount",6),(0,a.Z)(this,"exploreQuery","")}onWindowWidthChange(){let t;t=this.windowWidth<=u.UY.sm?2:this.windowWidth<=u.UY.lg?4:this.windowWidth<=u.UY.xl?6:8,t!==this.pageAmount&&(this.pageAmount=t,this.resetPage())}onTotalChange(){this.resetPage()}get showDropdown(){return[u.zB.Mobile,u.zB.LargeMobile].includes(this.screenBreakpointClass)}get tabs(){return Object.values(d.mD).map((t=>({name:t,label:this.t(`kensetsu.status.${t}`)+" "+`(${this.getVaultsLength(t)})`})))}isOpenedVault(t){return void 0!==t.lockedAmount}isClosedVault(t){return void 0===t.lockedAmount}getVaultsLength(t){switch(t){case d.mD.Closed:return this.closedVaultsLength;case d.mD.Liquidated:return this.liquidatedVaultsLength;case d.mD.Opened:return this.openedVaultsLength;default:return 0}}handleTabChange(t){this.selectedTab=t,this.resetPage()}updateSearch(t){this.exploreQuery=t}handlePaginationClick(t){let e=1;switch(t){case i.WALLET_CONSTS.PaginationButton.Prev:e=this.currentPage-1;break;case i.WALLET_CONSTS.PaginationButton.Next:e=this.currentPage+1,e===this.lastPage&&(this.isLtrDirection=!1);break;case i.WALLET_CONSTS.PaginationButton.First:this.isLtrDirection=!0;break;case i.WALLET_CONSTS.PaginationButton.Last:e=this.lastPage,this.isLtrDirection=!1}this.currentPage=e}get closedVaultsData(){return this.closedAccountVaults.map((t=>{const e=this.getAsset(t.lockedAssetId),s=this.getAsset(t.debtAssetId);return{...t,lockedAsset:e,debtAsset:s}}))}get closedVaults(){return this.closedVaultsData.filter((t=>t.status===d.mD.Closed))}get liquidatedVaults(){return this.closedVaultsData.filter((t=>t.status===d.mD.Liquidated))}get closedVaultsLength(){return this.closedVaults.length}get liquidatedVaultsLength(){return this.liquidatedVaults.length}get openedVaultsLength(){return this.openedVaults.length}get hasVaults(){return this.isLoggedIn&&!!(this.openedVaultsLength+this.closedAccountVaults.length)}get openedVaultsData(){return this.openedVaults.map((t=>{const e=this.getAsset(t.lockedAssetId),s=this.getAsset(t.debtAssetId),a=this.getTax(t.debtAssetId),l=i.hi.kensetsu.serializeKey(t.lockedAssetId,t.debtAssetId),o=this.collaterals[l],n=(this.averageCollateralPrices[l]??this.Zero).mul(t.lockedAmount),u=o?.riskParams.liquidationRatioReversed??0,d=n.mul(u).div(r.Tv),c=d.sub(d.mul(a)),v=t.debt.div(d),h=v.isFinity()?v.mul(r.Tv):null,m=h?v.mul(u):null,p=c.sub(t.debt);let g=o?.riskParams.hardCap.sub(o.debtSupply)??this.Zero;g=g.sub(g.mul(a));let b=g.lt(p)?g:p;return b=!b.isFinity()||b.isLteZero()?this.Zero:b.dp(2),{...t,lockedAsset:e,debtAsset:s,ltv:h,adjustedLtv:m,available:b}}))}get vaultsData(){switch(this.selectedTab){case d.mD.Opened:return this.openedVaultsData;case d.mD.Closed:return this.closedVaults;case d.mD.Liquidated:return this.liquidatedVaults;default:return this.openedVaultsData}}get filteredVaultsData(){return this.getPageItems(this.vaultsData)}get total(){return this.vaultsData.length}getVaultTitle(t,e){return e&&t?`${e.symbol} / ${t.symbol}`:""}getLockedSymbol(t){return t?.symbol??""}getDebtSymbol(t){return t?.symbol??""}format(t){return t?.toLocaleString(2)??r.m8}formatFiat(t,e){return t&&e?this.getFiatAmountByFPNumber(t,e)??r.m8:r.m8}toCodec(t){return t.codec}getLtvText(t){return d.ho[(0,v.D)(t.toNumber())]}toNumber(t){return t?.toNumber()??0}handleCreateVault(){this.showCreateVaultDialog=!0}async handleCreateSelectedVault(t,e){await this.selectCollateral(t.address),await this.selectDebt(e.address),this.showCreateVaultDialog=!0}handleOpenVaultDetails(t){h.ZP.push({name:d.KT.VaultDetails,params:{vault:`${t.id}`}})}};(0,l.gn)([m.Yn.assets.assetDataByAddress],p.prototype,"getAsset",void 0),(0,l.gn)([m.Yn.vault.getBorrowTax],p.prototype,"getTax",void 0),(0,l.gn)([m.SB.vault.closedAccountVaults],p.prototype,"closedAccountVaults",void 0),(0,l.gn)([m.SB.vault.accountVaults],p.prototype,"openedVaults",void 0),(0,l.gn)([m.SB.vault.collaterals],p.prototype,"collaterals",void 0),(0,l.gn)([m.SB.vault.averageCollateralPrices],p.prototype,"averageCollateralPrices",void 0),(0,l.gn)([m.SB.settings.screenBreakpointClass],p.prototype,"screenBreakpointClass",void 0),(0,l.gn)([m.SB.settings.windowWidth],p.prototype,"windowWidth",void 0),(0,l.gn)([m.aD.vault.setCollateralTokenAddress],p.prototype,"selectCollateral",void 0),(0,l.gn)([m.aD.vault.setDebtTokenAddress],p.prototype,"selectDebt",void 0),(0,l.gn)([(0,o.RL)("windowWidth")],p.prototype,"onWindowWidthChange",null),(0,l.gn)([(0,o.RL)("total")],p.prototype,"onTotalChange",null),p=(0,l.gn)([(0,o.wA)({components:{TokenLogo:i.wx.TokenLogo,FormattedAmount:i.wx.FormattedAmount,ExternalLink:i.wx.ExternalLink,HistoryPagination:i.wx.HistoryPagination,CreateVaultDialog:(0,c.rP)(d.JB.CreateVaultDialog),GenericPageHeader:(0,h.kF)(r.z8.GenericPageHeader),PairTokenLogo:(0,h.kF)(r.z8.PairTokenLogo),ValueStatus:(0,h.kF)(r.z8.ValueStatusWrapper),ResponsiveTabs:(0,h.kF)(r.z8.ResponsiveTabs),ExploreOverallStats:(0,c.rP)(d.JB.ExploreOverallStats),ExploreCollaterals:(0,c.rP)(d.JB.ExploreCollaterals),PositionStatus:(0,c.rP)(d.JB.PositionStatus)}})],p);var g=p,b=(0,s(1001).Z)(g,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"vaults-container"},[e("s-row",{staticClass:"vaults-header"},[e("s-col",{attrs:{xs:12,sm:6,md:6,lg:6}},[e("h2",{staticClass:"vaults-header__title s-flex"},[t._v(" Kensetsu "),e("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.introDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[e("s-icon",{staticClass:"vaults-header__title-icon",attrs:{name:"info-16",size:"16px"}})],1)],1)]),e("s-col",{staticClass:"s-flex vaults-header__action-container",attrs:{xs:12,sm:6,md:6,lg:6}},[t.isLoggedIn?e("s-button",{staticClass:"vaults-header__action s-typography-button--large",attrs:{icon:"various-atom-24",type:"primary"},on:{click:t.handleCreateVault}},[t._v(" "+t._s(t.t("kensetsu.createVaultAction"))+" ")]):e("s-button",{staticClass:"vaults-header__action s-typography-button--large",attrs:{type:"primary"},on:{click:t.connectSoraWallet}},[t._v(" "+t._s(t.t("connectWalletText"))+" ")])],1),t.hasVaults?e("s-col",{attrs:{xs:12,sm:12,md:12,lg:12}},[e("responsive-tabs",{staticClass:"vaults-header__tabs",attrs:{"is-mobile":t.showDropdown,tabs:t.tabs,value:t.selectedTab},on:{input:t.handleTabChange}})],1):t._e()],1),t.hasVaults?[e("s-row",{staticClass:"vaults-content",attrs:{gutter:24}},t._l(t.filteredVaultsData,(function(s){return e("s-col",{key:"vault_"+s.id,attrs:{xs:12,sm:6,md:6,lg:4,xl:3}},[e("s-card",{staticClass:"vault",attrs:{"border-radius":"mini",size:"medium",primary:"",clickable:""},on:{click:function(e){return t.handleOpenVaultDetails(s)}}},[e("div",{staticClass:"vault-title s-flex"},[e("pair-token-logo",{staticClass:"vault-title__icon",attrs:{"first-token":s.debtAsset,"second-token":s.lockedAsset,size:"medium"}}),e("div",{staticClass:"vault-title__container s-flex-column"},[e("h4",{staticClass:"vault-title__name"},[t._v(t._s(t.getVaultTitle(s.lockedAsset,s.debtAsset)))]),e("position-status",{attrs:{status:t.selectedTab}})],1),e("s-button",{attrs:{type:"action",size:"small",alternative:"",tooltip:t.t("assets.details")}},[e("s-icon",{attrs:{name:"arrows-chevron-right-rounded-24",size:"24"}})],1)],1),e("s-divider",{staticClass:"vault-title__divider"}),t.isOpenedVault(s)?[e("div",{staticClass:"vault-details s-flex"},[e("div",{staticClass:"vault-details__item s-flex-column"},[e("p",{staticClass:"p4 vault__label"},[t._v(" "+t._s(t.t("kensetsu.yourCollateral"))+" "),e("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.yourCollateralDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[e("s-icon",{attrs:{name:"info-16",size:"11px"}})],1)],1),s.lockedAsset?[e("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.format(s.lockedAmount),"asset-symbol":t.getLockedSymbol(s.lockedAsset)}}),e("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.formatFiat(s.lockedAmount,s.lockedAsset)}})]:t._e()],2),e("div",{staticClass:"vault-details__item s-flex-column"},[e("p",{staticClass:"p4 vault__label"},[t._v(" "+t._s(t.t("kensetsu.yourDebt"))+" "),e("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.yourDebtDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[e("s-icon",{attrs:{name:"info-16",size:"11px"}})],1)],1),s.debtAsset?[e("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.format(s.debt),"asset-symbol":t.getDebtSymbol(s.debtAsset)}}),e("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.formatFiat(s.debt,s.debtAsset)}})]:t._e()],2),e("div",{staticClass:"vault-details__item s-flex-column"},[e("p",{staticClass:"p4 vault__label"},[t._v(" "+t._s(t.t("kensetsu.availableToBorrow"))+" "),e("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.availableToBorrowDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[e("s-icon",{attrs:{name:"info-16",size:"11px"}})],1)],1),s.debtAsset?[e("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.format(s.available),"asset-symbol":t.getDebtSymbol(s.debtAsset)}}),e("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.formatFiat(s.available,s.debtAsset)}})]:t._e()],2)]),e("s-divider",{staticClass:"vault__divider"}),e("div",{staticClass:"vault__ltv s-flex"},[e("p",{staticClass:"p4 vault__label"},[t._v(" "+t._s(t.TranslationConsts.LTV)+" "),e("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.ltvDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[e("s-icon",{attrs:{name:"info-16",size:"11px"}})],1)],1),e("span",{staticClass:"vault__ltv-value s-flex"},[s.ltv&&s.adjustedLtv?[t._v(" "+t._s(t.format(s.adjustedLtv))+"% "),e("value-status",{staticClass:"vault__ltv-badge",attrs:{badge:"",value:t.toNumber(s.ltv),getStatus:t.getLtvStatus}},[t._v(" "+t._s(t.getLtvText(s.ltv))+" ")])]:[t._v("n/a")]],2)])]:e("div",{staticClass:"vault-details s-flex"},[e("div",{staticClass:"vault-details__item centered s-flex-column"},[e("p",{staticClass:"p4 vault__label"},[t._v(" "+t._s(t.t("kensetsu.totalCollateralReturned"))+" "),e("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.totalCollateralReturnedDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[e("s-icon",{attrs:{name:"info-16",size:"11px"}})],1)],1),s.lockedAsset&&s.debtAsset?[e("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.format(s.returned),"asset-symbol":t.getLockedSymbol(s.lockedAsset)}}),e("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.formatFiat(s.returned,s.lockedAsset)}}),e("s-button",{staticClass:"vault-details__action",attrs:{size:"small"},on:{click:function(e){return e.stopPropagation(),t.handleCreateSelectedVault(s.lockedAsset,s.debtAsset)}}},[t._v(" "+t._s(t.t("kensetsu.reopen"))+" ")])]:t._e()],2)])],2)],1)})),1),e("history-pagination",{staticClass:"vaults-pagination",attrs:{"current-page":t.currentPage,"page-amount":t.pageAmount,loading:t.loading,total:t.total,"last-page":t.lastPage},on:{"pagination-click":t.handlePaginationClick}}),e("s-divider",{staticClass:"vaults-divider"})]:t._e(),e("explore-overall-stats"),e("explore-collaterals",{staticClass:"vaults-stats",attrs:{"explore-query":t.exploreQuery},on:{"update-search":t.updateSearch,open:t.handleCreateSelectedVault}}),e("div",{staticClass:"vaults-disclaimer s-flex"},[e("div",{staticClass:"disclaimer s-flex-column"},[e("div",{staticClass:"disclaimer__title s-flex"},[e("div",{staticClass:"disclaimer__badge"},[e("s-icon",{staticClass:"disclaimer__icon",attrs:{name:"notifications-alert-triangle-24",size:"14"}})],1),e("h4",[t._v(t._s(t.t("disclaimerTitle")))])]),e("p",{staticClass:"disclaimer__description p4"},[t._v(t._s(t.t("kensetsu.disclaimerDescription")))]),e("external-link",{staticClass:"disclaimer__link p4",attrs:{title:t.t("kensetsu.readMore"),href:t.link}})],1)]),e("create-vault-dialog",{attrs:{visible:t.showCreateVaultDialog},on:{"update:visible":function(e){t.showCreateVaultDialog=e}}})],2)}),[],!1,null,"c8fc8866",null).exports}}]);
"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[1831],{21831:function(t,e,a){a.r(e),a.d(e,{default:function(){return m}});var i=a(23166),s=a(97582),n=a(37981),o=a(86424),l=a(89445),r=a(68282),u=a(69781),d=a(93838),c=a(50149);let h=class extends((0,l.Wr)(c.Z,o.tA.TransactionMixin,o.tA.DialogMixin)){constructor(...t){super(...t),(0,i.Z)(this,"mode",void 0),(0,i.Z)(this,"StakeDialogMode",d.gf),(0,i.Z)(this,"value",""),(0,i.Z)(this,"bondAndNominateNetworkFee",null)}resetValue(){this.visible&&(this.mode===d.gf.NEW?this.value=this.stakeAmount:this.value="")}handleSelectedValidatorsChange(){this.withApi((async()=>{this.bondAndNominateNetworkFee=await this.getBondAndNominateNetworkFee()}))}get networkFee(){switch(this.mode){case d.gf.NEW:return this.bondAndNominateNetworkFee??"0";case d.gf.ADD:return this.networkFees[n.Operation.StakingBondExtra];default:return this.networkFees[n.Operation.StakingUnbond]}}get title(){switch(this.mode){case d.gf.NEW:return this.t("soraStaking.actions.confirm");case d.gf.ADD:return this.lockedFunds.isZero()?this.t("soraStaking.newStake.title"):this.t("soraStaking.actions.more");default:return this.t("soraStaking.actions.remove")}}get inputTitle(){return this.mode!==d.gf.REMOVE?this.t("soraStaking.stakeDialog.toStake"):this.t("soraStaking.stakeDialog.toRemove")}get part(){return new n.FPNumber(this.value).div(n.FPNumber.HUNDRED)}get valueFunds(){return new n.FPNumber(this.value)}get valueFundsEmpty(){return this.valueFunds.isZero()}get stakingBalance(){return this.mode!==d.gf.REMOVE?this.availableFunds:this.lockedFunds}get stakingBalanceCodec(){return this.stakingBalance.toCodecString()}get maxStake(){if(!this.stakingAsset)return n.FPNumber.ZERO;const t=n.FPNumber.fromCodecValue(this.networkFee);return this.mode!==d.gf.REMOVE?this.stakingBalance.sub(t):this.stakingBalance}get isMaxButtonAvailable(){return!this.shouldBalanceBeHidden&&(!n.FPNumber.eq(this.valueFunds,this.maxStake)&&!n.FPNumber.lte(this.maxStake,n.FPNumber.ZERO))}get isInsufficientBalance(){const t=new n.FPNumber(this.maxStake,this.stakingAsset?.decimals);return n.FPNumber.lt(t,this.valueFunds)}get selectedValidatorsFormatted(){return this.t("soraStaking.selectedValidators",{count:this.selectedValidators.length,max:this.validators.length})}handleValue(t){this.value=String(t)}handleMaxValue(){this.handleValue(this.maxStake.toString())}async handleConfirm(){this.setStakeAmount(this.value);let t=this.unbond;this.mode===d.gf.NEW?t=this.bondAndNominate:this.mode===d.gf.ADD&&(t=this.bondExtra),await this.withNotifications((async()=>await t())),this.$emit("confirm")}async mounted(){await this.$nextTick();const t=this.$el.querySelector(".s-input .el-input__inner");t?.focus()}};(0,s.gn)([(0,l.fI)({required:!0,type:String})],h.prototype,"mode",void 0),(0,s.gn)([(0,l.RL)("visible")],h.prototype,"resetValue",null),(0,s.gn)([(0,l.RL)("selectedValidators",{immediate:!0})],h.prototype,"handleSelectedValidatorsChange",null),h=(0,s.gn)([(0,l.wA)({components:{TokenInput:(0,u.kF)(r.z8.TokenInput),DialogBase:o.wx.DialogBase,InfoLine:o.wx.InfoLine,AccountCard:o.wx.AccountCard}})],h);var g=h,m=(0,a(1001).Z)(g,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("dialog-base",{attrs:{visible:t.isVisible,title:t.title},on:{"update:visible":function(e){t.isVisible=e}}},[e("div",{staticClass:"stake-dialog"},[e("s-form",{staticClass:"el-form--actions",attrs:{"show-message":!1}},[e("token-input",{key:"stake-input",attrs:{balance:t.stakingBalanceCodec,"is-max-available":t.isMaxButtonAvailable,title:t.inputTitle,token:t.stakingAsset,value:t.value},on:{input:t.handleValue,max:t.handleMaxValue}})],1),e("div",{staticClass:"info"},[t.mode===t.StakeDialogMode.NEW?e("info-line",{attrs:{label:t.t("soraStaking.info.selectedValidators"),value:t.selectedValidatorsFormatted}}):t._e(),t.mode===t.StakeDialogMode.NEW?e("info-line",{attrs:{label:t.t("soraStaking.info.rewardToken"),value:t.rewardAsset?.symbol}}):t._e(),t.mode===t.StakeDialogMode.REMOVE?e("info-line",{attrs:{label:t.t("soraStaking.info.unstakingPeriod"),value:t.unbondPeriodFormatted}}):t._e(),e("info-line",{attrs:{label:t.t("networkFeeText"),"label-tooltip":t.t("networkFeeTooltipText"),value:t.networkFeeFormatted,"asset-symbol":t.xor?.symbol,"fiat-value":t.getFiatAmountByCodecString(t.networkFee),"is-formatted":""}})],1),t.mode===t.StakeDialogMode.REMOVE?e("s-card",{staticClass:"information",attrs:{shadow:"always",primary:""}},[e("div",{staticClass:"information-content"},[e("div",{staticClass:"information-text"},[t._v(" "+t._s(t.t("soraStaking.allWithdrawsDialog.information"))+" ")]),e("div",{staticClass:"information-icon"},[e("s-icon",{attrs:{name:"notifications-alert-triangle-24",size:"20px"}})],1)])]):t._e(),t.stakingAsset?e("s-button",{staticClass:"s-typography-button--large action-button",attrs:{type:"primary",loading:t.parentLoading||t.loading,disabled:t.isInsufficientXorForFee||t.valueFundsEmpty||t.isInsufficientBalance},on:{click:t.handleConfirm}},[t.isInsufficientXorForFee||t.isInsufficientBalance?[t._v(" "+t._s(t.t("insufficientBalanceText",{tokenSymbol:t.stakingAsset.symbol}))+" ")]:t.valueFundsEmpty?[t._v(" "+t._s(t.t("buttons.enterAmount"))+" ")]:[t._v(" "+t._s(t.t("confirmText"))+" ")]],2):t._e()],1)])}),[],!1,null,"847b3044",null).exports}}]);
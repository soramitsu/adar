"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[9561],{59561:function(e,t,s){s.r(t),s.d(t,{default:function(){return w}});var r=s(60760),a=s(70655),i=s(53545),o=s(50576),n=s(10909),c=s(63471),u=s(28335),h=s(74614),d=s(25108);let l=class extends((0,i.Wr)(o.tA.LoadingMixin,n.Z)){constructor(...e){super(...e),(0,r.Z)(this,"getEvmNetworkFee",void 0),(0,r.Z)(this,"updateEvmBlockNumber",void 0),(0,r.Z)(this,"updateRegisteredAssets",void 0),(0,r.Z)(this,"unwatchEthereum",void 0),(0,r.Z)(this,"blockHeadersSubscriber",void 0)}async created(){await this.withLoading((async()=>{await this.withParentLoading((async()=>{this.setEvmNetwork(u.Zc.externalNetwork),await this.onEvmNetworkTypeChange(),this.unwatchEthereum=await c.ZP.watchEthereum({onAccountChange:e=>{e.length?(this.switchExternalAccount(e[0]),this.updateExternalBalances()):this.disconnectExternalAccount()},onNetworkChange:e=>{this.onEvmNetworkTypeChange(e)},onDisconnect:()=>{this.disconnectExternalAccount()}}),this.subscribeToEvmBlockHeaders()}))}))}beforeDestroy(){"function"==typeof this.unwatchEthereum&&this.unwatchEthereum(),this.unsubscribeEvmBlockHeaders()}updateExternalBalances(e){this.updateRegisteredAssets(e)}async onEvmNetworkTypeChange(e){await Promise.all([this.setEvmNetworkType(e),this.updateExternalBalances(!0),this.getEvmNetworkFee()])}async subscribeToEvmBlockHeaders(){try{await this.unsubscribeEvmBlockHeaders();const e=await c.ZP.getEthersInstance();await this.updateEvmBlockNumber(),this.blockHeadersSubscriber=e.on("block",(e=>{this.updateEvmBlockNumber(e),this.updateExternalBalances(),this.getEvmNetworkFee()}))}catch(e){d.error(e)}}unsubscribeEvmBlockHeaders(){return new Promise(((e,t)=>{if(!this.blockHeadersSubscriber)return e();try{this.blockHeadersSubscriber.off("block"),e()}catch(e){t(e)}}))}};(0,a.__decorate)([h.aD.bridge.getEvmNetworkFee],l.prototype,"getEvmNetworkFee",void 0),(0,a.__decorate)([h.aD.bridge.updateEvmBlockNumber],l.prototype,"updateEvmBlockNumber",void 0),(0,a.__decorate)([h.aD.assets.updateRegisteredAssets],l.prototype,"updateRegisteredAssets",void 0),l=(0,a.__decorate)([i.wA],l);var b=l,w=(0,s(1001).Z)(b,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("router-view",e._g(e._b({},"router-view",Object.assign({},{parentLoading:e.loading},e.$attrs),!1),e.$listeners))}),[],!1,null,null,null).exports}}]);
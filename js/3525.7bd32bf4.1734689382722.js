"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[3525],{83525:function(e,t,s){s.r(t),s.d(t,{default:function(){return p}});var a=s(23166),i=s(97582),n=s(37981),o=s(69826),r=s(86424),l=s(89445),d=s(68282),u=s(69781),c=s(49053),h=s(50961);let m=class extends((0,l.Wr)(r.tA.TransactionMixin,r.tA.DialogMixin,r.tA.FormattedAmountMixin)){constructor(...e){super(...e),(0,a.Z)(this,"xorSymbol",o.XOR.symbol),(0,a.Z)(this,"tokenInput",void 0),(0,a.Z)(this,"balance",void 0),(0,a.Z)(this,"editableFiat",void 0),(0,a.Z)(this,"asset",void 0),(0,a.Z)(this,"networkFees",void 0),(0,a.Z)(this,"accountXor",void 0),(0,a.Z)(this,"value",""),(0,a.Z)(this,"address",""),(0,a.Z)(this,"comment","")}async handleDialogVisibility(e){await this.$nextTick(),this.value="",this.address="",this.comment="",this.tokenInput?.focus()}get fpBalance(){return this.getFPNumberFromCodec(this.balance,this.asset.decimals)}get xorBalance(){return this.getFPNumberFromCodec(this.accountXor?.balance?.transferable??d.m8,this.asset.decimals)}get assetWithBalance(){return{...this.asset,balance:{transferable:this.balance}}}get tokenSymbol(){return this.asset.symbol}get title(){return`Send ${this.tokenSymbol}`}get networkFee(){return this.networkFees[n.Operation.XorlessTransfer]}get fpNetworkFee(){return this.getFPNumberFromCodec(this.networkFee)}get networkFeeFormatted(){return this.formatCodecNumber(this.networkFee)}get emptyValue(){return!+this.value}get isMaxAvailable(){return(0,h.oI)(this.assetWithBalance,this.value??0,this.networkFee,this.accountXor)}get isInsufficientBalance(){return this.fpBalance.sub(this.value||0).isLtZero()}get isInsufficientXorForFee(){return this.xorBalance.sub(this.fpNetworkFee).isLtZero()}get emptyAddress(){return!this.address.trim()}get validAddress(){return!this.emptyAddress&&r.hi.validateAddress(this.address)}get disabled(){return this.loading||this.isInsufficientXorForFee||this.emptyValue||!this.validAddress||this.isInsufficientBalance}get valuePercent(){if(!this.value)return 0;const e=this.getFPNumber(this.value,this.asset.decimals).div(this.fpBalance).mul(d.Tv).toNumber(0);return e>d.Tv?d.Tv:e}handlePercentChange(e){this.value=this.fpBalance.mul(e/d.Tv).toString()}handleMaxValue(){this.value=this.fpBalance.toString()}handleCommentInput(e){if(/^[A-Za-z0-9 _',.#]+$/.test(e.key))return!0;e.preventDefault()}async handleSend(){const e=this.comment.trim()||void 0,t=this.address.trim();if(this.isInsufficientBalance)this.$alert(this.t("insufficientBalanceText",{tokenSymbol:this.tokenSymbol}),{title:this.t("errorText")});else try{await this.withNotifications((async()=>{await r.hi.assets.transfer(this.asset,t,this.value,{feeType:"xor",comment:e})}))}catch(e){console.error(e)}this.isVisible=!1}};(0,i.gn)([(0,l.Rl)("tokenInput")],m.prototype,"tokenInput",void 0),(0,i.gn)([(0,l.fI)({default:d.m8,type:String})],m.prototype,"balance",void 0),(0,i.gn)([(0,l.fI)({default:!1,type:Boolean})],m.prototype,"editableFiat",void 0),(0,i.gn)([(0,l.fI)({default:d.u8,type:Object})],m.prototype,"asset",void 0),(0,i.gn)([c.SB.wallet.settings.networkFees],m.prototype,"networkFees",void 0),(0,i.gn)([c.Yn.assets.xor],m.prototype,"accountXor",void 0),(0,i.gn)([(0,l.RL)("visible")],m.prototype,"handleDialogVisibility",null),m=(0,i.gn)([(0,l.wA)({components:{DialogBase:r.wx.DialogBase,InfoLine:r.wx.InfoLine,AddressBookInput:r.wx.AddressBookInput,TokenInput:(0,u.kF)(d.z8.TokenInput)}})],m);var b=m,p=(0,s(1001).Z)(b,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("dialog-base",{attrs:{title:e.title,visible:e.isVisible,tooltip:"COMING SOON..."},on:{"update:visible":function(t){e.isVisible=t}}},[t("div",{staticClass:"dashboard-send"},[t("address-book-input",{staticClass:"dashboard-send__address",attrs:{"exclude-connected":"","is-valid":e.validAddress,disabled:e.loading},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}}),t("token-input",{ref:"tokenInput",staticClass:"dashboard-send__token-input",attrs:{"with-slider":"",title:"AMOUNT","is-fiat-editable":e.editableFiat,"is-max-available":e.isMaxAvailable,token:e.asset,balance:e.balance,"slider-value":e.valuePercent,disabled:e.loading},on:{max:e.handleMaxValue,slide:e.handlePercentChange},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),t("s-input",{staticClass:"dashboard-send__comment",attrs:{type:"textarea",placeholder:"Comment (Optional)",rows:4,maxlength:128,disabled:e.loading},nativeOn:{keypress:function(t){return e.handleCommentInput(t)}},model:{value:e.comment,callback:function(t){e.comment=t},expression:"comment"}}),t("s-button",{staticClass:"s-typography-button--large action-button dashboard-send__button",attrs:{type:"primary",disabled:e.disabled},on:{click:e.handleSend}},[e.isInsufficientXorForFee?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.xorSymbol}))+" ")]:e.emptyAddress?[e._v(" "+e._s(e.t("walletSend.enterAddress"))+" ")]:e.validAddress?e.emptyValue?[e._v(" "+e._s(e.t("buttons.enterAmount"))+" ")]:e.isInsufficientBalance?[e._v(" "+e._s(e.t("insufficientBalanceText",{tokenSymbol:e.tokenSymbol}))+" ")]:[e._v(e._s(e.title))]:[e._v(" "+e._s(e.t("walletSend.badAddress"))+" ")]],2),t("info-line",{attrs:{label:e.t("networkFeeText"),"label-tooltip":e.t("networkFeeTooltipText"),value:e.networkFeeFormatted,"asset-symbol":e.xorSymbol,"fiat-value":e.getFiatAmountByCodecString(e.networkFee),"is-formatted":""}})],1)])}),[],!1,null,"10c5cc68",null).exports}}]);
"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[8681,2240],{21771:function(t,e,s){s.r(e),s.d(e,{default:function(){return D}});var i=s(60760),o=s(70655),a=s(53545),n=s(50592),l=s(67748),r=s(32806),c=s(74614),d=s(8755),u=s(96486),p=s(63545),h=s(36930),g=s(20923),m=s(1168),v=s(18159),_=s.n(v);let b=class extends((0,a.Wr)(r.Z)){constructor(...t){super(...t),(0,i.Z)(this,"inputToken",void 0),(0,i.Z)(this,"completedRecipients",void 0),(0,i.Z)(this,"incompletedRecipients",void 0),(0,i.Z)(this,"recipients",void 0),(0,i.Z)(this,"batchTxInfo",void 0),(0,i.Z)(this,"batchTxDatetime",void 0),(0,i.Z)(this,"fiatPriceObject",void 0),(0,i.Z)(this,"accountAssets",void 0),(0,i.Z)(this,"cancelProcessing",void 0),(0,i.Z)(this,"showFailedTransactionsDialog",!1),(0,i.Z)(this,"showFinishRoutingDialog",!1),(0,i.Z)(this,"showSelectReportFormatDialog",!1),(0,i.Z)(this,"headers",["№","NAME","WALLET","USD","INPUT TOKEN","TOKEN","AMOUNT","RATE","STATUS"])}get incompletedRecipientsLength(){return this.incompletedRecipients.length}get totalAmount(){return this.formatNumber(this.totalUSD/Number(this.getAssetUSDPrice(this.inputToken)))}get totalUSD(){return(0,u.sumBy)(this.completedRecipients,(t=>Number(t.usd)))}get withErrors(){return this.incompletedRecipientsLength>0}get summaryData(){return Object.values((0,u.groupBy)(this.completedRecipients.map((t=>({symbol:t.asset.symbol,...t}))),"symbol")).map((t=>({recipientsNumber:t.length,asset:t[0].asset,usd:(0,u.sumBy)(t,(t=>Number(t.usd))),total:(0,u.sumBy)(t,(t=>Number(t.amount))),required:(0,u.sumBy)(t,(t=>Number(t.usd)))/Number(this.getAssetUSDPrice(this.inputToken)),totalTransactions:t.length,status:this.getStatus(t)})))}getStatus(t){return t.some((t=>t.status===p.p.FAILED))?"failed":t.find((t=>t.status===p.p.PENDING))?"waiting":"routed"}getAssetUSDPrice(t){return h.FPNumber.fromCodecValue(this.fiatPriceObject[t.address]??0,18)}formatNumber(t){return t&&Number.isFinite(t)?t.toLocaleString("en-US",{maximumFractionDigits:4}):"-"}openFinishRoutingDialog(){this.showFinishRoutingDialog=!0}onFinishRouting(){this.cancelProcessing(),this.showFinishRoutingDialog=!1}onReportDownloadClick(){this.showSelectReportFormatDialog=!0}get reportData(){return this.recipients.map(((t,e)=>[`${e+1}`,t.name.toString(),t.wallet.toString(),t.usd.toString(),this.inputToken.symbol,t.asset.symbol,(t.amount?.toFixed(5)||"").toString(),t.exchangeRate||"",t.status.toString()]))}downloadCSV(){const{txId:t,blockId:e,from:s,blockNumber:i}=this.batchTxInfo,o=`data:text/csv;charset=utf-8,Datetime - ${this.batchTxDatetime?.toUTCString()}\n`+this.headers.join(",")+",TRANSACTION ID,BLOCK NUMBER,SENDER WALLET\n"+this.reportData.map((e=>`${e.join(",")},${t},${i},${s}`)).join("\n"),a=encodeURI(o),n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("download",`ADAR-${(new Date).toLocaleDateString("en-GB")}.csv`),document.body.appendChild(n),n.click()}downloadPDF(){const t=new m.jsPDF({putOnlyUsedFonts:!0,orientation:"landscape"}),{txId:e,blockId:s,from:i,blockNumber:o}=this.batchTxInfo,a=this.batchTxDatetime;t.setFontSize(12),t.text(`Transaction Id - ${e}`,5,5),t.text(`Block Number - ${o}`,5,10),t.text(`Block Id - ${s}`,5,15),t.text(`Sender wallet - ${i}`,5,20),t.text(`Datetime - ${a?.toUTCString()}`,5,25),_()(t,{head:[this.headers],body:this.reportData,startY:30,margin:{top:5,left:5,right:5,bottom:5},styles:{lineColor:[237,228,231],lineWidth:.3,fontSize:10},headStyles:{textColor:[161,154,157],fillColor:[253,247,251]},bodyStyles:{fillColor:[253,247,251],textColor:[38,38,45],cellPadding:{top:10,right:5,bottom:10,left:5}},alternateRowStyles:{fillColor:[255,250,251]},columnStyles:{8:{fontStyle:"bold"}},didParseCell:function(t){"body"===t.row.section&&(t.cell.text.includes(p.p.FAILED)&&(t.cell.styles.textColor=[231,76,60]),t.cell.text.includes(p.p.SUCCESS)&&(t.cell.styles.textColor=[52,173,135]))}}),t.save(`ADAR-${(new Date).toLocaleDateString("en-GB")}.pdf`)}};(0,o.__decorate)([c.Yn.routeAssets.inputToken],b.prototype,"inputToken",void 0),(0,o.__decorate)([c.Yn.routeAssets.completedRecipients],b.prototype,"completedRecipients",void 0),(0,o.__decorate)([c.Yn.routeAssets.incompletedRecipients],b.prototype,"incompletedRecipients",void 0),(0,o.__decorate)([c.Yn.routeAssets.recipients],b.prototype,"recipients",void 0),(0,o.__decorate)([c.Yn.routeAssets.batchTxInfo],b.prototype,"batchTxInfo",void 0),(0,o.__decorate)([c.Yn.routeAssets.batchTxDatetime],b.prototype,"batchTxDatetime",void 0),(0,o.__decorate)([c.SB.wallet.account.fiatPriceObject],b.prototype,"fiatPriceObject",void 0),(0,o.__decorate)([c.SB.wallet.account.accountAssets],b.prototype,"accountAssets",void 0),(0,o.__decorate)([c.aD.routeAssets.cancelProcessing],b.prototype,"cancelProcessing",void 0),b=(0,o.__decorate)([(0,a.wA)({components:{TokenLogo:d.wx.TokenLogo,WarningMessage:g.default,FailedTransactionsDialog:(0,l.y)(n.EC.RouteAssetsFailedTransactionsDialog),ConfirmFinishRoutingDialog:(0,l.y)(n.EC.RouteAssetsConfirmFinishRoutingDialog),SelectReportFormatDialog:(0,l.y)(n.EC.RouteAssetsSelectReportFormatDialog)}})],b);var f=b,C=(0,s(1001).Z)(f,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"route-assets-review-details"},[s("div",{staticClass:"container route-assets-upload-template"},[s("div",{staticClass:"route-assets__page-header-title"},[t._v("Routing completed")]),s("div",{staticClass:"route-assets__page-header-description"},[t._v(" "+t._s("View the details of your recent routing transaction")+" ")]),s("div",{staticClass:"fields-container"},[s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("INPUT ASSET")]),s("div",{staticClass:"field__value"},[s("div",[t._v(t._s(t.inputToken.symbol))]),s("div",[s("token-logo",{staticClass:"token-logo",attrs:{token:t.inputToken}})],1)])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("total")]),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.totalAmount)+" "),s("span",{staticClass:"usd"},[t._v(t._s(t.totalUSD))])])]),s("s-divider"),t.incompletedRecipientsLength>0?s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("FAILED TRANSACTIONS")]),s("warning-message",{staticClass:"warning-message",attrs:{text:"re-run failed transactions",isError:!0}}),s("div",{staticClass:"field__value"},[t._v(" "+t._s(t.incompletedRecipientsLength)+" ")])],1):t._e()],1),s("div",{staticClass:"buttons-container"},[t.withErrors?s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"primary"},on:{click:function(e){e.stopPropagation(),t.showFailedTransactionsDialog=!0}}},[t._v(" "+t._s("RE-RUN FAILED TRANSACTIONS")+" ")]):t._e(),t.withErrors?t._e():s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"secondary"},on:{click:function(e){return e.stopPropagation(),t.onReportDownloadClick()}}},[t._v(" "+t._s("DOWNLOAD Report")+" ")]),t.withErrors?s("s-button",{staticClass:"s-typography-button--big open-finish-routing-button",attrs:{type:"link"},on:{click:function(e){return e.stopPropagation(),t.openFinishRoutingDialog.apply(null,arguments)}}},[s("span",[t._v(t._s("Re-run doesn’t help? Finish routing anyway"))])]):s("s-button",{staticClass:"s-typography-button--big",attrs:{type:"primary"},on:{click:function(e){return e.stopPropagation(),t.onFinishRouting.apply(null,arguments)}}},[t._v(" "+t._s("FINISH")+" ")])],1)]),t.summaryData.length>0?s("div",{staticClass:"container routing-details-section"},[s("div",{staticClass:"route-assets__page-header-title"},[t._v("Routing Details")]),t._l(t.summaryData,(function(e,i){return s("div",{key:i,staticClass:"asset-data-container fields-container"},[s("div",{staticClass:"asset-title"},[s("div",[s("token-logo",{staticClass:"token-logo",attrs:{token:e.asset}})],1),s("div",[t._v(t._s(e.asset.symbol))])]),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("recipients")]),s("div",{staticClass:"field__value"},[t._v(t._s(e.recipientsNumber))])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("token AMOUNT routed")]),s("div",{staticClass:"field__value"},[t._v(t._s(t.formatNumber(e.total)))]),s("div",{staticClass:"field__value usd"},[t._v(t._s(t.formatNumber(e.usd)))])]),s("s-divider"),s("div",{staticClass:"field"},[s("div",{staticClass:"field__label"},[t._v("Status")]),s("div",{staticClass:"field__value",class:"field__value_"+e.status},[t._v(t._s(e.status))])])],1)}))],2):t._e(),s("failed-transactions-dialog",{attrs:{visible:t.showFailedTransactionsDialog},on:{"update:visible":function(e){t.showFailedTransactionsDialog=e}}}),s("confirm-finish-routing-dialog",{attrs:{visible:t.showFinishRoutingDialog},on:{"update:visible":function(e){t.showFinishRoutingDialog=e},onConfirmClick:t.onFinishRouting}}),s("select-report-format-dialog",{attrs:{visible:t.showSelectReportFormatDialog},on:{"update:visible":function(e){t.showSelectReportFormatDialog=e},onConfirmClick:t.onFinishRouting,onPDFSelect:t.downloadPDF,onCSVSelect:t.downloadCSV}})],1)}),[],!1,null,"77d6ab18",null),D=C.exports}}]);
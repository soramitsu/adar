"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[9510],{29510:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var i=s(23166),a=s(97582),o=s(37981),l=s(69826),r=s(86424),n=s(89445),u=s(68282),c=s(69781),d=s(49053),b=s(50961);let h=class extends((0,n.Wr)(r.tA.TransactionMixin,r.tA.DialogMixin,r.tA.FormattedAmountMixin)){constructor(...t){super(...t),(0,i.Z)(this,"xorSymbol",l.XOR.symbol),(0,i.Z)(this,"swapLink","/#/swap/XOR/KUSD"),(0,i.Z)(this,"vault",void 0),(0,i.Z)(this,"lockedAsset",void 0),(0,i.Z)(this,"debtAsset",void 0),(0,i.Z)(this,"networkFees",void 0),(0,i.Z)(this,"accountXor",void 0)}get xorBalance(){return this.getFPNumberFromCodec(this.accountXor?.balance?.transferable??u.m8)}get title(){return this.t("kensetsu.closeVault")}get networkFee(){return this.networkFees[o.Operation.CloseVault]}get fpNetworkFee(){return this.getFPNumberFromCodec(this.networkFee)}get networkFeeFormatted(){return this.formatCodecNumber(this.networkFee)}get isInsufficientXorForFee(){return this.xorBalance.sub(this.fpNetworkFee).isLtZero()}get debtSymbol(){return this.debtAsset?.symbol??""}get lockedSymbol(){return this.lockedAsset?.symbol??""}get vaultTitle(){return this.debtSymbol&&this.lockedSymbol?`${this.debtSymbol} / ${this.lockedSymbol}`:""}get formattedLockedAmount(){return this.vault?.lockedAmount.toLocaleString()??u.m8}get fiatLockedAmount(){return this.vault&&this.lockedAsset?this.getFiatAmountByFPNumber(this.vault.lockedAmount,this.lockedAsset)??u.m8:u.m8}get debt(){return this.vault?.debt??this.Zero}get formattedDebtAmount(){return this.debt.toLocaleString()??u.m8}get fiatDebt(){return this.debtAsset?this.getFiatAmountByFPNumber(this.debt,this.debtAsset)??u.m8:u.m8}get debtAssetBalanceFp(){return this.getFPNumberFromCodec((0,b.rh)(this.debtAsset)??0,this.debtAsset?.decimals)}get formattedDebtAssetBalance(){return this.debtAssetBalanceFp.toLocaleString()}get fiatDebtAssetBalance(){return this.debtAsset?this.getFiatAmountByFPNumber(this.debtAssetBalanceFp,this.debtAsset)??u.m8:u.m8}get isInsufficientBalance(){return this.debt.gt(this.debtAssetBalanceFp)}get diff(){return this.debt.sub(this.debtAssetBalanceFp)}get formattedDiff(){return this.isInsufficientBalance?this.diff.toLocaleString():""}get diffWithSlippage(){return this.diff.mul(1.02)}get formattedDiffWithSlippage(){return this.isInsufficientBalance?this.diffWithSlippage.toLocaleString():""}get fiatDiffWithSlippage(){return this.debtAsset?this.getFiatAmountByFPNumber(this.diffWithSlippage,this.debtAsset)??u.m8:u.m8}get disabled(){return this.loading||this.isInsufficientXorForFee||this.isInsufficientBalance}get errorMessage(){let t="";return this.isInsufficientXorForFee?t=this.t("insufficientBalanceText",{tokenSymbol:this.xorSymbol}):this.isInsufficientBalance&&(t=this.t("insufficientBalanceText",{tokenSymbol:this.debtSymbol})),t}openSwap(){window.open(this.swapLink,"_blank")}async handleCloseVault(){if(this.disabled)this.errorMessage&&this.$alert(this.errorMessage,{title:this.t("errorText")});else try{await this.withNotifications((async()=>{if(!(this.vault&&this.lockedAsset&&this.debtAsset))throw new Error("[api.kensetsu.closeVault]: vault or asset is null");await r.hi.kensetsu.closeVault(this.vault,this.lockedAsset,this.debtAsset)}))}catch(t){console.error(t)}this.isVisible=!1,this.$emit("confirm")}};(0,a.gn)([(0,n.fI)({type:Object,default:u.u8})],h.prototype,"vault",void 0),(0,a.gn)([(0,n.fI)({type:Object,default:u.u8})],h.prototype,"lockedAsset",void 0),(0,a.gn)([(0,n.fI)({type:Object,default:u.u8})],h.prototype,"debtAsset",void 0),(0,a.gn)([d.SB.wallet.settings.networkFees],h.prototype,"networkFees",void 0),(0,a.gn)([d.Yn.assets.xor],h.prototype,"accountXor",void 0),h=(0,a.gn)([(0,n.wA)({components:{DialogBase:r.wx.DialogBase,InfoLine:r.wx.InfoLine,ExternalLink:r.wx.ExternalLink,PairTokenLogo:(0,c.kF)(u.z8.PairTokenLogo)}})],h);var f=h,m=(0,s(1001).Z)(f,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("dialog-base",{attrs:{title:t.title,visible:t.isVisible,tooltip:t.t("kensetsu.closeVaultDescription")},on:{"update:visible":function(e){t.isVisible=e}}},[e("div",{staticClass:"vault-close"},[e("div",{staticClass:"vault-close__title s-flex"},[e("pair-token-logo",{staticClass:"vault-close__icon",attrs:{size:"medium","first-token":t.debtAsset,"second-token":t.lockedAsset}}),e("h3",[t._v(t._s(t.vaultTitle))])],1),e("info-line",{staticClass:"vault-close__collateral",attrs:{label:t.t("kensetsu.yourCollateral"),"label-tooltip":t.t("kensetsu.yourCollateralDescription"),value:t.formattedLockedAmount,"asset-symbol":t.lockedSymbol,"fiat-value":t.fiatLockedAmount,"is-formatted":""}}),e("info-line",{staticClass:"vault-close__debt",attrs:{label:t.t("kensetsu.yourDebt"),"label-tooltip":t.t("kensetsu.yourDebtDescription"),value:t.formattedDebtAmount,"asset-symbol":t.debtSymbol,"fiat-value":t.fiatDebt,"is-formatted":""}}),e("info-line",{staticClass:"vault-close__balance",attrs:{label:t.t("kensetsu.yourDebtTokenBalance",{tokenSymbol:t.debtSymbol}),value:t.formattedDebtAssetBalance,"asset-symbol":t.debtSymbol,"fiat-value":t.fiatDebtAssetBalance,"is-formatted":""}}),t.isInsufficientBalance?e("s-card",{staticClass:"vault-close__error",attrs:{"border-radius":"small",shadow:"always",size:"medium",pressed:""}},[e("div",{staticClass:"vault-close__error-card-header s-flex",attrs:{slot:"header"},slot:"header"},[e("div",{staticClass:"vault-close__error-header s-flex-column"},[e("p",{staticClass:"vault-close__error-title p3"},[t._v(t._s(t.t("kensetsu.requiredAmountWithSlippage")))]),e("h3",{staticClass:"vault-close__error-value"},[t._v(t._s(t.formattedDiffWithSlippage))])]),e("div",{staticClass:"vault-close__error-badge"},[e("s-icon",{staticClass:"vault-close__error-icon",attrs:{name:"notifications-alert-triangle-24",size:"24"}})],1)]),e("p",{staticClass:"vault-close__error-message p3"},[t._v(" "+t._s(t.t("kensetsu.requiredAmountWithSlippageDescription",{tokenSymbol:t.debtSymbol,amount:t.formattedDiff}))+" ")]),e("s-button",{staticClass:"s-typography-button--large vault-close__button",attrs:{type:"primary"},on:{click:function(e){return e.preventDefault(),t.openSwap.apply(null,arguments)}}},[e("external-link",{staticClass:"vault-close__error-link s-typography-button--large",attrs:{tabindex:"-1",title:t.t("kensetsu.openSwap"),href:t.swapLink}})],1)],1):t._e(),e("s-button",{staticClass:"s-typography-button--large action-button vault-close__button",attrs:{type:"primary",disabled:t.disabled},on:{click:t.handleCloseVault}},[t.disabled?[t._v(t._s(t.errorMessage))]:[t._v(t._s(t.title))]],2),e("info-line",{attrs:{label:t.t("networkFeeText"),"label-tooltip":t.t("networkFeeTooltipText"),value:t.networkFeeFormatted,"asset-symbol":t.xorSymbol,"fiat-value":t.getFiatAmountByCodecString(t.networkFee),"is-formatted":""}})],1)])}),[],!1,null,"49751c9c",null),p=m.exports}}]);
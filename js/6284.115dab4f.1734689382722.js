"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[6284],{86284:function(i,e,t){t.r(e),t.d(e,{default:function(){return u}});var a=t(23166),s=(t(70560),t(97582)),l=t(86424),n=t(83999),r=t(89445),m=t(89334),o=t(49053),d=t(25825);let h=class extends((0,r.Wr)(m.Z,l.tA.LoadingMixin)){constructor(...i){super(...i),(0,a.Z)(this,"authLogin",void 0),(0,a.Z)(this,"isEuroBalanceEnough",void 0),(0,a.Z)(this,"emailCountDown",""),(0,a.Z)(this,"prefilledEmail",""),(0,a.Z)(this,"unconfirmedEmail",""),(0,a.Z)(this,"emailSentFirstTime",!1),(0,a.Z)(this,"emailResendCount",59),(0,a.Z)(this,"firstName",""),(0,a.Z)(this,"lastName",""),(0,a.Z)(this,"email",""),(0,a.Z)(this,"emailSent",!1)}handleSmsCountChange(i){const e=i.toString().length>1?"":"0";this.emailCountDown=`00:${e}${i}`}handleSendEmail(){return this.startEmailCountDown(),(this.isPrefilledEmailValid||this.isEmailMismatch)&&this.prefilledEmail!==this.email?(this.authLogin.ChangeUnconfirmedEmail({Email:this.email}).catch((i=>{console.error("[SoraCard]: Error while changing email",i)})),this.unconfirmedEmail=this.email,void(this.emailSent=!0)):this.emailSentFirstTime||this.isPrefilledEmailValid?(this.authLogin.SendVerificationEmail().catch((i=>{console.error("[SoraCard]: Error while resending email",i)})),void(this.emailSent=!0)):(this.authLogin.UserMinimalRegistration({Email:this.email,FirstName:this.firstName,LastName:this.lastName}).catch((i=>{console.error("[SoraCard]: Error while email setup",i)})),this.unconfirmedEmail=this.email,void(this.emailSentFirstTime=!0))}get emailInputDescription(){return this.emailSent?this.t("card.emailInputAfterSendDesc"):this.t("card.emailInputBeforeSendDesc")}get computedClassEmail(){const i=["sora-card__email-input-description"];return this.emailSent&&i.push("sora-card__email-input-description--sent"),i.join(" ")}get buttonText(){return this.emailSent&&this.emailCountDown?this.t("card.resendInBtn",{value:this.emailCountDown}):this.t("card.sendEmailLinkBtn")}get sendBtnDisabled(){return!!this.emailSent||(this.isPrefilledEmailValid?!n.validate(this.email):!this.firstName||!this.lastName||!n.validate(this.email))}get showNameInputs(){return"undefined"===this.prefilledEmail||!this.prefilledEmail}get isPrefilledEmailValid(){return!("undefined"===this.prefilledEmail&&!this.prefilledEmail)&&n.validate(this.prefilledEmail)}get isEmailMismatch(){return!!this.unconfirmedEmail&&this.unconfirmedEmail!==this.email}startEmailCountDown(){const i=setInterval((()=>{this.emailResendCount--,this.emailResendCount<0&&(this.emailSent=!1,this.emailResendCount=59,clearInterval(i))}),1e3)}mounted(){this.prefilledEmail=localStorage.getItem("PW-Email")||"undefined","undefined"!==this.prefilledEmail&&(this.email=this.prefilledEmail),this.authLogin&&this.authLogin.on("Verification-Email-Sent-Success",(()=>{this.emailSent=!0})).on("Verification-Email-ReSent-Success",(()=>{this.emailSent=!0})).on("Email-verified",(()=>{this.unconfirmedEmail="",this.isEuroBalanceEnough?this.$emit("confirm",d.aS.Kyc):this.$emit("confirm",d.aS.Payment)}))}};(0,s.gn)([o.SB.soraCard.authLogin],h.prototype,"authLogin",void 0),(0,s.gn)([o.Yn.soraCard.isEuroBalanceEnough],h.prototype,"isEuroBalanceEnough",void 0),(0,s.gn)([(0,r.RL)("emailResendCount",{immediate:!0})],h.prototype,"handleSmsCountChange",null),h=(0,s.gn)([r.wA],h);var c=h,u=(0,t(1001).Z)(c,(function(){var i=this,e=i._self._c;i._self._setupProxy;return e("div",{staticClass:"sora-card"},[e("s-input",{attrs:{maxlength:"320",placeholder:i.t("card.emailPlaceholder"),disabled:i.loading,type:"email"},model:{value:i.email,callback:function(e){i.email=e},expression:"email"}}),e("p",{class:i.computedClassEmail},[i._v(i._s(i.emailInputDescription))]),i.emailSent?[e("s-icon",{attrs:{name:"basic-check-mark-24",size:"16px"}}),i.emailSent?e("p",{staticClass:"sora-card__email-input-description"},[i._v(i._s(i.t("card.emailSpamReminder")))]):i._e()]:i._e(),i.showNameInputs?e("div",[e("s-input",{staticClass:"sora-card__input-name",attrs:{maxlength:"50",placeholder:i.t("card.firstNamePlaceholder"),disabled:i.loading},model:{value:i.firstName,callback:function(e){i.firstName=e},expression:"firstName"}}),e("s-input",{attrs:{maxlength:"50",placeholder:i.t("card.lastNamePlaceholder"),disabled:i.loading},model:{value:i.lastName,callback:function(e){i.lastName=e},expression:"lastName"}}),e("p",{staticClass:"sora-card__name-input-description"},[i._v(i._s(i.t("card.personalNameInputDesc")))])],1):i._e(),e("s-button",{staticClass:"sora-card__btn s-typography-button--large",attrs:{type:"primary",disabled:i.sendBtnDisabled},on:{click:i.handleSendEmail}},[e("span",{staticClass:"text"},[i._v(" "+i._s(i.buttonText)+" ")])])],2)}),[],!1,null,"76f927f4",null).exports}}]);
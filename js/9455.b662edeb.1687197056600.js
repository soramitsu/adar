"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[9455],{69455:function(i,e,t){t.r(e),t.d(e,{default:function(){return u}});var a=t(60760),s=t(70655),l=t(53545),n=t(83999),r=t(32806),m=t(8755),d=t(74614),o=t(25108);let h=class extends((0,l.Wr)(r.Z,m.tA.LoadingMixin)){constructor(...i){super(...i),(0,a.Z)(this,"authLogin",void 0),(0,a.Z)(this,"emailCountDown",""),(0,a.Z)(this,"prefilledEmail",""),(0,a.Z)(this,"unconfirmedEmail",""),(0,a.Z)(this,"emailSentFirstTime",!1),(0,a.Z)(this,"emailResendCount",59),(0,a.Z)(this,"firstName",""),(0,a.Z)(this,"lastName",""),(0,a.Z)(this,"email",""),(0,a.Z)(this,"emailSent",!1)}handleSmsCountChange(i){const e=i.toString().length>1?"":"0";this.emailCountDown=`00:${e}${i}`}handleSendEmail(){return this.startEmailCountDown(),(this.isPrefilledEmailValid||this.isEmailMismatch)&&this.prefilledEmail!==this.email?(this.authLogin.ChangeUnconfirmedEmail({Email:this.email}).catch((i=>{o.error("[SoraCard]: Error while changing email",i)})),this.unconfirmedEmail=this.email,void(this.emailSent=!0)):this.emailSentFirstTime||this.isPrefilledEmailValid?(this.authLogin.SendVerificationEmail().catch((i=>{o.error("[SoraCard]: Error while resending email",i)})),void(this.emailSent=!0)):(this.authLogin.UserMinimalRegistration({Email:this.email,FirstName:this.firstName,LastName:this.lastName}).catch((i=>{o.error("[SoraCard]: Error while email setup",i)})),this.unconfirmedEmail=this.email,void(this.emailSentFirstTime=!0))}get emailInputDescription(){return this.emailSent?this.t("card.emailInputAfterSendDesc"):this.t("card.emailInputBeforeSendDesc")}get buttonText(){return this.emailSent&&this.emailCountDown?this.t("card.resendInBtn",{value:this.emailCountDown}):this.t("card.sendEmailLinkBtn")}get sendBtnDisabled(){return!!this.emailSent||(this.isPrefilledEmailValid?!n.validate(this.email):!this.firstName||!this.lastName||!n.validate(this.email))}get showNameInputs(){return"undefined"===this.prefilledEmail||!this.prefilledEmail}get isPrefilledEmailValid(){return!("undefined"===this.prefilledEmail&&!this.prefilledEmail)&&n.validate(this.prefilledEmail)}get isEmailMismatch(){return!!this.unconfirmedEmail&&this.unconfirmedEmail!==this.email}startEmailCountDown(){const i=setInterval((()=>{this.emailResendCount--,this.emailResendCount<0&&(this.emailSent=!1,this.emailResendCount=59,clearInterval(i))}),1e3)}mounted(){this.prefilledEmail=localStorage.getItem("PW-Email")||"undefined","undefined"!==this.prefilledEmail&&(this.email=this.prefilledEmail),this.authLogin&&this.authLogin.on("Verification-Email-Sent-Success",(()=>{this.emailSent=!0})).on("Verification-Email-ReSent-Success",(()=>{this.emailSent=!0})).on("Email-verified",(()=>{this.unconfirmedEmail="",this.$emit("confirm")}))}};(0,s.__decorate)([d.SB.soraCard.authLogin],h.prototype,"authLogin",void 0),(0,s.__decorate)([(0,l.RL)("emailResendCount",{immediate:!0})],h.prototype,"handleSmsCountChange",null),h=(0,s.__decorate)([l.wA],h);var c=h,u=(0,t(1001).Z)(c,(function(){var i=this,e=i.$createElement,t=i._self._c||e;return t("div",{staticClass:"sora-card"},[t("s-input",{attrs:{maxlength:"320",placeholder:i.t("card.emailPlaceholder"),disabled:i.loading,type:"email"},model:{value:i.email,callback:function(e){i.email=e},expression:"email"}}),t("p",{staticClass:"sora-card__email-input-description"},[i._v(i._s(i.emailInputDescription))]),i.emailSent?t("s-icon",{attrs:{name:"basic-check-mark-24",size:"16px"}}):i._e(),i.showNameInputs?t("div",[t("s-input",{staticClass:"sora-card__input-name",attrs:{maxlength:"50",placeholder:i.t("card.firstNamePlaceholder"),disabled:i.loading},model:{value:i.firstName,callback:function(e){i.firstName=e},expression:"firstName"}}),t("s-input",{attrs:{maxlength:"50",placeholder:i.t("card.lastNamePlaceholder"),disabled:i.loading},model:{value:i.lastName,callback:function(e){i.lastName=e},expression:"lastName"}}),t("p",{staticClass:"sora-card__name-input-description"},[i._v(i._s(i.t("card.personalNameInputDesc")))])],1):i._e(),t("s-button",{staticClass:"sora-card__btn s-typography-button--large",attrs:{type:"primary",disabled:i.sendBtnDisabled},on:{click:i.handleSendEmail}},[t("span",{staticClass:"text"},[i._v(" "+i._s(i.buttonText)+" ")])])],1)}),[],!1,null,"4b3929a8",null).exports}}]);
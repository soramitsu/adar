"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[530],{60530:function(e,t,r){r.r(t),r.d(t,{default:function(){return g}});var o=r(23166),i=r(97582),s=r(99278),n=r(86424),d=r(89445),c=r(55174),a=r(36113),l=r(68282),u=r(69781),h=r(49053),p=r(74655),v=r(50961);let b=class extends((0,d.Wr)(c.Z,a.Z,n.tA.LoadingMixin,n.tA.TransactionMixin)){constructor(...e){super(...e),(0,o.Z)(this,"Filter",p.wn),(0,o.Z)(this,"Cancel",p.$j),(0,o.Z)(this,"userLimitOrders",void 0),(0,o.Z)(this,"orderBookId",void 0),(0,o.Z)(this,"nodeIsConnected",void 0),(0,o.Z)(this,"subscribeToUserLimitOrders",void 0),(0,o.Z)(this,"unsubscribeFromUserLimitOrders",void 0),(0,o.Z)(this,"ordersToBeCancelled",void 0),(0,o.Z)(this,"setOrdersToBeCancelled",void 0),(0,o.Z)(this,"currentOrderBook",void 0),(0,o.Z)(this,"currentFilter",p.wn.open),(0,o.Z)(this,"openOrdersLoading",!1)}async updateSubscription(){this.openOrdersLoading=!0,await this.subscribeToUserLimitOrders(),await(0,v.gw)(2e3),this.openOrdersLoading=!1}get openOrdersText(){return this.t("orderBook.history.openOrders",{value:this.openOrdersCount})}get cancelText(){return this.hasSelectedForCancellation?this.t("orderBook.history.cancel",{value:`(${this.ordersToBeCancelled.length})`}):this.t("orderBook.history.cancel")}get cancelAllText(){return this.t("orderBook.history.cancelAll")}get hasSelectedForCancellation(){return this.ordersToBeCancelled.length>0}get isBookStopped(){return!this.currentOrderBook||this.currentOrderBook.status===s.OrderBookStatus.Stop}get openOrdersCount(){if(!this.isLoggedIn)return"";const e=this.userLimitOrders.length;return e>0?`(${e})`:""}get isCancelAllInactive(){return this.loading||this.isBookStopped||!this.userLimitOrders.length}get isCancelMultipleInactive(){return this.loading||this.isBookStopped||!this.hasSelectedForCancellation}switchFilter(e){this.currentFilter=e}openConfirmCancelDialog(){this.isBookStopped||this.userLimitOrders.length&&this.confirmOrExecute(this.cancelOrders)}async cancelOrders(e=p.$j.all){if(this.loading||this.isBookStopped||!this.userLimitOrders.length)return;const t=e===p.$j.multiple?this.ordersToBeCancelled:this.userLimitOrders;t.length&&await this.withNotifications((async()=>{const{orderBookId:{base:e,quote:r}}=t[0],o=t.map((e=>e.id));o.length>1?await n.hi.orderBook.cancelLimitOrderBatch(e,r,o):await n.hi.orderBook.cancelLimitOrder(e,r,o[0]),this.setOrdersToBeCancelled([])}))}beforeDestroy(){this.unsubscribeFromUserLimitOrders()}};(0,i.gn)([h.SB.orderBook.userLimitOrders],b.prototype,"userLimitOrders",void 0),(0,i.gn)([h.Yn.orderBook.orderBookId],b.prototype,"orderBookId",void 0),(0,i.gn)([h.Yn.settings.nodeIsConnected],b.prototype,"nodeIsConnected",void 0),(0,i.gn)([h.aD.orderBook.subscribeToUserLimitOrders],b.prototype,"subscribeToUserLimitOrders",void 0),(0,i.gn)([h.aD.orderBook.unsubscribeFromUserLimitOrders],b.prototype,"unsubscribeFromUserLimitOrders",void 0),(0,i.gn)([h.SB.orderBook.ordersToBeCancelled],b.prototype,"ordersToBeCancelled",void 0),(0,i.gn)([h.QF.orderBook.setOrdersToBeCancelled],b.prototype,"setOrdersToBeCancelled",void 0),(0,i.gn)([h.Yn.orderBook.currentOrderBook],b.prototype,"currentOrderBook",void 0),(0,i.gn)([(0,d.RL)("orderBookId",{immediate:!0}),(0,d.RL)("soraAddress"),(0,d.RL)("nodeIsConnected")],b.prototype,"updateSubscription",null),b=(0,i.gn)([(0,d.wA)({components:{BaseWidget:(0,u.kF)(l.z8.BaseWidget),AllOrders:(0,u.kF)(l.z8.AllOrders),OpenOrders:(0,u.kF)(l.z8.OpenOrders),CancelConfirm:(0,u.kF)(l.z8.CancelOrders)}})],b);var m=b,g=(0,r(1001).Z)(m,(function(){var e=this,t=e._self._c;e._self._setupProxy;return t("base-widget",{staticClass:"order-history-widget s-flex-column",attrs:{extensive:"",delimeter:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"order-history-buttons order-history-buttons--filter-buttons"},[t("span",{directives:[{name:"button",rawName:"v-button"}],class:["order-history-button",{active:e.currentFilter===e.Filter.open}],on:{click:function(t){return e.switchFilter(e.Filter.open)}}},[e._v(" "+e._s(e.openOrdersText)+" ")]),t("span",{directives:[{name:"button",rawName:"v-button"}],class:["order-history-button",{active:e.currentFilter===e.Filter.all}],on:{click:function(t){return e.switchFilter(e.Filter.all)}}},[e._v(" "+e._s(e.t("orderBook.history.orderHistory"))+" ")]),t("span",{directives:[{name:"button",rawName:"v-button"}],class:["order-history-button",{active:e.currentFilter===e.Filter.executed}],on:{click:function(t){return e.switchFilter(e.Filter.executed)}}},[e._v(" "+e._s(e.t("orderBook.history.tradeHistory"))+" ")])]),e.isLoggedIn?t("div",{staticClass:"order-history-buttons order-history-buttons--cancel-buttons"},[t("span",{directives:[{name:"button",rawName:"v-button"}],class:["order-history-button","order-history-button--cancel",{inactive:e.isCancelMultipleInactive}],on:{click:function(t){return e.cancelOrders(e.Cancel.multiple)}}},[e._v(" "+e._s(e.cancelText)+" ")]),t("span",{directives:[{name:"button",rawName:"v-button"}],class:["order-history-button","order-history-button--cancel",{inactive:e.isCancelAllInactive}],on:{click:e.openConfirmCancelDialog}},[e._v(" "+e._s(e.cancelAllText)+" ")])]):e._e()]},proxy:!0}])},[e.isLoggedIn?t("div",{staticClass:"order-history-main s-flex-column"},[e.currentFilter===e.Filter.open?t("open-orders",{attrs:{"parent-loading":e.openOrdersLoading}}):t("all-orders",{attrs:{filter:e.currentFilter}})],1):t("div",{staticClass:"order-history-connect-account"},[t("div",{staticClass:"order-history-connect-account-button"},[t("h4",{staticClass:"h4"},[e._v(e._s(e.t("orderBook.history.connect")))]),t("s-button",{staticClass:"btn s-typography-button--medium",attrs:{type:"primary"},on:{click:e.connectSoraWallet}},[e._v(" "+e._s(e.t("connectWalletText"))+" ")])],1)]),t("cancel-confirm",{attrs:{visible:e.confirmDialogVisibility},on:{"update:visible":function(t){e.confirmDialogVisibility=t},confirm:e.cancelOrders}})],1)}),[],!1,null,"5ee7e1f9",null).exports}}]);
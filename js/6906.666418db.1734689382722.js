"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[6906],{36906:function(t,e,s){s.r(e),s.d(e,{default:function(){return C}});var a=s(23166),r=s(97582),o=s(37981),i=s(86424),d=s(47292),n=s(50647),l=s(18159),u=s.n(l),c=s(89445),h=s(89334),p=s(56382),g=s(49053);let m=class extends((0,c.Wr)(i.tA.LoadingMixin,h.Z)){constructor(...t){super(...t),(0,a.Z)(this,"userAddress",void 0),(0,a.Z)(this,"selectedPeriod",{title:"",date:new Date}),(0,a.Z)(this,"dropdownPeriodMenuItems",[{title:"thisWeek",action:()=>this.getStartDate(0)},{title:"lastWeek",action:()=>this.getStartDate(1)},{title:"thisMonth",action:()=>this.getStartDate(void 0,0)},{title:"3Months",action:()=>this.getStartDate(void 0,2)},{title:"6Months",action:()=>this.getStartDate(void 0,5)},{title:"year",action:()=>this.getStartDate(void 0,void 0,0)}]),(0,a.Z)(this,"adarTxs",[]),(0,a.Z)(this,"address",""),(0,a.Z)(this,"datetime",""),(0,a.Z)(this,"headers",["â„–",this.t("adar.routeAssets.wallet"),this.t("adar.routeAssets.asset"),this.t("adar.routeAssets.stages.transactionOverview.amount"),this.t("adar.routeAssets.stages.done.report.exchangeRate")])}get currentPeriodLabel(){return this.t(`adar.routingHistory.dropdownItems.${this.selectedPeriod.title}`)}getStartDate(t,e,s){let a=new Date;return void 0!==t&&(a=(0,d.startOfWeek)((0,d.subWeeks)(a,t))),void 0!==e&&(a=(0,d.startOfMonth)((0,d.subMonths)(a,e))),void 0!==s&&(a=(0,d.startOfYear)((0,d.subYears)(a,s))),a}handleSelectPeriodMenu({title:t,action:e}){this.selectedPeriod.title=t,this.selectedPeriod.date=e()}created(){this.withApi((async()=>{this.handleSelectPeriodMenu(this.dropdownPeriodMenuItems[0]),this.address=this.userAddress??"",this.datetime=this.formatDate((new Date).getTime(),"D-MMM-YYYY--HH-mm-ss")}))}async addressUpdated(t){this.adarTxs=[],this.validAddress&&(this.adarTxs=await(0,p.r)(this.address))}get validAddress(){return i.hi.validateAddress(this.address)}onDownloadClick(){this.downloadCSV(`ADAR--routings--${this.selectedPeriod.title.split(" ").join("")}--${this.datetime}`)}getReportData(t=!1){return this.userTxs.filter((t=>(0,d.isAfter)(new Date(t.endTime),this.selectedPeriod.date))).map((e=>{const s={txId:e.txId,datetime:new Date(e.endTime),blockId:e.blockId,blockNumber:e.blockHeight,from:this.address},a=e?.payload?.receivers.map(((s,a)=>{const r=new o.FPNumber(s.amount),i=e?.payload?.comment?.rates[s.asset.symbol]||"-";return[`${a+1}`,s.accountId,s.asset.symbol,t?r.toFixed(7):r.toLocaleString(),t?i:new o.FPNumber(i).toLocaleString()]}));return{info:s,outputTxs:a}})).sort(((t,e)=>(0,d.compareDesc)(t.info.datetime,e.info.datetime)))}downloadCSV(t){let e="data:text/csv;charset=utf-8,";this.getReportData(!0).forEach((t=>{const{txId:s,from:a,blockNumber:r,datetime:o}=t.info,i=`${this.t("adar.routeAssets.stages.done.report.datetime")} - ${o?.toUTCString()}\n${this.t("adar.routeAssets.stages.done.report.timestampUTC")} - ${o?.getTime()}\n`+this.headers.join(",")+`,${this.t("adar.routeAssets.stages.done.report.transactionId")},${this.t("adar.routeAssets.stages.done.report.blockNumber")},${this.t("adar.routeAssets.stages.done.report.senderWallet")}\n`+t.outputTxs?.map((t=>`${t.join(",")},${s},${r},${a}`)).join("\n")+"\n\n";e+=i}));const s=encodeURI(e),a=document.createElement("a");a.setAttribute("href",s),a.setAttribute("download",`${t}.csv`),document.body.appendChild(a),a.click()}downloadPDF(t){const e=new n.jsPDF({putOnlyUsedFonts:!0,orientation:"landscape"});this.getReportData().forEach((t=>{const{txId:s,blockId:a,from:r,blockNumber:o,datetime:i}=t.info;e.setFontSize(12),e.text(`${this.t("adar.routeAssets.stages.done.report.transactionId")} - ${s}`,5,5),e.text(`${this.t("adar.routeAssets.stages.done.report.blockNumber")} - ${o}`,5,10),e.text(`${this.t("adar.routeAssets.stages.done.report.blockId")} - ${a}`,5,15),e.text(`${this.t("adar.routeAssets.stages.done.report.senderWallet")} - ${r}`,5,20),e.text(`${this.t("adar.routeAssets.stages.done.report.datetime")} - ${i?.toUTCString()}`,5,25),e.text(`${this.t("adar.routeAssets.stages.done.report.timestampUTC")} - ${i?.getTime()}`,5,30),u()(e,{head:[this.headers],body:t.outputTxs,startY:35,rowPageBreak:"avoid",margin:{top:5,left:5,right:5,bottom:5},styles:{lineColor:[237,228,231],lineWidth:.3,fontSize:10},headStyles:{textColor:[161,154,157],fillColor:[253,247,251]},bodyStyles:{fillColor:[253,247,251],textColor:[38,38,45],cellPadding:{top:10,right:5,bottom:10,left:5}},alternateRowStyles:{fillColor:[255,250,251]}}),e.addPage()})),e.save(`${t}.pdf`)}get userTxs(){return this.adarTxs.filter((t=>!t.errorMessage))}get selectedPeriodTxsNumber(){return this.userTxs.filter((t=>(0,d.isAfter)(new Date(t.endTime),this.selectedPeriod.date))).length}};(0,r.gn)([g.SB.wallet.account.address],m.prototype,"userAddress",void 0),(0,r.gn)([(0,c.RL)("address")],m.prototype,"addressUpdated",null),m=(0,r.gn)([(0,c.wA)({components:{}})],m);var v=m,b=(0,s(1001).Z)(v,(function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.parentLoading,expression:"parentLoading"}],staticClass:"routing-history"},[e("div",{staticClass:"container"},[e("div",{staticClass:"routing-history__title-icon"},[e("div",[e("svg",{attrs:{width:"26",height:"29",viewBox:"0 0 26 29",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M16.9484 0.653093C16.5608 0.41069 16.1666 0.247417 15.7211 0.144744C15.2757 0.0420717 14.8737 0 13.7118 0H5.76874C3.76282 0 3.03543 0.208858 2.3021 0.601049C1.56876 0.99324 0.99324 1.56876 0.601049 2.3021C0.208858 3.03543 0 3.76282 0 5.76874V22.7313C0 24.7372 0.208858 25.4646 0.601049 26.1979C0.99324 26.9312 1.56876 27.5068 2.3021 27.899C3.03543 28.2911 3.76282 28.5 5.76874 28.5H19.7313C21.7372 28.5 22.4646 28.2911 23.1979 27.899C23.9312 27.5068 24.5068 26.9312 24.899 26.1979C25.2911 25.4646 25.5 24.7372 25.5 22.7313V11.7882C25.5 10.6263 25.4579 10.2243 25.3553 9.77887C25.2526 9.33339 25.0893 8.93921 24.8469 8.55161C24.6045 8.164 24.35 7.85004 23.5284 7.02843L18.4716 1.97157C17.65 1.14996 17.336 0.895495 16.9484 0.653093ZM14.8519 3.16426C14.5363 2.85148 14 3.07505 14 3.51941V9.5C14 9.77615 14.2239 10 14.5 10H20.5351C20.9817 10 21.2042 9.45917 20.8871 9.14485L14.8519 3.16426Z"}})])])]),e("div",{staticClass:"routing-history__page-header-title"},[t._v(t._s(t.t("adar.routingHistory.title")))]),e("div",{staticClass:"select-address-panel"},[e("s-input",{attrs:{placeholder:t.t("adar.routeAssets.wallet")},model:{value:t.address,callback:function(e){t.address=e},expression:"address"}}),e("div",{staticClass:"error-message",class:t.validAddress?"error-message_valid":"error-message_invalid"},[e("div",[t._v(" "+t._s(`${t.t("adar.routeAssets.dialogs.fixIssuesDialog.walletAddress")} ${t.validAddress?`${t.t("adar.routeAssets.dialogs.fixIssuesDialog.fieldStatusCorrect")}`:`${t.t("adar.routeAssets.dialogs.fixIssuesDialog.fieldStatusIncorrect")}`}`)+" ")]),e("div",[e("s-icon",{staticClass:"icon-status",attrs:{name:t.validAddress?"basic-check-marks-24":"basic-clear-X-xs-24",size:"12px"}})],1)])],1),e("div",{staticClass:"routing-history__period period"},[e("div",{staticClass:"period__label"},[t._v(t._s(t.t("adar.routingHistory.periodLabel")))]),e("s-dropdown",{attrs:{type:"button","button-type":"link",placement:"bottom-start"},on:{select:t.handleSelectPeriodMenu},scopedSlots:t._u([{key:"menu",fn:function(){return t._l(t.dropdownPeriodMenuItems,(function(s,a){return e("s-dropdown-item",{key:a,staticClass:"period__menu-item",attrs:{value:s}},[t._v(" "+t._s(t.t(`adar.routingHistory.dropdownItems.${s.title}`))+" ")])}))},proxy:!0}])},[t._v(" "+t._s(t.currentPeriodLabel)+" ")])],1),e("div",{staticClass:"buttons-container"},[e("s-button",{staticClass:"s-typography-button--medium restart-button",attrs:{type:"primary",disabled:!t.selectedPeriodTxsNumber},on:{click:function(e){return e.stopPropagation(),t.onDownloadClick.apply(null,arguments)}}},[t.selectedPeriodTxsNumber?[t._v(" "+t._s(t.t("adar.routingHistory.downloadButtonTitle"))+" ")]:[t._v(" "+t._s(t.t("noDataText"))+" ")]],2)],1)])])}),[],!1,null,"59827a7d",null),C=b.exports}}]);
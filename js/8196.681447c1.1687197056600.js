"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[8196],{88196:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var o=s(60760),i=s(70655),n=s(53545),a=s(82753),r=s(8755),d=s(32806),h=s(74614),c=s(21251),u=s(25108);let p=class extends((0,n.Wr)(d.Z,r.tA.LoadingMixin,r.tA.NotificationMixin)){constructor(...t){super(...t),(0,o.Z)(this,"authLogin",void 0),(0,o.Z)(this,"hasFreeAttempts",void 0),(0,o.Z)(this,"wantsToPassKycAgain",void 0),(0,o.Z)(this,"soraNetwork",void 0),(0,o.Z)(this,"currentStatus",void 0),(0,o.Z)(this,"isEuroBalanceEnough",void 0),(0,o.Z)(this,"setWillToPassKycAgain",void 0),(0,o.Z)(this,"getUserStatus",void 0),(0,o.Z)(this,"initPayWingsAuthSdk",void 0),(0,o.Z)(this,"getUserKycAttempt",void 0),(0,o.Z)(this,"userApplied",void 0),(0,o.Z)(this,"inputCode",void 0),(0,o.Z)(this,"inputPhone",void 0),(0,o.Z)(this,"inputOtp",void 0),(0,o.Z)(this,"countryCodeInternal",""),(0,o.Z)(this,"phoneNumberInternal",""),(0,o.Z)(this,"smsCountDown",""),(0,o.Z)(this,"smsResendCount",59),(0,o.Z)(this,"notPassedKycAndNotHasXorEnough",!1),(0,o.Z)(this,"verificationCode",""),(0,o.Z)(this,"smsSent",!1),(0,o.Z)(this,"sendOtpBtnLoading",!1),(0,o.Z)(this,"notFoundPhoneWhenApplied",!1)}handleSmsCountChange(t){const e=t.toString().length>1?"":"0";this.smsCountDown=`0:${e}${t}`}handleXorDeposit(t){t&&(this.notPassedKycAndNotHasXorEnough=!1,this.verificationCode="",this.smsSent=!1)}verifyCode(){this.authLogin.PayWingsOtpCredentialVerification(this.verificationCode).catch((t=>{this.sendOtpBtnLoading=!1,this.verificationCode="",this.showAppNotification(this.t("card.infoMessageWrongOtp"),"error"),u.error("[SoraCard]: Auth",t)})),this.sendOtpBtnLoading=!0}sendSms(){this.authLogin.PayWingsSendOtp(`${this.countryCode}${this.phoneNumber}`,"Your verification code is: @Otp").catch((t=>{u.error("[SoraCard]: Auth",t)})),this.startSmsCountDown()}get countryCode(){return this.countryCodeInternal}set countryCode(t){t.length>3&&this.inputPhone.focus(),this.countryCodeInternal=t}get phoneNumber(){return this.phoneNumberInternal}set phoneNumber(t){t.length||this.inputCode.focus(),this.phoneNumberInternal=t}get countryCodePlaceholder(){return this.countryCode?this.t("card.code"):"+44"}get buttonDisabled(){return 6!==this.verificationCode.length||this.notPassedKycAndNotHasXorEnough}get otpInputDisabled(){return!this.smsSent||!this.isPhoneNumberValid||this.notFoundPhoneWhenApplied}get buttonText(){return 6!==this.verificationCode.length?this.t("card.enterCodeBtn"):this.notPassedKycAndNotHasXorEnough?this.t("insufficientBalanceText",{tokenSymbol:a.XOR.symbol}):this.t("card.confirmCodeBtn")}set buttonText(t){this.buttonText=t}get sendSmsButtonText(){return this.smsSent?this.t("card.resendInBtn",{value:this.smsCountDown}):this.t("card.sendCodeBtn")}get isMainnet(){return this.soraNetwork===r.it.SoraNetwork.Prod}get isPhoneNumberValid(){const t=this.countryCode.replace("+","");return!!(+t&&this.phoneNumber&&`${t}${this.phoneNumber}`.length>=8)}get sendSmsDisabled(){return!this.isPhoneNumberValid||this.smsSent}get phoneInputDisabled(){return this.smsSent}get phoneInputDescription(){return this.smsSent?this.isMainnet?this.t("card.phoneInputAfterSendDesc"):"Your code for testing purposes: 123456":this.t("card.phoneInputBeforeSendDesc")}startSmsCountDown(){const t=setInterval((()=>{this.smsResendCount--,this.smsResendCount<0&&(this.smsSent=!1,this.verificationCode="",this.notFoundPhoneWhenApplied=!1,this.smsResendCount=59,clearInterval(t))}),1e3)}async mounted(){await this.$nextTick(),this.inputCode.focus(),localStorage.removeItem("PW-Email"),await this.initPayWingsAuthSdk(),this.authLogin&&this.authLogin.on("SendOtp-Success",(()=>{this.smsSent=!0,this.$nextTick((()=>{this.inputOtp.focus()}))})).on("MinimalRegistrationReq",(()=>{if(this.sendOtpBtnLoading=!1,this.userApplied)return this.showAppNotification(this.t("card.userNotFound"),"info"),this.notFoundPhoneWhenApplied=!0,void(this.verificationCode="");if(!this.isEuroBalanceEnough)return void(this.notPassedKycAndNotHasXorEnough=!0);this.$emit("confirm",{goToEmail:!0,startKyc:!1,showBanner:!1}),this.sendOtpBtnLoading=!1})).on("Otp-Verification-Success",(async()=>{if(await this.getUserStatus(),this.currentStatus===c.$.Rejected&&(await this.getUserKycAttempt(),this.wantsToPassKycAgain&&this.hasFreeAttempts)){const t={goToEmail:!1,startKyc:!0,showBanner:!1};return this.$emit("confirm",t),void this.setWillToPassKycAgain(!1)}if(this.currentStatus){const t={goToEmail:!1,startKyc:!1,showBanner:!0};this.$emit("confirm",t)}else{if(this.userApplied&&this.showAppNotification(this.t("card.infoMessageNoKYC"),"info"),!this.isEuroBalanceEnough)return this.notPassedKycAndNotHasXorEnough=!0,void(this.sendOtpBtnLoading=!1);const t={goToEmail:!1,startKyc:!0,showBanner:!1};this.$emit("confirm",t)}})).on("Verification-Email-Sent-Success",(()=>{if(this.sendOtpBtnLoading=!1,this.userApplied&&this.showAppNotification(this.t("card.infoMessageNoKYC"),"info"),!this.isEuroBalanceEnough)return void(this.notPassedKycAndNotHasXorEnough=!0);this.$emit("confirm",{goToEmail:!0,startKyc:!1,showBanner:!1}),this.sendOtpBtnLoading=!1}))}};(0,i.__decorate)([h.SB.soraCard.authLogin],p.prototype,"authLogin",void 0),(0,i.__decorate)([h.SB.soraCard.hasFreeAttempts],p.prototype,"hasFreeAttempts",void 0),(0,i.__decorate)([h.SB.soraCard.wantsToPassKycAgain],p.prototype,"wantsToPassKycAgain",void 0),(0,i.__decorate)([h.SB.wallet.settings.soraNetwork],p.prototype,"soraNetwork",void 0),(0,i.__decorate)([h.Yn.soraCard.currentStatus],p.prototype,"currentStatus",void 0),(0,i.__decorate)([h.Yn.soraCard.isEuroBalanceEnough],p.prototype,"isEuroBalanceEnough",void 0),(0,i.__decorate)([h.QF.soraCard.setWillToPassKycAgain],p.prototype,"setWillToPassKycAgain",void 0),(0,i.__decorate)([h.aD.soraCard.getUserStatus],p.prototype,"getUserStatus",void 0),(0,i.__decorate)([h.aD.soraCard.initPayWingsAuthSdk],p.prototype,"initPayWingsAuthSdk",void 0),(0,i.__decorate)([h.aD.soraCard.getUserKycAttempt],p.prototype,"getUserKycAttempt",void 0),(0,i.__decorate)([(0,n.fI)({default:!1,type:Boolean})],p.prototype,"userApplied",void 0),(0,i.__decorate)([(0,n.Rl)("code")],p.prototype,"inputCode",void 0),(0,i.__decorate)([(0,n.Rl)("phone")],p.prototype,"inputPhone",void 0),(0,i.__decorate)([(0,n.Rl)("otp")],p.prototype,"inputOtp",void 0),(0,i.__decorate)([(0,n.RL)("smsResendCount",{immediate:!0})],p.prototype,"handleSmsCountChange",null),(0,i.__decorate)([(0,n.RL)("isEuroBalanceEnough",{immediate:!0})],p.prototype,"handleXorDeposit",null),p=(0,i.__decorate)([n.wA],p);var l=p,m=(0,s(1001).Z)(l,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("div",{staticClass:"sora-card__number-input"},[s("div",{staticClass:"phone-container s-flex"},[s("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"+###",expression:"'+###'"}],ref:"code",staticClass:"phone-code",attrs:{placeholder:t.countryCodePlaceholder,disabled:t.phoneInputDisabled},model:{value:t.countryCode,callback:function(e){t.countryCode=e},expression:"countryCode"}}),s("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"############",expression:"'############'"}],ref:"phone",staticClass:"phone-number",attrs:{placeholder:t.t("card.phonePlaceholder"),disabled:t.phoneInputDisabled},model:{value:t.phoneNumber,callback:function(e){t.phoneNumber=e},expression:"phoneNumber"}})],1),s("s-button",{staticClass:"sora-card__send-sms-btn s-typography-button--large",attrs:{type:"secondary",disabled:t.sendSmsDisabled},on:{click:t.sendSms}},[t._v(" "+t._s(t.sendSmsButtonText)+" ")])],1),s("div",[s("p",{staticClass:"sora-card__number-input-desc"},[t._v(t._s(t.phoneInputDescription))]),t.smsSent?s("s-icon",{staticClass:"sora-card__icon",attrs:{name:"basic-check-mark-24",size:"14px"}}):t._e()],1),s("s-input",{directives:[{name:"maska",rawName:"v-maska",value:"######",expression:"'######'"}],ref:"otp",attrs:{placeholder:t.t("card.otpPlaceholder"),disabled:t.otpInputDisabled},model:{value:t.verificationCode,callback:function(e){t.verificationCode=e},expression:"verificationCode"}}),s("s-button",{staticClass:"sora-card__btn s-typography-button--large",attrs:{disabled:t.buttonDisabled,type:"primary",loading:t.sendOtpBtnLoading},on:{click:t.verifyCode}},[s("span",{staticClass:"text"},[t._v(" "+t._s(t.buttonText))])])],1)}),[],!1,null,"12252970",null).exports}}]);
"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[1009],{1009:function(e,r,t){t.r(r),t.d(r,{default:function(){return y}});var s=t(23166),i=(t(70560),t(97582)),a=t(37981),n=t(69826),o=t(86424),d=t(52151),l=t.n(d),c=t(89445),f=t(62690),u=t(36113),p=t(68282),h=t(69781),g=t(49053),v=t(50961);let m=class extends((0,c.Wr)(o.tA.LoadingMixin,o.tA.FormattedAmountMixin,o.tA.PaginationSearchMixin,o.tA.NetworkFeeWarningMixin,o.tA.CopyAddressMixin,u.Z)){constructor(...e){super(...e),(0,s.Z)(this,"WALLET_CONSTS",o.WALLET_CONSTS),(0,s.Z)(this,"referrerLinkOrCode",""),(0,s.Z)(this,"referrerHasApproved",!1),(0,s.Z)(this,"pageAmount",5),(0,s.Z)(this,"referralRewards",void 0),(0,s.Z)(this,"invitedUsers",void 0),(0,s.Z)(this,"referrer",void 0),(0,s.Z)(this,"isReferrerApproved",void 0),(0,s.Z)(this,"isTMA",void 0),(0,s.Z)(this,"telegramBotUrl",void 0),(0,s.Z)(this,"xor",void 0),(0,s.Z)(this,"account",void 0),(0,s.Z)(this,"reset",void 0),(0,s.Z)(this,"unsubscribeFromInvitedUsers",void 0),(0,s.Z)(this,"resetReferrerSubscription",void 0),(0,s.Z)(this,"setStorageReferrer",void 0),(0,s.Z)(this,"subscribeOnInvitedUsers",void 0),(0,s.Z)(this,"getReferrer",void 0),(0,s.Z)(this,"getAccountReferralRewards",void 0),(0,s.Z)(this,"subscribeOnReferrer",void 0)}updateSubscriptions(e){e?this.initData():(this.unsubscribeFromInvitedUsers(),this.resetReferrerSubscription())}async initData(){this.isLoggedIn&&(await this.subscribeOnInvitedUsers(),await this.getAccountReferralRewards(),await this.getReferrer(),await this.subscribeOnReferrer())}get isPriceAvailable(){return!!this.getAssetFiatPrice(n.XOR)}get xorSymbol(){return n.XOR.symbol}get formattedRewards(){return this.referralRewards?.rewards.toLocaleString()??p.m8}get formattedRewardsFiatValue(){return this.referralRewards?.rewards?this.getFiatAmountByFPNumber(this.referralRewards.rewards):null}get invitedUserRewards(){return this.referralRewards?.invitedUserRewards??{}}get bondedXorCodecBalance(){return this.xor?.balance?.bonded??""}get inviteUserFee(){return this.formatCodecNumber(this.networkFees.ReferralSetInvitedUser)}get isInsufficientBondedAmount(){return!!this.bondedXorCodecBalance&&a.FPNumber.gt(this.getFPNumberFromCodec(this.networkFees.ReferralSetInvitedUser),this.getFPNumberFromCodec(this.bondedXorCodecBalance))}get formattedBondedXorBalance(){return this.bondedXorCodecBalance?this.formatCodecNumber(this.bondedXorCodecBalance):p.m8}get formattedBondedXorFiatValue(){return this.bondedXorCodecBalance?this.getFiatAmountByCodecString(this.bondedXorCodecBalance):null}get invitedUsersCount(){return this.invitedUsers.length}get invitedUsersClasses(){const e="invited-users-list",r=[e];return this.hasMultipleInvitedUsersPages&&r.push(`${e}--multiple-pages`),r}get linkHrefBase(){return`${(0,f.BQ)(h.ZP)}referral/`}get referralLink(){return{href:`${this.linkHrefBase}${this.account.address}`,label:this.getLinkLabel(this.account.address)}}get hasAccountWithBondedXor(){return this.account&&+this.bondedXorCodecBalance>0}get bondedContainerClasses(){const e="bonded-container",r=[e];return this.hasAccountWithBondedXor||(r.push("is-active"),r.push(`${e}--visible-content`)),r}get isReferrerLinkEmpty(){return!this.referrerLinkOrCode.trim()}get referrerFormatted(){return this.referrer?(0,v.Tg)(this.referrer,8):""}get referrerAddress(){return this.referrer?this.referrer:l()(this.referrerLinkOrCode.split("/"))??""}get isValidReferrerLink(){return!this.isReferrerLinkEmpty&&(!!o.hi.validateAddress(this.referrerAddress)&&(o.hi.formatAddress(this.referrerAddress)!==this.account?.address&&(this.referrerLinkOrCode===this.referrerAddress||this.referrerLinkOrCode===this.referrerLink.href)))}get filteredInvitedUsers(){return this.getPageItems(this.invitedUsers)}get hasMultipleInvitedUsersPages(){return this.invitedUsers.length>this.pageAmount}get referrerLink(){return{href:`${this.linkHrefBase}${this.referrerAddress}`,label:this.getLinkLabel(this.referrerAddress)}}get bondButtonType(){return this.hasAccountWithBondedXor?"secondary":"primary"}get hasTMALink(){return this.isTMA&&!!this.telegramBotUrl}get refLinkTooltip(){return this.hasTMALink?this.t("referralProgram.inviteViaTelegram"):this.copyTooltip(this.t("referralProgram.invitationLink"))}get refLinkText(){return this.hasTMALink?this.t("referralProgram.action.shareLink"):this.t("referralProgram.action.copyLink")}handleClickRefLink(e){this.hasTMALink||this.handleCopyAddress(this.referralLink.href,e)}destroyed(){this.reset()}created(){this.withApi((async()=>{await this.initData()}))}getLinkLabel(e){return`<span class="referral-link-address">Polkaswap.io/</span>${(0,f.vp)(h.ZP)}referral/${e}`}getInvitedUserReward(e){const r=this.invitedUserRewards[e];return"string"==typeof e&&r?this.formatCodecNumber(r.toCodecString()):p.m8}handleBonding(e=!1){h.ZP.push({name:e?p.sn.ReferralBonding:p.sn.ReferralUnbonding})}handleSetReferrer(){this.setStorageReferrer(this.referrerAddress)}};(0,i.gn)([g.SB.referrals.referralRewards],m.prototype,"referralRewards",void 0),(0,i.gn)([g.SB.referrals.invitedUsers],m.prototype,"invitedUsers",void 0),(0,i.gn)([g.SB.referrals.referrer],m.prototype,"referrer",void 0),(0,i.gn)([g.SB.referrals.isReferrerApproved],m.prototype,"isReferrerApproved",void 0),(0,i.gn)([g.SB.settings.isTMA],m.prototype,"isTMA",void 0),(0,i.gn)([g.SB.settings.telegramBotUrl],m.prototype,"telegramBotUrl",void 0),(0,i.gn)([g.Yn.assets.xor],m.prototype,"xor",void 0),(0,i.gn)([g.Yn.wallet.account.account],m.prototype,"account",void 0),(0,i.gn)([g.QF.referrals.reset],m.prototype,"reset",void 0),(0,i.gn)([g.QF.referrals.unsubscribeFromInvitedUsers],m.prototype,"unsubscribeFromInvitedUsers",void 0),(0,i.gn)([g.QF.referrals.resetReferrerSubscription],m.prototype,"resetReferrerSubscription",void 0),(0,i.gn)([g.QF.referrals.setStorageReferrer],m.prototype,"setStorageReferrer",void 0),(0,i.gn)([g.aD.referrals.subscribeOnInvitedUsers],m.prototype,"subscribeOnInvitedUsers",void 0),(0,i.gn)([g.aD.referrals.getReferrer],m.prototype,"getReferrer",void 0),(0,i.gn)([g.aD.referrals.getAccountReferralRewards],m.prototype,"getAccountReferralRewards",void 0),(0,i.gn)([g.aD.referrals.subscribeOnReferrer],m.prototype,"subscribeOnReferrer",void 0),(0,i.gn)([(0,c.RL)("isLoggedIn")],m.prototype,"updateSubscriptions",null),m=(0,i.gn)([(0,c.wA)({components:{FormattedAmount:o.wx.FormattedAmount,FormattedAddress:o.wx.FormattedAddress,InfoLine:o.wx.InfoLine,ReferralBonding:(0,h.JE)(p.sn.ReferralBonding),WalletAvatar:o.wx.WalletAvatar,TokenLogo:o.wx.TokenLogo}})],m);var b=m,k=(0,t(1001).Z)(b,(function(){var e=this,r=e._self._c;e._self._setupProxy;return r("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"referral-program"},[e.isLoggedIn?[r("div",{staticClass:"rewards-container"},[r("span",{staticClass:"rewards-title"},[e._v(e._s(e.t("referralProgram.receivedRewards")))]),r("token-logo",{attrs:{token:e.xor,size:e.WALLET_CONSTS.LogoSize.BIGGER}}),r("formatted-amount",{staticClass:"rewards-value",attrs:{"value-can-be-hidden":"","font-size-rate":e.FontSizeRate.SMALL,"symbol-as-decimal":"",value:e.formattedRewards,"asset-symbol":e.xorSymbol}}),e.formattedRewardsFiatValue?r("formatted-amount",{attrs:{"is-fiat-value":"","fiat-default-rounding":"","value-can-be-hidden":"","font-size-rate":e.FontSizeRate.MEDIUM,value:e.formattedRewardsFiatValue,"is-formatted":""}}):e._e()],1),e.hasAccountWithBondedXor?[e.isInsufficientBondedAmount?r("div",{staticClass:"referral-insufficient-bonded-amount"},[e._v(" "+e._s(e.t("referralProgram.insufficientBondedAmount",{inviteUserFee:e.inviteUserFee}))+" ")]):r("s-card",{staticClass:"referral-link-container",attrs:{shadow:"always",size:"small","border-radius":"medium"}},[r("div",{staticClass:"referral-link-details with-text"},[r("div",{staticClass:"referral-link-label"},[e._v(e._s(e.t("referralProgram.invitationLink")))]),r("div",{staticClass:"referral-link",domProps:{innerHTML:e._s(e.referralLink.label)}})]),r("s-button",{staticClass:"s-typography-button--mini",attrs:{size:"small",type:"primary",tooltip:e.refLinkTooltip},on:{click:function(r){return e.handleClickRefLink(r)}}},[e._v(" "+e._s(e.refLinkText)+" "),r("s-icon",{attrs:{name:"copy-16",size:"16"}})],1)],1)]:e._e(),r("s-collapse",{attrs:{borders:!0}},[r("s-collapse-item",{class:e.bondedContainerClasses,attrs:{disabled:!e.hasAccountWithBondedXor,name:"bondedXOR"},scopedSlots:e._u([e.hasAccountWithBondedXor?{key:"title",fn:function(){return[r("token-logo",{attrs:{token:e.xor}}),r("h3",{staticClass:"bonded-collapse-title"},[e._v(e._s(e.t("referralProgram.bondedXOR")))])]},proxy:!0}:null],null,!0)},[e.hasAccountWithBondedXor?e._e():r("div",{staticClass:"unbonded-info"},[r("token-logo",{attrs:{token:e.xor}}),r("p",{staticClass:"referral-program-hint referral-program-hint--connected",domProps:{innerHTML:e._s(e.t("referralProgram.startInviting"))}})],1),r("info-line",{attrs:{"is-formatted":"","value-can-be-hidden":"",label:e.t("referralProgram.bondedXOR"),value:e.formattedBondedXorBalance,"fiat-value":e.formattedBondedXorFiatValue}}),r("div",{staticClass:"bonded--buttons"},[r("s-button",{staticClass:"s-typography-button--medium",attrs:{type:e.bondButtonType},on:{click:function(r){return e.handleBonding(!0)}}},[e._v(" "+e._s(e.t("referralProgram.action.bondMore"))+" ")]),e.hasAccountWithBondedXor?r("s-button",{staticClass:"s-typography-button--medium",attrs:{type:"secondary"},on:{click:function(r){return e.handleBonding()}}},[e._v(" "+e._s(e.t("referralProgram.action.unbond"))+" ")]):e._e()],1)],1),e.invitedUsersCount?r("s-collapse-item",{staticClass:"invited-users-container",attrs:{name:"invitedUsers"},scopedSlots:e._u([{key:"title",fn:function(){return[r("span",{staticClass:"invited-users-icon"}),r("h3",{staticClass:"invited-users-collapse-title"},[e._v(" "+e._s(e.t("referralProgram.referralsNumber",{number:e.invitedUsersCount}))+" ")])]},proxy:!0}],null,!1,1546159244)},[e.invitedUsersCount?[r("div",{class:e.invitedUsersClasses},e._l(e.filteredInvitedUsers,(function(t){return r("info-line",{key:t,attrs:{"value-can-be-hidden":"",value:e.getInvitedUserReward(t),"asset-symbol":e.xorSymbol,"is-formatted":""},scopedSlots:e._u([{key:"info-line-prefix",fn:function(){return[r("formatted-address",{attrs:{value:t,"tooltip-text":e.t("transaction.referral")}})]},proxy:!0}],null,!0)})})),1),e.hasMultipleInvitedUsersPages?r("s-pagination",{attrs:{layout:"total, prev, next","current-page":e.currentPage,"page-size":e.pageAmount,total:e.invitedUsersCount},on:{"update:currentPage":function(r){e.currentPage=r},"update:current-page":function(r){e.currentPage=r},"prev-click":e.handlePrevClick,"next-click":e.handleNextClick}}):e._e()]:e._e()],2):e._e(),r("s-collapse-item",{staticClass:"referrer-link-container",attrs:{name:"referrer"},scopedSlots:e._u([{key:"title",fn:function(){return[e.referrer?r("WalletAvatar",{staticClass:"referrer-icon",attrs:{size:32,address:e.referrer}}):e._e(),r("h3",{staticClass:"referrer-collapse-title"},[e._v(" "+e._s(e.t("referralProgram.referrer."+(e.referrer?"titleReferrer":"title")))+" ")])]},proxy:!0}],null,!1,3479973179)},[e.referrer?[r("h5",[e._v(e._s(e.t("referralProgram.referrer.referredBy",{referrer:e.referrerFormatted})))]),r("p",{staticClass:"referrer-description",domProps:{innerHTML:e._s(e.t("referralProgram.referrer.info"))}})]:[r("div",{staticClass:"referrer-link-details"},[r("s-input",{staticClass:"referrer-link-code",attrs:{placeholder:e.t("referralProgram.referrer."+(e.isReferrerLinkEmpty?"placeholder":"label"))},scopedSlots:e._u([{key:"right",fn:function(){return[e.isReferrerLinkEmpty?e._e():r("s-button",{staticClass:"s-typography-button--mini s-button--approve",attrs:{size:"small",type:"primary",disabled:!e.isValidReferrerLink||e.isReferrerApproved},on:{click:function(r){return r.stopPropagation(),e.handleSetReferrer.apply(null,arguments)}}},[e._v(" "+e._s(e.t("referralProgram.referrer."+(e.isReferrerApproved?"approved":"approve")))+" ")])]},proxy:!0}],null,!1,247624632),model:{value:e.referrerLinkOrCode,callback:function(r){e.referrerLinkOrCode=r},expression:"referrerLinkOrCode"}})],1),r("p",{staticClass:"referrer-description",domProps:{innerHTML:e._s(e.t("referralProgram.referrer.description"))}})],e.referrer?r("s-card",{attrs:{shadow:"always",size:"small","border-radius":"medium"}},[r("div",{staticClass:"referrer-link-details with-text"},[r("div",{staticClass:"referral-link-label"},[e._v(e._s(e.t("referralProgram.referrer.referredLablel")))]),r("div",{staticClass:"referral-link",domProps:{innerHTML:e._s(e.referrerLink.label)}})])]):e._e()],2)],1)]:[r("p",{staticClass:"referral-program-hint",domProps:{innerHTML:e._s(e.t("referralProgram.connectAccount"))}}),e.isLoggedIn?e._e():r("s-button",{staticClass:"connect-button s-typography-button--large",attrs:{type:"primary"},on:{click:e.connectSoraWallet}},[e._v(" "+e._s(e.t("connectWalletText"))+" ")])]],2)}),[],!1,null,"46ca5478",null),y=k.exports}}]);
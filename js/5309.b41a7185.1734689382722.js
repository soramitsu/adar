"use strict";(self.webpackChunkadar=self.webpackChunkadar||[]).push([[5309],{55309:function(t,s,e){e.r(s),e.d(s,{default:function(){return x}});var a=e(23166),l=(e(70560),e(97582)),i=e(57950),o=e(69826),r=e(59352),n=e(86424),u=e(89445),d=e(89334),v=e(68282),c=e(94503),m=e(87550),h=e(35681),b=e(69781),p=e(49053),f=e(50961);let g=class extends((0,u.Wr)(d.Z,n.tA.LoadingMixin,n.tA.FormattedAmountMixin)){constructor(...t){super(...t),(0,a.Z)(this,"getLtvStatus",h.D),(0,a.Z)(this,"isLoggedIn",void 0),(0,a.Z)(this,"getAsset",void 0),(0,a.Z)(this,"getTax",void 0),(0,a.Z)(this,"accountVaults",void 0),(0,a.Z)(this,"closedAccountVaults",void 0),(0,a.Z)(this,"collaterals",void 0),(0,a.Z)(this,"averageCollateralPrices",void 0),(0,a.Z)(this,"liquidationPenalty",void 0),(0,a.Z)(this,"percentFormat",void 0),(0,a.Z)(this,"showCloseVaultDialog",!1),(0,a.Z)(this,"showAddCollateralDialog",!1),(0,a.Z)(this,"showBorrowMoreDialog",!1),(0,a.Z)(this,"showRepayDebtDialog",!1),(0,a.Z)(this,"vaultSkeleton",{id:0,lockedAssetId:o.XOR.address,debtAssetId:o.KUSD.address,vaultType:r.VaultTypes.V2,status:c.mD.Closed,returned:this.Zero})}get foundVault(){const t=this.$route.params.vault;if(!t)return null;const s=this.accountVaults.find((({id:s})=>s===+t));return s||this.closedAccountVaults.find((({id:s})=>s===+t))}get vault(){return this.foundVault??this.vaultSkeleton}isOpened(t){return void 0!==t.lockedAmount}isClosed(t){return void 0===t.lockedAmount}get status(){return this.vault?this.isOpened(this.vault)?c.mD.Opened:this.vault.status:c.mD.Closed}get lockedAsset(){return this.vault?this.getAsset(this.vault.lockedAssetId):null}get debtAsset(){return this.vault?this.getAsset(this.vault.debtAssetId):null}get debtSymbol(){return this.debtAsset?.symbol??""}get lockedSymbol(){return this.lockedAsset?.symbol??""}get vaultTitle(){return this.debtSymbol&&this.lockedSymbol?`${this.debtSymbol} / ${this.lockedSymbol}`:""}get collateralId(){return this.vault?n.hi.kensetsu.serializeKey(this.vault.lockedAssetId,this.vault.debtAssetId):""}get borrowTax(){return this.vault?this.getTax(this.vault.debtAssetId):0}get collateral(){return this.collateralId?this.collaterals[this.collateralId]:null}get averageCollateralPrice(){return this.collateralId?this.averageCollateralPrices[this.collateralId]??this.Zero:this.Zero}get maxSafeDebt(){if(!this.vault||!this.isOpened(this.vault))return null;return this.averageCollateralPrice.mul(this.vault.lockedAmount).mul(this.collateral?.riskParams.liquidationRatioReversed??0).div(v.Tv)}get ltvCoeff(){return this.maxSafeDebt&&this.vault&&this.isOpened(this.vault)?this.vault.debt.div(this.maxSafeDebt):null}get maxLtv(){return this.collateral?.riskParams.liquidationRatioReversed??v.Tv}get adjustedLtv(){return this.ltvCoeff?this.ltvCoeff.mul(this.maxLtv):null}get ltv(){return this.ltvCoeff?.isFinity()?this.ltvCoeff.mul(v.Tv):null}get ltvNumber(){return this.ltv?.toNumber()??0}get formattedLtv(){const t=this.adjustedLtv?.toNumber()??0;return this.percentFormat?.format?.(t/v.Tv)??`${t}%`}get ltvText(){return c.ho[(0,h.D)(this.ltvNumber)]}get formattedMaxLtv(){return this.percentFormat?.format?.(this.maxLtv/v.Tv)??`${this.maxLtv}%`}get availableToBorrow(){if(!(this.maxSafeDebt&&this.vault&&this.isOpened(this.vault)))return null;let t=this.maxSafeDebt.sub(this.vault.debt);t=t.sub(t.mul(this.borrowTax));let s=this.collateral?.riskParams.hardCap.sub(this.collateral.debtSupply)??this.Zero;return s=s.sub(s.mul(this.borrowTax)),t=s.lt(t)?s:t,!t.isFinity()||t.isLteZero()?this.Zero:t.dp(2)}get formattedAvailableToBorrow(){return this.availableToBorrow?.toLocaleString(2)??v.m8}get fiatAvailableToBorrow(){return this.debtAsset&&this.availableToBorrow?this.getFiatAmountByFPNumber(this.availableToBorrow,this.debtAsset)??v.m8:v.m8}get isAddCollateralUnavailable(){return!this.lockedAsset||(0,f.yA)((0,f.rh)(this.lockedAsset))}get isBorrowMoreUnavailable(){if(!this.debtAsset||!this.availableToBorrow)return!0;const t=this.getFPNumberFiatAmountByFPNumber(this.availableToBorrow,this.debtAsset);return t?.isLessThan(i.FPNumber.ONE)??!1}get isRepayDebtUnavailable(){if(!this.vault||!this.debtAsset||this.isClosed(this.vault))return!0;const t=this.getFPNumberFiatAmountByFPNumber(this.vault.debt,this.debtAsset);return t?.isLessThan(i.FPNumber.ONE)??!1}get formattedLockedAmount(){return!this.vault||this.isClosed(this.vault)?v.m8:this.vault.lockedAmount.toLocaleString(2)??v.m8}get fiatLockedAmount(){return this.vault&&this.lockedAsset&&this.isOpened(this.vault)?this.getFiatAmountByFPNumber(this.vault.lockedAmount,this.lockedAsset)??v.m8:v.m8}get formattedDebtAmount(){return!this.vault||this.isClosed(this.vault)?v.m8:this.vault.debt.toLocaleString(2)??v.m8}get fiatDebt(){return this.debtAsset&&this.vault&&this.isOpened(this.vault)?this.getFiatAmountByFPNumber(this.vault.debt,this.debtAsset)??v.m8:v.m8}get formattedLiquidationPenalty(){return this.percentFormat?.format?.(this.liquidationPenalty/v.Tv)??`${this.liquidationPenalty}%`}get stabilityFee(){return this.collateral?.riskParams.stabilityFeeAnnual}get formattedStabilityFee(){const t=this.stabilityFee?.toNumber()??0;return this.percentFormat?.format?.(t/v.Tv)??`${t}%`}get formattedReturnedAmount(){return this.vault&&this.isClosed(this.vault)?this.vault.returned?.toLocaleString(2)??v.m8:v.m8}get fiatReturnedAmount(){return this.vault&&this.lockedAsset&&this.isClosed(this.vault)&&this.vault.returned?this.getFiatAmountByFPNumber(this.vault.returned,this.lockedAsset)??v.m8:v.m8}goToVaults(){b.ZP.push({name:c.KT.Vaults})}mounted(){this.withApi((async()=>{this.isLoggedIn?(await(0,f.AE)((()=>!this.parentLoading)),this.foundVault?(this.vaultSkeleton.id=this.foundVault.id,this.vaultSkeleton.lockedAssetId=this.foundVault.lockedAssetId,this.vaultSkeleton.debtAssetId=this.foundVault.debtAssetId,this.vaultSkeleton.vaultType=this.foundVault.vaultType):this.goToVaults()):this.goToVaults()}))}handleBack(){b.ZP.back()}closePosition(){this.showCloseVaultDialog=!0}addCollateral(){this.showAddCollateralDialog=!0}borrowMore(){this.showBorrowMoreDialog=!0}repayDebt(){this.showRepayDebtDialog=!0}};(0,l.gn)([p.Yn.wallet.account.isLoggedIn],g.prototype,"isLoggedIn",void 0),(0,l.gn)([p.Yn.assets.assetDataByAddress],g.prototype,"getAsset",void 0),(0,l.gn)([p.Yn.vault.getBorrowTax],g.prototype,"getTax",void 0),(0,l.gn)([p.SB.vault.accountVaults],g.prototype,"accountVaults",void 0),(0,l.gn)([p.SB.vault.closedAccountVaults],g.prototype,"closedAccountVaults",void 0),(0,l.gn)([p.SB.vault.collaterals],g.prototype,"collaterals",void 0),(0,l.gn)([p.SB.vault.averageCollateralPrices],g.prototype,"averageCollateralPrices",void 0),(0,l.gn)([p.SB.vault.liquidationPenalty],g.prototype,"liquidationPenalty",void 0),(0,l.gn)([p.SB.settings.percentFormat],g.prototype,"percentFormat",void 0),g=(0,l.gn)([(0,u.wA)({components:{FormattedAmount:n.wx.FormattedAmount,PairTokenLogo:(0,b.kF)(v.z8.PairTokenLogo),ValueStatus:(0,b.kF)(v.z8.ValueStatusWrapper),AddCollateralDialog:(0,m.rP)(c.JB.AddCollateralDialog),BorrowMoreDialog:(0,m.rP)(c.JB.BorrowMoreDialog),RepayDebtDialog:(0,m.rP)(c.JB.RepayDebtDialog),CloseVaultDialog:(0,m.rP)(c.JB.CloseVaultDialog),LtvProgressBar:(0,m.rP)(c.JB.LtvProgressBar),VaultDetailsHistory:(0,m.rP)(c.JB.VaultDetailsHistory),PositionStatus:(0,m.rP)(c.JB.PositionStatus)}})],g);var _=g,x=(0,e(1001).Z)(_,(function(){var t=this,s=t._self._c;t._self._setupProxy;return t.vault?s("div",{staticClass:"vault-details-container"},[s("s-button",{staticClass:"vault-details-back",attrs:{type:"action",size:"small",alternative:"",tooltip:t.t("backText")},on:{click:t.handleBack}},[s("s-icon",{attrs:{name:"arrows-chevron-left-rounded-24",size:"24"}})],1),s("s-row",{staticClass:"vault-details-main",attrs:{gutter:20}},[s("s-col",{attrs:{xs:12,sm:12,md:6,lg:6}},[s("s-card",{staticClass:"vault details-card",attrs:{"border-radius":"small",size:"big",primary:""}},[s("div",{staticClass:"vault-title s-flex"},[s("pair-token-logo",{staticClass:"vault-icon",attrs:{size:"medium","first-token":t.debtAsset,"second-token":t.lockedAsset}}),s("div",{staticClass:"vault-title__container s-flex-column"},[s("h3",[t._v(t._s(t.vaultTitle))]),s("position-status",{attrs:{status:t.status}})],1)],1),s("s-divider"),t.ltv?[s("div",{staticClass:"vault-collateral s-flex-column"},[s("h4",[t._v(t._s(t.t("kensetsu.collateralDetails")))]),s("div",{staticClass:"vault-collateral__details s-flex"},[s("div",{staticClass:"vault-collateral__item s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" "+t._s(t.t("kensetsu.yourCollateral"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.yourCollateralDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.formattedLockedAmount,"asset-symbol":t.lockedSymbol}}),s("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.fiatLockedAmount}})],1)]),s("div",{staticClass:"vault-collateral__actions s-flex"},[s("s-button",{staticClass:"s-typography-button--small",attrs:{size:"small",disabled:t.isAddCollateralUnavailable},on:{click:t.addCollateral}},[t._v(" "+t._s(t.t("kensetsu.addCollateral"))+" ")])],1)]),s("s-divider"),s("div",{staticClass:"vault-debt s-flex-column"},[s("h4",[t._v(t._s(t.t("kensetsu.debtDetails")))]),s("div",{staticClass:"vault-debt__details s-flex"},[s("div",{staticClass:"vault-debt__item s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" "+t._s(t.t("kensetsu.yourDebt"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.yourDebtDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.formattedDebtAmount,"asset-symbol":t.debtSymbol}}),s("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.fiatDebt}})],1),s("div",{staticClass:"vault-debt__item s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" "+t._s(t.t("kensetsu.availableToBorrow"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.availableToBorrowDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.formattedAvailableToBorrow,"asset-symbol":t.debtSymbol}}),s("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.fiatAvailableToBorrow}})],1)]),s("div",{staticClass:"vault-debt__actions s-flex"},[s("s-button",{staticClass:"s-typography-button--small",attrs:{size:"small",disabled:t.isRepayDebtUnavailable},on:{click:t.repayDebt}},[t._v(" "+t._s(t.t("kensetsu.repayDebt"))+" ")]),s("s-button",{staticClass:"s-typography-button--small",attrs:{type:"primary",size:"small",disabled:t.isBorrowMoreUnavailable},on:{click:t.borrowMore}},[t._v(" "+t._s(t.t("kensetsu.borrowMore"))+" ")])],1)])]:s("div",{staticClass:"vault-returned s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" "+t._s(t.t("kensetsu.totalCollateralReturned"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.totalCollateralReturnedDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("formatted-amount",{attrs:{"value-can-be-hidden":"",value:t.formattedReturnedAmount,"asset-symbol":t.lockedSymbol}}),s("formatted-amount",{attrs:{"value-can-be-hidden":"","is-fiat-value":"",value:t.fiatReturnedAmount}})],1)],2),t.ltv?s("s-button",{staticClass:"close-vault-button",attrs:{type:"link"},on:{click:t.closePosition}},[t._v(" "+t._s(t.t("kensetsu.closeVault"))+" ")]):t._e()],1),s("s-col",{attrs:{xs:12,sm:12,md:6,lg:6}},[s("s-card",{staticClass:"details-card",attrs:{"border-radius":"small",size:"big",primary:""}},[s("div",{staticClass:"position-info s-flex-column"},[s("h4",[t._v(t._s(t.t("kensetsu.positionInfo")))]),s("div",{staticClass:"position-info__details s-flex"},[s("div",{staticClass:"position-info__item s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" "+t._s(t.t("kensetsu.liquidationPenalty"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.liquidationPenaltyDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("p",{staticClass:"p3"},[t._v(t._s(t.formattedLiquidationPenalty))])]),s("div",{staticClass:"position-info__item s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" "+t._s(t.t("kensetsu.interest"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.interestDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("p",{staticClass:"p3"},[t._v(t._s(t.formattedStabilityFee))])]),s("div",{staticClass:"position-info__item s-flex-column"},[s("p",{staticClass:"vault-label p3"},[t._v(" MAX LTV "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.ltvMaxTooltip"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("p",{staticClass:"p3"},[t._v(t._s(t.formattedMaxLtv))])])])]),t.ltv?[s("s-divider"),s("div",{staticClass:"ltv s-flex-column"},[s("h4",{staticClass:"ltv__title"},[t._v(" "+t._s(t.t("kensetsu.ltv"))+" "),s("s-tooltip",{attrs:{slot:"suffix","border-radius":"mini",content:t.t("kensetsu.ltvDescription"),placement:"top",tabindex:"-1"},slot:"suffix"},[s("s-icon",{attrs:{name:"info-16",size:"12px"}})],1)],1),s("div",{staticClass:"ltv__value s-flex"},[s("h2",[t._v(t._s(t.formattedLtv))]),s("value-status",{staticClass:"ltv__badge",attrs:{badge:"","error-icon-size":"15",value:t.ltvNumber,getStatus:t.getLtvStatus}},[t._v(" "+t._s(t.ltvText)+" ")])],1),s("ltv-progress-bar",{attrs:{percentage:t.ltvNumber}}),s("div",{staticClass:"ltv__legend s-flex"},[s("div",{staticClass:"ltv__legend-item"},[s("span",{staticClass:"ltv__legend-icon success"}),t._v(" "+t._s(t.t("kensetsu.positionSafe"))+" ")]),s("div",{staticClass:"ltv__legend-item"},[s("span",{staticClass:"ltv__legend-icon warning"}),t._v(" "+t._s(t.t("kensetsu.liquidationClose"))+" ")]),s("div",{staticClass:"ltv__legend-item"},[s("span",{staticClass:"ltv__legend-icon error"}),t._v(" "+t._s(t.t("kensetsu.highLiquidationRisk"))+" ")])])],1)]:t._e()],2),s("vault-details-history",{attrs:{id:t.vault.id,"locked-asset":t.lockedAsset,"debt-asset":t.debtAsset}})],1)],1),t.ltv?[s("add-collateral-dialog",{attrs:{visible:t.showAddCollateralDialog,vault:t.vault,"locked-asset":t.lockedAsset,"debt-asset":t.debtAsset,"prev-ltv":t.adjustedLtv,"prev-available":t.availableToBorrow,collateral:t.collateral,"max-ltv":t.maxLtv,"average-collateral-price":t.averageCollateralPrice,"borrow-tax":t.borrowTax},on:{"update:visible":function(s){t.showAddCollateralDialog=s}}}),s("borrow-more-dialog",{attrs:{visible:t.showBorrowMoreDialog,vault:t.vault,"debt-asset":t.debtAsset,"prev-ltv":t.adjustedLtv,available:t.availableToBorrow,collateral:t.collateral,"max-safe-debt":t.maxSafeDebt,"max-ltv":t.maxLtv,"borrow-tax":t.borrowTax},on:{"update:visible":function(s){t.showBorrowMoreDialog=s}}}),s("repay-debt-dialog",{attrs:{visible:t.showRepayDebtDialog,vault:t.vault,"debt-asset":t.debtAsset,"prev-ltv":t.adjustedLtv,"max-safe-debt":t.maxSafeDebt,"max-ltv":t.maxLtv},on:{"update:visible":function(s){t.showRepayDebtDialog=s}}}),s("close-vault-dialog",{attrs:{visible:t.showCloseVaultDialog,vault:t.vault,"locked-asset":t.lockedAsset,"debt-asset":t.debtAsset},on:{"update:visible":function(s){t.showCloseVaultDialog=s},confirm:t.goToVaults}})]:t._e()],2):s("div",{staticClass:"vault-details-container empty"})}),[],!1,null,"a2cbb1ca",null).exports}}]);